/*!
 * bootstrap-fileinput v5.1.5
 * http://plugins.krajee.com/file-input
 *
 * Author: Kartik Visweswaran
 * Copyright: 2014 - 2021, Kartik Visweswaran, Krajee.com
 *
 * Licensed under the BSD-3-Clause
 * https://github.com/kartik-v/bootstrap-fileinput/blob/master/LICENSE.md
 */(function(f){"use strict";typeof define=="function"&&define.amd?define(["jquery"],f):typeof module=="object"&&module.exports?module.exports=f(require("jquery")):f(window.jQuery)})(function(f){"use strict";var s,O;f.fn.fileinputLocales={},f.fn.fileinputThemes={},String.prototype.setTokens=function(e){var t,i,a=this.toString();for(t in e)e.hasOwnProperty(t)&&(i=new RegExp("{"+t+"}","g"),a=a.replace(i,e[t]));return a},Array.prototype.flatMap||(Array.prototype.flatMap=function(e){return[].concat(this.map(e))}),s={FRAMES:".kv-preview-thumb",SORT_CSS:"file-sortable",INIT_FLAG:"init-",OBJECT_PARAMS:`<param name="controller" value="true" />
<param name="allowFullScreen" value="true" />
<param name="allowScriptAccess" value="always" />
<param name="autoPlay" value="false" />
<param name="autoStart" value="false" />
<param name="quality" value="high" />
`,DEFAULT_PREVIEW:`<div class="file-preview-other">
<span class="{previewFileIconClass}">{previewFileIcon}</span>
</div>`,MODAL_ID:"kvFileinputModal",MODAL_EVENTS:["show","shown","hide","hidden","loaded"],logMessages:{ajaxError:"{status}: {error}. Error Details: {text}.",badDroppedFiles:"Error scanning dropped files!",badExifParser:"Error loading the piexif.js library. {details}",badInputType:'The input "type" must be set to "file" for initializing the "bootstrap-fileinput" plugin.',exifWarning:'To avoid this warning, either set "autoOrientImage" to "false" OR ensure you have loaded the "piexif.js" library correctly on your page before the "fileinput.js" script.',invalidChunkSize:'Invalid upload chunk size: "{chunkSize}". Resumable uploads are disabled.',invalidThumb:'Invalid thumb frame with id: "{id}".',noResumableSupport:"The browser does not support resumable or chunk uploads.",noUploadUrl:'The "uploadUrl" is not set. Ajax uploads and resumable uploads have been disabled.',retryStatus:"Retrying upload for chunk # {chunk} for {filename}... retry # {retry}.",chunkQueueError:"Could not push task to ajax pool for chunk index # {index}.",resumableMaxRetriesReached:"Maximum resumable ajax retries ({n}) reached.",resumableRetryError:"Could not retry the resumable request (try # {n})... aborting.",resumableAborting:"Aborting / cancelling the resumable request.",resumableRequestError:"Error processing resumable request. {msg}"},objUrl:window.URL||window.webkitURL,now:function(){return new Date().getTime()},round:function(e){return e=parseFloat(e),isNaN(e)?0:Math.floor(Math.round(e))},getArray:function(e){for(var t=[],i=e&&e.length||0,a=0;a<i;a++)t.push(e[a]);return t},getFileRelativePath:function(e){return String(e.newPath||e.relativePath||e.webkitRelativePath||s.getFileName(e)||null)},getFileId:function(e,t){var i=s.getFileRelativePath(e);return typeof t=="function"?t(e):e&&i?e.size+"_"+encodeURIComponent(i).replace(/%/g,"_"):null},getFrameSelector:function(e,t){return'[id="'+e+'"]'+(t=t||"")},getZoomSelector:function(e,t){return s.getFrameSelector("zoom-"+e,t)},getFrameElement:function(e,t,i){return e.find(s.getFrameSelector(t,i))},getZoomElement:function(e,t,i){return e.find(s.getZoomSelector(t,i))},getElapsed:function(e){var t=e,i="",a={},r={year:31536e3,month:2592e3,week:604800,day:86400,hour:3600,minute:60,second:1};return s.getObjectKeys(r).forEach(function(n){a[n]=Math.floor(t/r[n]),t-=a[n]*r[n]}),f.each(a,function(n,o){0<o&&(i+=(i?" ":"")+o+n.substring(0,1))}),i},debounce:function(e,t){var i;return function(){var a=arguments,r=this;clearTimeout(i),i=setTimeout(function(){e.apply(r,a)},t)}},stopEvent:function(e){e.stopPropagation(),e.preventDefault()},getFileName:function(e){return e&&(e.fileName||e.name)||""},createObjectURL:function(e){return s.objUrl&&s.objUrl.createObjectURL&&e?s.objUrl.createObjectURL(e):""},revokeObjectURL:function(e){s.objUrl&&s.objUrl.revokeObjectURL&&e&&s.objUrl.revokeObjectURL(e)},compare:function(e,t,i){return e!==void 0&&(i?e===t:e.match(t))},isIE:function(e){var t;return navigator.appName==="Microsoft Internet Explorer"&&(e===10?new RegExp("msie\\s"+e,"i").test(navigator.userAgent):((t=document.createElement("div")).innerHTML="<!--[if IE "+e+"]> <i></i> <![endif]-->",e=t.getElementsByTagName("i").length,document.body.appendChild(t),t.parentNode.removeChild(t),e))},canOrientImage:function(i){var t=f(document.createElement("img")).css({width:"1px",height:"1px"}).insertAfter(i),i=t.css("image-orientation");return t.remove(),!!i},canAssignFilesToInput:function(){var e=document.createElement("input");try{return e.type="file",!(e.files=null)}catch{return!1}},getDragDropFolders:function(e){var t,i,a=e?e.length:0,r=0;if(0<a&&e[0].webkitGetAsEntry())for(t=0;t<a;t++)(i=e[t].webkitGetAsEntry())&&i.isDirectory&&r++;return r},initModal:function(e){var t=f("body");t.length&&e.appendTo(t)},isFunction:function(e){return typeof e=="function"},isEmpty:function(e,t){return e==null||!s.isFunction(e)&&(e.length===0||t&&f.trim(e)==="")},isArray:function(e){return Array.isArray(e)||Object.prototype.toString.call(e)==="[object Array]"},ifSet:function(e,t,i){return i=i||"",t&&typeof t=="object"&&e in t?t[e]:i},cleanArray:function(e){return e instanceof Array||(e=[]),e.filter(function(t){return t!=null})},spliceArray:function(e,t,i){var a,r,n=0,o=[];if(!(e instanceof Array))return[];for(r=f.extend(!0,[],e),i&&r.reverse(),a=0;a<r.length;a++)a!==t&&(o[n]=r[a],n++);return i&&o.reverse(),o},getNum:function(e,t){return t=t||0,typeof e=="number"?e:(typeof e=="string"&&(e=parseFloat(e)),isNaN(e)?t:e)},hasFileAPISupport:function(){return!(!window.File||!window.FileReader)},hasDragDropSupport:function(){var e=document.createElement("div");return!s.isIE(9)&&(e.draggable!==void 0||e.ondragstart!==void 0&&e.ondrop!==void 0)},hasFileUploadSupport:function(){return s.hasFileAPISupport()&&window.FormData},hasBlobSupport:function(){try{return!!window.Blob&&!!new Blob}catch{return!1}},hasArrayBufferViewSupport:function(){try{return new Blob([new Uint8Array(100)]).size===100}catch{return!1}},hasResumableUploadSupport:function(){return s.hasFileUploadSupport()&&s.hasBlobSupport()&&s.hasArrayBufferViewSupport()&&(!!Blob.prototype.webkitSlice||!!Blob.prototype.mozSlice||!!Blob.prototype.slice||!1)},dataURI2Blob:function(e){var t,i,a,r,n=window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder,o=s.hasBlobSupport();if(!((o||n)&&window.atob&&window.ArrayBuffer&&window.Uint8Array))return null;for(t=(0<=e.split(",")[0].indexOf("base64")?atob:decodeURIComponent)(e.split(",")[1]),i=new ArrayBuffer(t.length),a=new Uint8Array(i),r=0;r<t.length;r+=1)a[r]=t.charCodeAt(r);return e=e.split(",")[0].split(":")[1].split(";")[0],o?new Blob([s.hasArrayBufferViewSupport()?a:i],{type:e}):((n=new n).append(i),n.getBlob(e))},arrayBuffer2String:function(e){if(window.TextDecoder)return new TextDecoder("utf-8").decode(e);for(var t,i,a,r=Array.prototype.slice.apply(new Uint8Array(e)),n="",o=0,d=r.length;o<d;)switch((t=r[o++])>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:n+=String.fromCharCode(t);break;case 12:case 13:i=r[o++],n+=String.fromCharCode((31&t)<<6|63&i);break;case 14:i=r[o++],a=r[o++],n+=String.fromCharCode((15&t)<<12|(63&i)<<6|(63&a)<<0)}return n},isHtml:function(e){var t=document.createElement("div");t.innerHTML=e;for(var i=t.childNodes,a=i.length;a--;)if(i[a].nodeType===1)return!0;return!1},isSvg:function(e){return e.match(/^\s*<\?xml/i)&&(e.match(/<!DOCTYPE svg/i)||e.match(/<svg/i))},getMimeType:function(e,t,i){switch(e){case"ffd8ffe0":case"ffd8ffe1":case"ffd8ffe2":return"image/jpeg";case"89504e47":return"image/png";case"47494638":return"image/gif";case"49492a00":return"image/tiff";case"52494646":return"image/webp";case"66747970":return"video/3gp";case"4f676753":return"video/ogg";case"1a45dfa3":return"video/mkv";case"000001ba":case"000001b3":return"video/mpeg";case"3026b275":return"video/wmv";case"25504446":return"application/pdf";case"25215053":return"application/ps";case"504b0304":case"504b0506":case"504b0508":return"application/zip";case"377abcaf":return"application/7z";case"75737461":return"application/tar";case"7801730d":return"application/dmg";default:switch(e.substring(0,6)){case"435753":return"application/x-shockwave-flash";case"494433":return"audio/mp3";case"425a68":return"application/bzip";default:switch(e.substring(0,4)){case"424d":return"image/bmp";case"fffb":return"audio/mp3";case"4d5a":return"application/exe";case"1f9d":case"1fa0":return"application/zip";case"1f8b":return"application/gzip";default:return t&&!t.match(/[^\u0000-\u007f]/)?"application/text-plain":i}}}},addCss:function(e,t){e.removeClass(t).addClass(t)},getElement:function(e,t,i){return s.isEmpty(e)||s.isEmpty(e[t])?i:f(e[t])},createElement:function(e,t){return t=t||"div",f(f.parseHTML("<"+t+">"+e+"</"+t+">"))},uniqId:function(){return(new Date().getTime()+Math.floor(Math.random()*Math.pow(10,15))).toString(36)},cspBuffer:{CSP_ATTRIB:"data-csp-01928735",domElementsStyles:{},stash:function(a){var t=this,i=f.parseHTML("<div>"+a+"</div>"),a=f(i);return a.find("[style]").each(function(r,l){var o=f(l),d=o[0].style,l=s.uniqId(),c={};d&&d.length&&(f(d).each(function(){c[this]=d[this]}),t.domElementsStyles[l]=c,o.removeAttr("style").attr(t.CSP_ATTRIB,l))}),a.filter("*").removeAttr("style"),(Object.values?Object.values(i):Object.keys(i).map(function(r){return i[r]})).flatMap(function(r){return r.innerHTML}).join("")},apply:function(e){var t=this;f(e).find("["+t.CSP_ATTRIB+"]").each(function(i,n){var r=f(n),n=r.attr(t.CSP_ATTRIB),n=t.domElementsStyles[n];n&&r.css(n),r.removeAttr(t.CSP_ATTRIB)}),t.domElementsStyles={}}},setHtml:function(e,t){var i=s.cspBuffer;return e.html(i.stash(t)),i.apply(e),e},htmlEncode:function(e,t){return e===void 0?t||null:e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;")},replaceTags:function(e,t){var i=e;return t&&f.each(t,function(a,r){typeof r=="function"&&(r=r()),i=i.split(a).join(r)}),i},cleanMemory:function(e){e=(e.is("img")?e:e.find("source")).attr("src"),s.revokeObjectURL(e)},findFileName:function(e){var t=e.lastIndexOf("/");return t===-1&&(t=e.lastIndexOf("\\")),e.split(e.substring(t,t+1)).pop()},checkFullScreen:function(){return document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement||document.msFullscreenElement},toggleFullScreen:function(e){var t=document,i=t.documentElement,a=s.checkFullScreen();i&&e&&!a?i.requestFullscreen?i.requestFullscreen():i.msRequestFullscreen?i.msRequestFullscreen():i.mozRequestFullScreen?i.mozRequestFullScreen():i.webkitRequestFullscreen&&i.webkitRequestFullscreen(Element.ALLOW_KEYBOARD_INPUT):a&&(t.exitFullscreen?t.exitFullscreen():t.msExitFullscreen?t.msExitFullscreen():t.mozCancelFullScreen?t.mozCancelFullScreen():t.webkitExitFullscreen&&t.webkitExitFullscreen())},moveArray:function(e,t,i,a){var r=f.extend(!0,[],e);if(a&&r.reverse(),i>=r.length)for(var n=i-r.length;1+n--;)r.push(void 0);return r.splice(i,0,r.splice(t,1)[0]),a&&r.reverse(),r},closeButton:function(e){return'<button type="button" class="'+(e=e?"close "+e:"close")+`" aria-label="Close">
  <span aria-hidden="true">&times;</span>
</button>`},getRotation:function(e){switch(e){case 2:return"rotateY(180deg)";case 3:return"rotate(180deg)";case 4:return"rotate(180deg) rotateY(180deg)";case 5:return"rotate(270deg) rotateY(180deg)";case 6:return"rotate(90deg)";case 7:return"rotate(90deg) rotateY(180deg)";case 8:return"rotate(270deg)";default:return""}},setTransform:function(e,t){e&&(e.style.transform=t,e.style.webkitTransform=t,e.style["-moz-transform"]=t,e.style["-ms-transform"]=t,e.style["-o-transform"]=t)},getObjectKeys:function(e){var t=[];return e&&f.each(e,function(i){t.push(i)}),t},getObjectSize:function(e){return s.getObjectKeys(e).length},whenAll:function(e){for(var t,i,a,r=[].slice,n=arguments.length===1&&s.isArray(e)?e:r.call(arguments),o=f.Deferred(),d=0,l=n.length,c=l,u=i=a=Array(l),m=function(h,p,w){return function(){w!==n&&d++,o.notifyWith(p[h]=this,w[h]=r.call(arguments)),--c||o[(d?"reject":"resolve")+"With"](p,w)}},g=0;g<l;g++)(t=n[g])&&f.isFunction(t.promise)?t.promise().done(m(g,a,n)).fail(m(g,u,i)):(o.notifyWith(this,t),--c);return c||o.resolveWith(a,n),o.promise()}},(O=function(e,t){var i=this;i.$element=f(e),i.$parent=i.$element.parent(),i._validate()&&(i.isPreviewable=s.hasFileAPISupport(),i.isIE9=s.isIE(9),i.isIE10=s.isIE(10),(i.isPreviewable||i.isIE9)&&(i._init(t),i._listen()),i.$element.removeClass("file-loading"))}).prototype={constructor:O,_cleanup:function(){var e=this;e.reader=null,e.clearFileStack(),e.fileBatchCompleted=!0,e.isError=!1,e.isDuplicateError=!1,e.isPersistentError=!1,e.cancelling=!1,e.paused=!1,e.lastProgress=0,e._initAjax()},_isAborted:function(){return this.cancelling||this.paused},_initAjax:function(){var e=this.taskManager={pool:{},addPool:function(t){return e.pool[t]=new e.TasksPool(t)},getPool:function(t){return e.pool[t]},addTask:function(t,i){return new e.Task(t,i)},TasksPool:function(t){var i=this;i.id=t,i.cancelled=!1,i.cancelledDeferrer=f.Deferred(),i.tasks={},i.addTask=function(a,r){return i.tasks[a]=new e.Task(a,r)},i.size=function(){return s.getObjectSize(i.tasks)},i.run=function(a){var r,n,o,d=0,l=!1,c=s.getObjectKeys(i.tasks).map(function(h){return i.tasks[h]}),u=[],m=f.Deferred();if(i.cancelled)return i.cancelledDeferrer.resolve(),m.reject();if(!a){var g=s.getObjectKeys(i.tasks).map(function(h){return i.tasks[h].deferred});return s.whenAll(g).done(function(){var h=s.getArray(arguments);i.cancelled?(m.reject.apply(null,h),i.cancelledDeferrer.resolve()):(m.resolve.apply(null,h),i.cancelledDeferrer.reject())}).fail(function(){var h=s.getArray(arguments);m.reject.apply(null,h),i.cancelled?i.cancelledDeferrer.resolve():i.cancelledDeferrer.reject()}),f.each(i.tasks,function(h){(r=i.tasks[h]).run()}),m}for(n=function(h){f.when(h.deferred).fail(function(){l=!0,o.apply(null,arguments)}).always(o)},o=function(){var h=s.getArray(arguments);if(m.notify(h),u.push(h),i.cancelled)return m.reject.apply(null,u),void i.cancelledDeferrer.resolve();u.length===i.size()&&(l?m.reject:m.resolve).apply(null,u),c.length&&(r=c.shift(),n(r),r.run())};c.length&&d++<a;)r=c.shift(),n(r),r.run();return m},i.cancel=function(){return i.cancelled=!0,i.cancelledDeferrer}},Task:function(t,i){var a=this;a.id=t,a.deferred=f.Deferred(),a.logic=i,a.context=null,a.run=function(){var r=s.getArray(arguments);return r.unshift(a.deferred),i.apply(a.context,r),a.deferred},a.runWithContext=function(r){return a.context=r,a.run()}}};this.ajaxQueue=[],this.ajaxRequests=[],this.ajaxAborted=!1},_init:function(e,t){var i,a,r=this,n=r.$element;r.options=e,r.canOrientImage=s.canOrientImage(n),f.each(e,function(o,d){switch(o){case"minFileCount":case"maxFileCount":case"maxTotalFileCount":case"minFileSize":case"maxFileSize":case"maxFilePreviewSize":case"resizeImageQuality":case"resizeIfSizeMoreThan":case"progressUploadThreshold":case"initialPreviewCount":case"zoomModalHeight":case"minImageHeight":case"maxImageHeight":case"minImageWidth":case"maxImageWidth":r[o]=s.getNum(d);break;default:r[o]=d}}),0<r.maxTotalFileCount&&r.maxTotalFileCount<r.maxFileCount&&(r.maxTotalFileCount=r.maxFileCount),r.rtl&&(a=r.previewZoomButtonIcons.prev,r.previewZoomButtonIcons.prev=r.previewZoomButtonIcons.next,r.previewZoomButtonIcons.next=a),!isNaN(r.maxAjaxThreads)&&r.maxAjaxThreads<r.resumableUploadOptions.maxThreads&&(r.resumableUploadOptions.maxThreads=r.maxAjaxThreads),r._initFileManager(),typeof r.autoOrientImage=="function"&&(r.autoOrientImage=r.autoOrientImage()),typeof r.autoOrientImageInitial=="function"&&(r.autoOrientImageInitial=r.autoOrientImageInitial()),t||r._cleanup(),r.duplicateErrors=[],r.$form=n.closest("form"),r._initTemplateDefaults(),r.uploadFileAttr=s.isEmpty(n.attr("name"))?"file_data":n.attr("name"),i=r._getLayoutTemplate("progress"),r.progressTemplate=i.replace("{class}",r.progressClass),r.progressInfoTemplate=i.replace("{class}",r.progressInfoClass),r.progressPauseTemplate=i.replace("{class}",r.progressPauseClass),r.progressCompleteTemplate=i.replace("{class}",r.progressCompleteClass),r.progressErrorTemplate=i.replace("{class}",r.progressErrorClass),r.isDisabled=n.attr("disabled")||n.attr("readonly"),r.isDisabled&&n.attr("disabled",!0),r.isClickable=r.browseOnZoneClick&&r.showPreview&&(r.dropZoneEnabled||!s.isEmpty(r.defaultPreviewContent)),r.isAjaxUpload=s.hasFileUploadSupport()&&!s.isEmpty(r.uploadUrl),r.dropZoneEnabled=s.hasDragDropSupport()&&r.dropZoneEnabled,r.isAjaxUpload||(r.dropZoneEnabled=r.dropZoneEnabled&&s.canAssignFilesToInput()),r.slug=typeof e.slugCallback=="function"?e.slugCallback:r._slugDefault,r.mainTemplate=r.showCaption?r._getLayoutTemplate("main1"):r._getLayoutTemplate("main2"),r.captionTemplate=r._getLayoutTemplate("caption"),r.previewGenericTemplate=r._getPreviewTemplate("generic"),!r.imageCanvas&&r.resizeImage&&(r.maxImageWidth||r.maxImageHeight)&&(r.imageCanvas=document.createElement("canvas"),r.imageCanvasContext=r.imageCanvas.getContext("2d")),s.isEmpty(n.attr("id"))&&n.attr("id",s.uniqId()),r.namespace=".fileinput_"+n.attr("id").replace(/-/g,"_"),r.$container===void 0?r.$container=r._createContainer():r._refreshContainer(),a=r.$container,r.$dropZone=a.find(".file-drop-zone"),r.$progress=a.find(".kv-upload-progress"),r.$btnUpload=a.find(".fileinput-upload"),r.$captionContainer=s.getElement(e,"elCaptionContainer",a.find(".file-caption")),r.$caption=s.getElement(e,"elCaptionText",a.find(".file-caption-name")),s.isEmpty(r.msgPlaceholder)||(i=n.attr("multiple")?r.filePlural:r.fileSingle,r.$caption.attr("placeholder",r.msgPlaceholder.replace("{files}",i))),r.$captionIcon=r.$captionContainer.find(".file-caption-icon"),r.$previewContainer=s.getElement(e,"elPreviewContainer",a.find(".file-preview")),r.$preview=s.getElement(e,"elPreviewImage",a.find(".file-preview-thumbnails")),r.$previewStatus=s.getElement(e,"elPreviewStatus",a.find(".file-preview-status")),r.$errorContainer=s.getElement(e,"elErrorContainer",r.$previewContainer.find(".kv-fileinput-error")),r._validateDisabled(),s.isEmpty(r.msgErrorClass)||s.addCss(r.$errorContainer,r.msgErrorClass),t?r._errorsExist()||r.$errorContainer.hide():(r._resetErrors(),r.$errorContainer.hide(),r.previewInitId="thumb-"+n.attr("id"),r._initPreviewCache(),r._initPreview(!0),r._initPreviewActions(),r.$parent.hasClass("file-loading")&&(r.$container.insertBefore(r.$parent),r.$parent.remove())),r._setFileDropZoneTitle(),n.attr("disabled")&&r.disable(),r._initZoom(),r.hideThumbnailContent&&s.addCss(r.$preview,"hide-content")},_initFileManager:function(){var e=this;e.uploadStartTime=s.now(),e.fileManager={stack:{},filesProcessed:[],errors:[],loadedImages:{},totalImages:0,totalFiles:null,totalSize:null,uploadedSize:0,stats:{},bpsLog:[],bps:0,initStats:function(t){var i={started:s.now()};t?e.fileManager.stats[t]=i:e.fileManager.stats=i},getUploadStats:function(t,i,a){var r=e.fileManager,n=t?r.stats[t]&&r.stats[t].started||s.now():e.uploadStartTime,o=(s.now()-n)/1e3,d=Math.ceil(o?i/o:0),l=a-i,c=r.bpsLog.length?e.bitrateUpdateDelay:0;return setTimeout(function(){var u,m,g,h=0,p=0;for(r.bpsLog.push(d),r.bpsLog.sort(function(w,v){return w-v}),g=10<(m=r.bpsLog.length)?m-10:Math.ceil(m/2),u=m;g<u;u--)p=parseFloat(r.bpsLog[u]),h++;r.bps=64*(0<h?p/h:0)},c),l={fileId:t,started:n,elapsed:o,loaded:i,total:a,bps:r.bps,bitrate:e._getSize(r.bps,["B/s","KB/s","MB/s","GB/s","TB/s","PB/s","EB/s","ZB/s","YB/s"]),pendingBytes:l},t?r.stats[t]=l:r.stats=l,l},exists:function(t){return f.inArray(t,e.fileManager.getIdList())!==-1},count:function(){return e.fileManager.getIdList().length},total:function(){var t=e.fileManager;return t.totalFiles||(t.totalFiles=t.count()),t.totalFiles},getTotalSize:function(){var t=e.fileManager;return t.totalSize||(t.totalSize=0,f.each(e.getFileStack(),function(i,a){a=parseFloat(a.size),t.totalSize+=isNaN(a)?0:a}),t.totalSize)},add:function(t,i){(i=i||e.fileManager.getId(t))&&(e.fileManager.stack[i]={file:t,name:s.getFileName(t),relativePath:s.getFileRelativePath(t),size:t.size,nameFmt:e._getFileName(t,""),sizeFmt:e._getSize(t.size)})},remove:function(t){t=e._getThumbFileId(t),t&&e.fileManager.removeFile(t)},removeFile:function(t){delete e.fileManager.stack[t],delete e.fileManager.loadedImages[t]},move:function(t,i){var a={},r=e.fileManager.stack;(t||i)&&t!==i&&(f.each(r,function(n,o){n!==t&&(a[n]=o),n===i&&(a[t]=r[t])}),e.fileManager.stack=a)},list:function(){var t=[];return f.each(e.getFileStack(),function(i,a){a&&a.file&&t.push(a.file)}),t},isPending:function(t){return f.inArray(t,e.fileManager.filesProcessed)===-1&&e.fileManager.exists(t)},isProcessed:function(){var t=!0,i=e.fileManager;return f.each(e.getFileStack(),function(a){i.isPending(a)&&(t=!1)}),t},clear:function(){var t=e.fileManager;e.isDuplicateError=!1,e.isPersistentError=!1,t.totalFiles=null,t.totalSize=null,t.uploadedSize=0,t.stack={},t.errors=[],t.filesProcessed=[],t.stats={},t.bpsLog=[],t.bps=0,t.clearImages()},clearImages:function(){e.fileManager.loadedImages={},e.fileManager.totalImages=0},addImage:function(t,i){e.fileManager.loadedImages[t]=i},removeImage:function(t){delete e.fileManager.loadedImages[t]},getImageIdList:function(){return s.getObjectKeys(e.fileManager.loadedImages)},getImageCount:function(){return e.fileManager.getImageIdList().length},getId:function(t){return e._getFileId(t)},getIndex:function(t){return e.fileManager.getIdList().indexOf(t)},getThumb:function(t){var i=null;return e._getThumbs().each(function(){var a=f(this);e._getThumbFileId(a)===t&&(i=a)}),i},getThumbIndex:function(t){return t=e._getThumbFileId(t),e.fileManager.getIndex(t)},getIdList:function(){return s.getObjectKeys(e.fileManager.stack)},getFile:function(t){return e.fileManager.stack[t]||null},getFileName:function(t,i){return t=e.fileManager.getFile(t),t?i?t.nameFmt||"":t.name||"":""},getFirstFile:function(){var t=e.fileManager.getIdList(),t=t&&t.length?t[0]:null;return e.fileManager.getFile(t)},setFile:function(t,i){e.fileManager.getFile(t)?e.fileManager.stack[t].file=i:e.fileManager.add(i,t)},setProcessed:function(t){e.fileManager.filesProcessed.push(t)},getProgress:function(){var t=e.fileManager.total(),i=e.fileManager.filesProcessed.length;return t?Math.ceil(i/t*100):0},setProgress:function(t,i){t=e.fileManager.getFile(t),!isNaN(i)&&t&&(t.progress=i)}}},_setUploadData:function(e,t){var i=this;f.each(t,function(a,r){a=i.uploadParamNames[a]||a,s.isArray(r)?e.append(a,r[0],r[1]):e.append(a,r)})},_initResumableUpload:function(){var e,t=this,i=t.resumableUploadOptions,a=s.logMessages,r=t.fileManager;if(t.enableResumableUpload){if(i.fallback!==!1&&typeof i.fallback!="function"&&(i.fallback=function(n){n._log(a.noResumableSupport),n.enableResumableUpload=!1}),s.hasResumableUploadSupport()||i.fallback===!1)return!t.uploadUrl&&t.enableResumableUpload?(t._log(a.noUploadUrl),void(t.enableResumableUpload=!1)):(i.chunkSize=parseFloat(i.chunkSize),i.chunkSize<=0||isNaN(i.chunkSize)?(t._log(a.invalidChunkSize,{chunkSize:i.chunkSize}),void(t.enableResumableUpload=!1)):void(e=t.resumableManager={init:function(n,o,d){e.logs=[],e.stack=[],e.error="",e.id=n,e.file=o.file,e.fileName=o.name,e.fileIndex=d,e.completed=!1,e.lastProgress=0,t.showPreview&&(e.$thumb=r.getThumb(n)||null,e.$progress=e.$btnDelete=null,e.$thumb&&e.$thumb.length&&(e.$progress=e.$thumb.find(".file-thumb-progress"),e.$btnDelete=e.$thumb.find(".kv-file-remove"))),e.chunkSize=1024*i.chunkSize,e.chunkCount=e.getTotalChunks()},setAjaxError:function(n,o,d,l){n.responseJSON&&n.responseJSON.error&&(d=n.responseJSON.error.toString()),l||(e.error=d),i.showErrorLog&&t._log(a.ajaxError,{status:n.status,error:d,text:n.responseText||""})},reset:function(){e.stack=[],e.chunksProcessed={}},setProcessed:function(n){var o=e.id,d=e.$thumb,l=e.$progress,c=d&&d.length,u={id:c?d.attr("id"):"",index:r.getIndex(o),fileId:o},m=t.resumableUploadOptions.skipErrorsAndProceed;e.completed=!0,e.lastProgress=0,c&&d.removeClass("file-uploading"),n==="success"?(r.uploadedSize+=e.file.size,t.showPreview&&(t._setProgress(101,l),t._setThumbStatus(d,"Success"),t._initUploadSuccess(e.chunksProcessed[o].data,d)),r.removeFile(o),delete e.chunksProcessed[o],t._raise("fileuploaded",[u.id,u.index,u.fileId]),r.isProcessed()&&t._setProgress(101)):n!=="cancel"&&(t.showPreview&&(t._setThumbStatus(d,"Error"),t._setPreviewError(d,!0),t._setProgress(101,l,t.msgProgressError),t._setProgress(101,t.$progress,t.msgProgressError),t.cancelling=!m),t.$errorContainer.find('li[data-file-id="'+u.fileId+'"]').length||(d={file:e.fileName,max:i.maxRetries,error:e.error},l=t.msgResumableUploadRetriesExceeded.setTokens(d),f.extend(u,d),t._showFileError(l,u,"filemaxretries"),m&&(r.removeFile(o),delete e.chunksProcessed[o],r.isProcessed()&&t._setProgress(101)))),r.isProcessed()&&e.reset()},check:function(){f.each(e.logs,function(n,o){if(!o)return!1})},processedResumables:function(){var n,o=e.logs,d=0;if(!o||!o.length)return 0;for(n=0;n<o.length;n++)o[n]===!0&&d++;return d},getUploadedSize:function(){var n=e.processedResumables()*e.chunkSize;return n>e.file.size?e.file.size:n},getTotalChunks:function(){var n=parseFloat(e.chunkSize);return!isNaN(n)&&0<n?Math.ceil(e.file.size/n):0},getProgress:function(){var n=e.processedResumables(),o=e.chunkCount;return o===0?0:Math.ceil(n/o*100)},checkAborted:function(n){t._isAborted()&&(clearInterval(n),t.unlock())},upload:function(){var n=r.getIdList(),o="new",d=setInterval(function(){var l;e.checkAborted(d),o==="new"&&(t.lock(),o="processing",l=n.shift(),r.initStats(l),r.stack[l]&&(e.init(l,r.stack[l],r.getIndex(l)),e.processUpload())),!r.isPending(l)&&e.completed&&(o="new"),r.isProcessed()&&((l=t.$preview.find(".file-preview-initial")).length&&(s.addCss(l,s.SORT_CSS),t._initSortable()),clearInterval(d),t._clearFileInput(),t.unlock(),setTimeout(function(){var c=t.previewCache.data;c&&(t.initialPreview=c.content,t.initialPreviewConfig=c.config,t.initialPreviewThumbTags=c.tags),t._raise("filebatchuploadcomplete",[t.initialPreview,t.initialPreviewConfig,t.initialPreviewThumbTags,t._getExtraData()])},t.processDelay))},t.processDelay)},uploadResumable:function(){for(var n=t.taskManager,o=e.chunkCount,d=n.addPool(e.id),l=0;l<o;l++)e.logs[l]=!(!e.chunksProcessed[e.id]||!e.chunksProcessed[e.id][l]),e.logs[l]||e.pushAjax(l,0);d.run(i.maxThreads).done(function(){e.setProcessed("success")}).fail(function(){e.setProcessed(d.cancelled?"cancel":"error")})},processUpload:function(){var n,o,d,l,c,u,m=e.id;i.testUrl?(n=new FormData,c=r.stack[m],t._setUploadData(n,{fileId:m,fileName:c.fileName,fileSize:c.size,fileRelativePath:c.relativePath,chunkSize:e.chunkSize,chunkCount:e.chunkCount}),o=function(g){u=t._getOutData(n,g),t._raise("filetestbeforesend",[m,r,e,u])},d=function(g,h,v){u=t._getOutData(n,v,g);var w=t.uploadParamNames.chunksUploaded||"chunksUploaded",v=[m,r,e,u];g[w]&&s.isArray(g[w])?(e.chunksProcessed[m]||(e.chunksProcessed[m]={}),f.each(g[w],function(b,_){e.logs[_]=!0,e.chunksProcessed[m][_]=!0}),e.chunksProcessed[m].data=g,t._raise("filetestsuccess",v)):t._raise("filetesterror",v),e.uploadResumable()},l=function(g,h,p){u=t._getOutData(n,g),t._raise("filetestajaxerror",[m,r,e,u]),e.setAjaxError(g,h,p,!0),e.uploadResumable()},c=function(){t._raise("filetestcomplete",[m,r,e,t._getOutData(n)])},t._ajaxSubmit(o,d,c,l,n,m,e.fileIndex,i.testUrl)):e.uploadResumable()},pushAjax:function(n,o){var d=t.taskManager.getPool(e.id);d.addTask(d.size()+1,function(l){var c=e.stack.shift(),u=c[0];e.chunksProcessed[e.id]&&e.chunksProcessed[e.id][u]?t._log(a.chunkQueueError,{index:u}):e.sendAjax(u,c[1],l)}),e.stack.push([n,o])},sendAjax:function(n,o,d){function l(C,F){F&&(C=C.setTokens(F)),C=h.resumableRequestError.setTokens({msg:C}),t._log(C),d.reject(C)}var c=e.chunkSize,u=e.id,m=e.file,g=e.$thumb,h=s.logMessages,p=e.$btnDelete;if(!e.chunksProcessed[u]||!e.chunksProcessed[u][n]){if(o>i.maxRetries)return l(h.resumableMaxRetriesReached,{n:i.maxRetries}),void e.setProcessed("error");var w,v=m[m.slice?"slice":m.mozSlice?"mozSlice":m.webkitSlice?"webkitSlice":"slice"](c*n,c*(n+1)),b=new FormData,_=r.stack[u];t._setUploadData(b,{chunkCount:e.chunkCount,chunkIndex:n,chunkSize:c,chunkSizeStart:c*n,fileBlob:[v,e.fileName],fileId:u,fileName:e.fileName,fileRelativePath:_.relativePath,fileSize:m.size,retryCount:o}),e.$progress&&e.$progress.length&&e.$progress.show(),c=function(C){w=t._getOutData(b,C),t.showPreview&&(g.hasClass("file-preview-success")||(t._setThumbStatus(g,"Loading"),s.addCss(g,"file-uploading")),p.attr("disabled",!0)),t._raise("filechunkbeforesend",[u,n,o,r,e,w])},v=function(C,F,y){var x;t._isAborted()?l(h.resumableAborting):(w=t._getOutData(b,y,C),x=t.uploadParamNames.chunkIndex||"chunkIndex",y=[u,n,o,r,e,w],C.error?(i.showErrorLog&&t._log(a.retryStatus,{retry:o+1,filename:e.fileName,chunk:n}),t._raise("filechunkerror",y),e.pushAjax(n,o+1),e.error=C.error,l(C.error)):(e.logs[C[x]]=!0,e.chunksProcessed[u]||(e.chunksProcessed[u]={}),e.chunksProcessed[u][C[x]]=!0,e.chunksProcessed[u].data=C,d.resolve.call(null,C),t._raise("filechunksuccess",y),e.check()))},_=function(C,F,y){t._isAborted()?l(h.resumableAborting):(w=t._getOutData(b,C),e.setAjaxError(C,F,y),t._raise("filechunkajaxerror",[u,n,o,r,e,w]),e.pushAjax(n,o+1),l(h.resumableRetryError,{n:o-1}))},m=function(){t._isAborted()||t._raise("filechunkcomplete",[u,n,o,r,e,t._getOutData(b)])},t._ajaxSubmit(c,v,m,_,b,u,e.fileIndex)}}}).reset());i.fallback(t)}},_initTemplateDefaults:function(){var e=this,v=function(b,_){return'<object class="kv-preview-data file-preview-'+b+'" title="{caption}" data="{data}" type="'+_+'"'+r+`>
`+s.DEFAULT_PREVIEW+`
</object>
`},t=s.closeButton("fileinput-remove"),p=s.MODAL_ID+"Label",i='<div id="'+s.MODAL_ID+'" class="file-zoom-dialog modal fade" tabindex="-1" aria-labelledby="'+p+'"></div>',a=`<div class="modal-dialog modal-lg{rtl}" role="document">
  <div class="modal-content">
    <div class="modal-header">
      <h5 class="modal-title" id="`+p+`">{heading}</h5>
      <span class="kv-zoom-title"></span>
      <div class="kv-zoom-actions">{toggleheader}{fullscreen}{borderless}{close}</div>
    </div>
    <div class="modal-body">
      <div class="floating-buttons"></div>
      <div class="kv-zoom-body file-zoom-content {zoomFrameClass}"></div>
{prev} {next}
    </div>
  </div>
</div>
`,r=" {style}",n=v("html","text/html"),o=v("text","text/plain;charset=UTF-8"),d=v("pdf","application/pdf"),l='<img src="{data}" class="file-preview-image kv-preview-data" title="{title}" alt="{alt}"'+r+`>
`,c='<iframe class="kv-preview-data file-preview-office" src="https://view.officeapps.live.com/op/embed.aspx?src={data}"'+r+"></iframe>",u='<iframe class="kv-preview-data file-preview-gdocs" src="https://docs.google.com/gview?url={data}&embedded=true"'+r+"></iframe>",m='<video class="kv-preview-data file-preview-video" controls'+r+`>
<source src="{data}" type="{type}">
`+s.DEFAULT_PREVIEW+`
</video>
`,g='<!--suppress ALL --><audio class="kv-preview-data file-preview-audio" controls'+r+`>
<source src="{data}" type="{type}">
`+s.DEFAULT_PREVIEW+`
</audio>
`,h='<embed class="kv-preview-data file-preview-flash" src="{data}" type="application/x-shockwave-flash"'+r+`>
`,p='<object class="kv-preview-data file-preview-object file-object {typeCss}" data="{data}" type="{type}"'+r+`>
<param name="movie" value="{caption}" />
`+s.OBJECT_PARAMS+" "+s.DEFAULT_PREVIEW+`
</object>
`,w='<div class="kv-preview-data file-preview-other-frame"'+r+`>
`+s.DEFAULT_PREVIEW+`
</div>
`,v={width:"100%",height:"100%","min-height":"480px"};e._isPdfRendered()&&(d=e.pdfRendererTemplate.replace("{renderer}",e._encodeURI(e.pdfRendererUrl))),e.defaults={layoutTemplates:{main1:`{preview}
<div class="kv-upload-progress kv-hidden"></div><div class="clearfix"></div>
<div class="input-group {class}">
  {caption}
<div class="input-group-btn input-group-append">
      {remove}
      {cancel}
      {pause}
      {upload}
      {browse}
    </div>
</div>`,main2:`{preview}
<div class="kv-upload-progress kv-hidden"></div>
<div class="clearfix"></div>
{remove}
{cancel}
{upload}
{browse}
`,preview:`<div class="file-preview {class}">
  {close}  <div class="{dropClass} clearfix">
    <div class="file-preview-thumbnails clearfix">
    </div>
    <div class="file-preview-status text-center text-success"></div>
    <div class="kv-fileinput-error"></div>
  </div>
</div>`,close:t,fileIcon:'<i class="glyphicon glyphicon-file"></i>',caption:`<div class="file-caption form-control {class}" tabindex="500">
  <span class="file-caption-icon"></span>
  <input class="file-caption-name">
</div>`,modalMain:i,modal:a,progress:`<div class="progress">
    <div class="{class}" role="progressbar" aria-valuenow="{percent}" aria-valuemin="0" aria-valuemax="100" style="width:{percent}%;">
        {status}
     </div>
</div>{stats}`,stats:'<div class="text-info file-upload-stats"><span class="pending-time">{pendingTime}</span> <span class="upload-speed">{uploadSpeed}</span></div>',size:" <samp>({sizeText})</samp>",footer:`<div class="file-thumbnail-footer">
    <div class="file-footer-caption" title="{caption}">
        <div class="file-caption-info">{caption}</div>
        <div class="file-size-info">{size}</div>
    </div>
    {progress}
{indicator}
{actions}
</div>`,indicator:'<div class="file-upload-indicator" title="{indicatorTitle}">{indicator}</div>',actions:`<div class="file-actions">
    <div class="file-footer-buttons">
        {download} {upload} {delete} {zoom} {other}    </div>
</div>
{drag}
<div class="clearfix"></div>`,actionDelete:`<button type="button" class="kv-file-remove {removeClass}" title="{removeTitle}" {dataUrl}{dataKey}>{removeIcon}</button>
`,actionUpload:'<button type="button" class="kv-file-upload {uploadClass}" title="{uploadTitle}">{uploadIcon}</button>',actionDownload:'<a class="kv-file-download {downloadClass}" title="{downloadTitle}" href="{downloadUrl}" download="{caption}" target="_blank">{downloadIcon}</a>',actionZoom:'<button type="button" class="kv-file-zoom {zoomClass}" title="{zoomTitle}">{zoomIcon}</button>',actionDrag:'<span class="file-drag-handle {dragClass}" title="{dragTitle}">{dragIcon}</span>',btnDefault:'<button type="{type}" tabindex="500" title="{title}" class="{css}" {status}>{icon} {label}</button>',btnLink:'<a href="{href}" tabindex="500" title="{title}" class="{css}" {status}>{icon} {label}</a>',btnBrowse:'<div tabindex="500" class="{css}" {status}>{icon} {label}</div>',zoomCache:'<div class="kv-zoom-cache">{zoomContent}</div>'},previewMarkupTags:{tagBefore1:`<div class="file-preview-frame {frameClass}" id="{previewId}" data-fileindex="{fileindex}" data-fileid="{fileid}" data-template="{template}"><div class="kv-file-content">
`,tagBefore2:`<div class="file-preview-frame {frameClass}" id="{previewId}" data-fileindex="{fileindex}" data-fileid="{fileid}" data-template="{template}" title="{caption}"><div class="kv-file-content">
`,tagAfter:`</div>{footer}
{zoomCache}</div>
`},previewContentTemplates:{generic:`{content}
`,html:n,image:l,text:o,office:c,gdocs:u,video:m,audio:g,flash:h,object:p,pdf:d,other:w},allowedPreviewTypes:["image","html","text","video","audio","flash","pdf","object"],previewTemplates:{},previewSettings:{image:{width:"auto",height:"auto","max-width":"100%","max-height":"100%"},html:{width:"213px",height:"160px"},text:{width:"213px",height:"160px"},office:{width:"213px",height:"160px"},gdocs:{width:"213px",height:"160px"},video:{width:"213px",height:"160px"},audio:{width:"100%",height:"30px"},flash:{width:"213px",height:"160px"},object:{width:"213px",height:"160px"},pdf:{width:"100%",height:"160px",position:"relative"},other:{width:"213px",height:"160px"}},previewSettingsSmall:{image:{width:"auto",height:"auto","max-width":"100%","max-height":"100%"},html:{width:"100%",height:"160px"},text:{width:"100%",height:"160px"},office:{width:"100%",height:"160px"},gdocs:{width:"100%",height:"160px"},video:{width:"100%",height:"auto"},audio:{width:"100%",height:"30px"},flash:{width:"100%",height:"auto"},object:{width:"100%",height:"auto"},pdf:{width:"100%",height:"160px"},other:{width:"100%",height:"160px"}},previewZoomSettings:{image:{width:"auto",height:"auto","max-width":"100%","max-height":"100%"},html:v,text:v,office:{width:"100%",height:"100%","max-width":"100%","min-height":"480px"},gdocs:{width:"100%",height:"100%","max-width":"100%","min-height":"480px"},video:{width:"auto",height:"100%","max-width":"100%"},audio:{width:"100%",height:"30px"},flash:{width:"auto",height:"480px"},object:{width:"auto",height:"100%","max-width":"100%","min-height":"480px"},pdf:v,other:{width:"auto",height:"100%","min-height":"480px"}},mimeTypeAliases:{"video/quicktime":"video/mp4"},fileTypeSettings:{image:function(b,_){return s.compare(b,"image.*")&&!s.compare(b,/(tiff?|wmf)$/i)||s.compare(_,/\.(gif|png|jpe?g)$/i)},html:function(b,_){return s.compare(b,"text/html")||s.compare(_,/\.(htm|html)$/i)},office:function(b,_){return s.compare(b,/(word|excel|powerpoint|office)$/i)||s.compare(_,/\.(docx?|xlsx?|pptx?|pps|potx?)$/i)},gdocs:function(b,_){return s.compare(b,/(word|excel|powerpoint|office|iwork-pages|tiff?)$/i)||s.compare(_,/\.(docx?|xlsx?|pptx?|pps|potx?|rtf|ods|odt|pages|ai|dxf|ttf|tiff?|wmf|e?ps)$/i)},text:function(b,_){return s.compare(b,"text.*")||s.compare(_,/\.(xml|javascript)$/i)||s.compare(_,/\.(txt|md|nfo|ini|json|php|js|css)$/i)},video:function(b,_){return s.compare(b,"video.*")&&(s.compare(b,/(ogg|mp4|mp?g|mov|webm|3gp)$/i)||s.compare(_,/\.(og?|mp4|webm|mp?g|mov|3gp)$/i))},audio:function(b,_){return s.compare(b,"audio.*")&&(s.compare(_,/(ogg|mp3|mp?g|wav)$/i)||s.compare(_,/\.(og?|mp3|mp?g|wav)$/i))},flash:function(b,_){return s.compare(b,"application/x-shockwave-flash",!0)||s.compare(_,/\.(swf)$/i)},pdf:function(b,_){return s.compare(b,"application/pdf",!0)||s.compare(_,/\.(pdf)$/i)},object:function(){return!0},other:function(){return!0}},fileActionSettings:{showRemove:!0,showUpload:!0,showDownload:!0,showZoom:!0,showDrag:!0,removeIcon:'<i class="glyphicon glyphicon-trash"></i>',removeClass:"btn btn-sm btn-kv btn-default btn-outline-secondary",removeErrorClass:"btn btn-sm btn-kv btn-danger",removeTitle:"Remove file",uploadIcon:'<i class="glyphicon glyphicon-upload"></i>',uploadClass:"btn btn-sm btn-kv btn-default btn-outline-secondary",uploadTitle:"Upload file",uploadRetryIcon:'<i class="glyphicon glyphicon-repeat"></i>',uploadRetryTitle:"Retry upload",downloadIcon:'<i class="glyphicon glyphicon-download"></i>',downloadClass:"btn btn-sm btn-kv btn-default btn-outline-secondary",downloadTitle:"Download file",zoomIcon:'<i class="glyphicon glyphicon-zoom-in"></i>',zoomClass:"btn btn-sm btn-kv btn-default btn-outline-secondary",zoomTitle:"View Details",dragIcon:'<i class="glyphicon glyphicon-move"></i>',dragClass:"text-info",dragTitle:"Move / Rearrange",dragSettings:{},indicatorNew:'<i class="glyphicon glyphicon-plus-sign text-warning"></i>',indicatorSuccess:'<i class="glyphicon glyphicon-ok-sign text-success"></i>',indicatorError:'<i class="glyphicon glyphicon-exclamation-sign text-danger"></i>',indicatorLoading:'<i class="glyphicon glyphicon-hourglass text-muted"></i>',indicatorPaused:'<i class="glyphicon glyphicon-pause text-primary"></i>',indicatorNewTitle:"Not uploaded yet",indicatorSuccessTitle:"Uploaded",indicatorErrorTitle:"Upload Error",indicatorLoadingTitle:"Uploading &hellip;",indicatorPausedTitle:"Upload Paused"}},f.each(e.defaults,function(b,_){b!=="allowedPreviewTypes"?e[b]=f.extend(!0,{},_,e[b]):e.allowedPreviewTypes===void 0&&(e.allowedPreviewTypes=_)}),e._initPreviewTemplates()},_initPreviewTemplates:function(){var e,t=this,i=t.previewMarkupTags,a=i.tagAfter;f.each(t.previewContentTemplates,function(r,n){s.isEmpty(t.previewTemplates[r])&&(e=i.tagBefore2,r!=="generic"&&r!=="image"||(e=i.tagBefore1),t._isPdfRendered()&&r==="pdf"&&(e=e.replace("kv-file-content","kv-file-content kv-pdf-rendered")),t.previewTemplates[r]=e+n+a)})},_initPreviewCache:function(){var e=this;e.previewCache={data:{},init:function(){var t=e.initialPreview;0<t.length&&!s.isArray(t)&&(t=t.split(e.initialPreviewDelimiter)),e.previewCache.data={content:t,config:e.initialPreviewConfig,tags:e.initialPreviewThumbTags}},count:function(t){return e.previewCache.data&&e.previewCache.data.content?(t?e.previewCache.data.content.filter(function(i){return i!==null}):e.previewCache.data.content).length:0},get:function(t,i){function a(p,w,v,b,_,C,P,y){var x=" file-preview-initial "+s.SORT_CSS+(P?" "+P:""),E=e.previewInitId+"-"+C,P=u&&u.fileId||E;return e._generatePreviewTemplate(p,w,v,b,E,P,!1,null,x,_,C,y,h,u&&u.zoomData||w)}var r,n,o,d,l=s.INIT_FLAG+t,c=e.previewCache.data,u=c.config[t],m=c.content[t],g=s.ifSet("previewAsData",u,e.initialPreviewAsData),h=u?{title:u.title||null,alt:u.alt||null}:{title:null,alt:null};return m&&m.length?(i=i===void 0||i,r=s.ifSet("type",u,e.initialPreviewFileType||"generic"),o=s.ifSet("filename",u,s.ifSet("caption",u)),d=s.ifSet("filetype",u,r),n=e.previewCache.footer(t,i,u&&u.size||null),i=s.ifSet("frameClass",u),r=g?a(r,m,o,d,n,l,i):a("generic",m,o,d,n,l,i,r).setTokens({content:c.content[t]}),c.tags.length&&c.tags[t]&&(r=s.replaceTags(r,c.tags[t])),s.isEmpty(u)||s.isEmpty(u.frameAttr)||((t=s.createElement(r)).find(".file-preview-initial").attr(u.frameAttr),r=t.html(),t.remove()),r):""},clean:function(t){t.content=s.cleanArray(t.content),t.config=s.cleanArray(t.config),t.tags=s.cleanArray(t.tags),e.previewCache.data=t},add:function(t,i,a,r){var n,o=e.previewCache.data;return t&&t.length?(n=t.length-1,s.isArray(t)||(t=t.split(e.initialPreviewDelimiter)),r&&o.content?(n=o.content.push(t[0])-1,o.config[n]=i,o.tags[n]=a):(o.content=t,o.config=i,o.tags=a),e.previewCache.clean(o),n):0},set:function(t,i,a,r){var n,o=e.previewCache.data;if(t&&t.length&&(s.isArray(t)||(t=t.split(e.initialPreviewDelimiter)),t.filter(function(d){return d!==null}).length)){if(o.content===void 0&&(o.content=[]),o.config===void 0&&(o.config=[]),o.tags===void 0&&(o.tags=[]),r){for(n=0;n<t.length;n++)t[n]&&o.content.push(t[n]);for(n=0;n<i.length;n++)i[n]&&o.config.push(i[n]);for(n=0;n<a.length;n++)a[n]&&o.tags.push(a[n])}else o.content=t,o.config=i,o.tags=a;e.previewCache.clean(o)}},unset:function(t){var i=e.previewCache.count(),a=e.reversePreviewOrder;if(i){if(i===1)return e.previewCache.data.content=[],e.previewCache.data.config=[],e.previewCache.data.tags=[],e.initialPreview=[],e.initialPreviewConfig=[],void(e.initialPreviewThumbTags=[]);e.previewCache.data.content=s.spliceArray(e.previewCache.data.content,t,a),e.previewCache.data.config=s.spliceArray(e.previewCache.data.config,t,a),e.previewCache.data.tags=s.spliceArray(e.previewCache.data.tags,t,a),a=f.extend(!0,{},e.previewCache.data),e.previewCache.clean(a)}},out:function(){var t,i,a="",r=e.previewCache.count();if(r===0)return{content:"",caption:""};for(t=0;t<r;t++)i=e.previewCache.get(t),a=e.reversePreviewOrder?i+a:a+i;return{content:a,caption:e._getMsgSelected(r)}},footer:function(w,h,a){var c=e.previewCache.data||{};if(s.isEmpty(c.content))return"";(s.isEmpty(c.config)||s.isEmpty(c.config[w]))&&(c.config[w]={}),h=h===void 0||h;var r=c.config[w],n=s.ifSet("caption",r),o=s.ifSet("width",r,"auto"),d=s.ifSet("url",r,!1),l=s.ifSet("key",r,null),m=s.ifSet("fileId",r,null),g=e.fileActionSettings,p=e.initialPreviewShowDelete||!1,u=e.initialPreviewDownloadUrl?e.initialPreviewDownloadUrl+"?key="+l+(m?"&fileId="+m:""):"",c=r.downloadUrl||u,w=r.filename||r.caption||"",m=!!c,u=s.ifSet("showRemove",r,p),p=s.ifSet("showDownload",r,s.ifSet("showDownload",g,m)),m=s.ifSet("showZoom",r,s.ifSet("showZoom",g,!0)),g=s.ifSet("showDrag",r,s.ifSet("showDrag",g,!0)),h=d===!1&&h,p=p&&r.downloadUrl!==!1&&!!c,w=e._renderFileActions(r,!1,p,u,m,g,h,d,l,!0,c,w);return e._getLayoutTemplate("footer").setTokens({progress:e._renderThumbProgress(),actions:w,caption:n,size:e._getSize(a),width:o,indicator:""})}},e.previewCache.init()},_isPdfRendered:function(){var e=this.usePdfRenderer;return(typeof e=="function"?e():!!e)&&this.pdfRendererUrl},_handler:function(e,t,i){var a=this.namespace,a=t.split(" ").join(a+" ")+a;e&&e.length&&e.off(a).on(a,i)},_encodeURI:function(e){return this.encodeUrl?encodeURI(e):e},_log:function(e,t){var i=this.$element.attr("id");this.showConsoleLogs&&(i&&(e='"'+i+'": '+e),e="bootstrap-fileinput: "+e,typeof t=="object"&&(e=e.setTokens(t)),window.console&&window.console.log!==void 0?window.console.log(e):window.alert(e))},_validate:function(){var e=this.$element.attr("type")==="file";return e||this._log(s.logMessages.badInputType),e},_errorsExist:function(){var e;return!!this.$errorContainer.find("li").length||((e=s.createElement(this.$errorContainer.html())).find(".kv-error-close").remove(),e.find("ul").remove(),!!f.trim(e.text()).length)},_errorHandler:function(r,t){var i=this,a=r.target.error,r=function(n){i._showError(n.replace("{name}",t))};a.code===a.NOT_FOUND_ERR?r(i.msgFileNotFound):a.code===a.SECURITY_ERR?r(i.msgFileSecured):a.code===a.NOT_READABLE_ERR?r(i.msgFileNotReadable):a.code===a.ABORT_ERR?r(i.msgFilePreviewAborted):r(i.msgFilePreviewError)},_addError:function(e){var t=this,i=t.$errorContainer;e&&i.length&&(s.setHtml(i,t.errorCloseButton+e),t._handler(i.find(".kv-error-close"),"click",function(){setTimeout(function(){t.showPreview&&!t.getFrames().length&&t.clear(),i.fadeOut("slow")},t.processDelay)}))},_setValidationError:function(e){e=(e?e+" ":"")+"has-error",this.$container.removeClass(e).addClass("has-error"),s.addCss(this.$captionContainer,"is-invalid")},_resetErrors:function(e){var t=this,i=t.$errorContainer,a=t.resumableUploadOptions.retainErrorHistory;t.isPersistentError||t.enableResumableUpload&&a||(t.isError=!1,t.$container.removeClass("has-error"),t.$captionContainer.removeClass("is-invalid"),i.html(""),e?i.fadeOut("slow"):i.hide())},_showFolderError:function(e){var t,i=this,a=i.$errorContainer;e&&(i.isAjaxUpload||i._clearFileInput(),t=i.msgFoldersNotAllowed.replace("{n}",e),i._addError(t),i._setValidationError(),a.fadeIn(i.fadeDelay),i._raise("filefoldererror",[e,t]))},_showFileError:function(e,t,o){var a=this,r=a.$errorContainer,n=o||"fileuploaderror",o=t&&t.fileId||"",o=t&&t.id?'<li data-thumb-id="'+t.id+'" data-file-id="'+o+'">'+e+"</li>":"<li>"+e+"</li>";return r.find("ul").length===0?a._addError("<ul>"+o+"</ul>"):r.find("ul").append(o),r.fadeIn(a.fadeDelay),a._raise(n,[t,e]),a._setValidationError("file-input-new"),!0},_showError:function(e,t,n){var a=this,r=a.$errorContainer,n=n||"fileerror";return(t=t||{}).reader=a.reader,a._addError(e),r.fadeIn(a.fadeDelay),a._raise(n,[t,e]),a.isAjaxUpload||a._clearFileInput(),a._setValidationError("file-input-new"),a.$btnUpload.attr("disabled",!0),!0},_noFilesError:function(e){var t=this,i=1<t.minFileCount?t.filePlural:t.fileSingle,a=t.msgFilesTooLess.replace("{n}",t.minFileCount).replace("{files}",i),i=t.$errorContainer,a="<li>"+a+"</li>";i.find("ul").length===0?t._addError("<ul>"+a+"</ul>"):i.find("ul").append(a),t.isError=!0,t._updateFileDetails(0),i.fadeIn(t.fadeDelay),t._raise("fileerror",[e,a]),t._clearFileInput(),t._setValidationError()},_parseError:function(e,d,o,a){var r=this,n=f.trim(o+""),o=d.responseJSON&&d.responseJSON.error?d.responseJSON.error.toString():"",d=o||d.responseText;return r.cancelling&&r.msgUploadAborted&&(n=r.msgUploadAborted),r.showAjaxErrorDetails&&d&&(o?n=f.trim(o+""):(o=(d=f.trim(d.replace(/\n\s*\n/g,`
`))).length?"<pre>"+d+"</pre>":"",n+=n?o:d)),n=n||r.msgAjaxError.replace("{operation}",e),r.cancelling=!1,a?"<b>"+a+": </b>"+n:n},_parseFileType:function(e,t){var i,a,r=this.allowedPreviewTypes||[];if(e==="application/text-plain")return"text";for(a=0;a<r.length;a++)if(i=r[a],i=(0,this.fileTypeSettings[i])(e,t)?i:"",!s.isEmpty(i))return i;return"other"},_getPreviewIcon:function(e){var t,i=this,a=null;return e&&-1<e.indexOf(".")&&(t=e.split(".").pop(),i.previewFileIconSettings&&(a=i.previewFileIconSettings[t]||i.previewFileIconSettings[t.toLowerCase()]||null),i.previewFileExtSettings&&f.each(i.previewFileExtSettings,function(r,n){i.previewFileIconSettings[r]&&n(t)&&(a=i.previewFileIconSettings[r])})),a||i.previewFileIcon},_parseFilePreviewIcon:function(e,t){return t=this._getPreviewIcon(t),-1<e.indexOf("{previewFileIcon}")&&(e=e.setTokens({previewFileIconClass:this.previewFileIconClass,previewFileIcon:t})),e},_raise:function(e,t){var i=f.Event(e);if(t!==void 0?this.$element.trigger(i,t):this.$element.trigger(i),i.isDefaultPrevented()||i.result===!1)return!1;switch(e){case"filebatchuploadcomplete":case"filebatchuploadsuccess":case"fileuploaded":case"fileclear":case"filecleared":case"filereset":case"fileerror":case"filefoldererror":case"fileuploaderror":case"filebatchuploaderror":case"filedeleteerror":case"filecustomerror":case"filesuccessremove":break;default:this.ajaxAborted||(this.ajaxAborted=i.result)}return!0},_listenFullScreen:function(e){var t,i,a=this.$modal;a&&a.length&&(t=a&&a.find(".btn-fullscreen"),i=a&&a.find(".btn-borderless"),t.length&&i.length&&(t.removeClass("active").attr("aria-pressed","false"),i.removeClass("active").attr("aria-pressed","false"),(e?t:i).addClass("active").attr("aria-pressed","true"),a.hasClass("file-zoom-fullscreen")||e?this._maximizeZoomDialog():i.removeClass("active").attr("aria-pressed","false")))},_listen:function(){var e,t,i=this,a=i.$element,r=i.$form,n=i.$container;i._handler(a,"click",function(o){a.hasClass("file-no-browse")&&(a.data("zoneClicked")?a.data("zoneClicked",!1):o.preventDefault())}),i._handler(a,"change",f.proxy(i._change,i)),i.showBrowse&&i._handler(i.$btnFile,"click",f.proxy(i._browse,i)),e=n.find(".file-caption-name"),t=function(){return!1},i._handler(n.find(".fileinput-remove:not([disabled])"),"click",f.proxy(i.clear,i)),i._handler(n.find(".fileinput-cancel"),"click",f.proxy(i.cancel,i)),i._handler(n.find(".fileinput-pause"),"click",f.proxy(i.pause,i)),i._handler(e,"keydown",t),i._handler(e,"paste",t),i._initDragDrop(),i._handler(r,"reset",f.proxy(i.clear,i)),i.isAjaxUpload||i._handler(r,"submit",f.proxy(i._submitForm,i)),i._handler(i.$container.find(".fileinput-upload"),"click",f.proxy(i._uploadClick,i)),i._handler(f(window),"resize",function(){i._listenFullScreen(screen.width===window.innerWidth&&screen.height===window.innerHeight)}),i._handler(f(document),"webkitfullscreenchange mozfullscreenchange fullscreenchange MSFullscreenChange",function(){i._listenFullScreen(s.checkFullScreen())}),i._autoFitContent(),i._initClickable(),i._refreshPreview()},_autoFitContent:function(){var e,i=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,t=this,i=i<400?t.previewSettingsSmall||t.defaults.previewSettingsSmall:t.previewSettings||t.defaults.previewSettings;f.each(i,function(a,r){e=".file-preview-frame .file-preview-"+a,t.$preview.find(e+".kv-preview-data,"+e+" .kv-preview-data").css(r)})},_scanDroppedItems:function(e,t,i){i=i||"";function a(l){d._log(s.logMessages.badDroppedFiles),d._log(l)}var r,n,o,d=this;e.isFile?e.file(function(l){i&&(l.newPath=i+l.name),t.push(l)},a):e.isDirectory&&(n=e.createReader(),(o=function(){n.readEntries(function(l){if(l&&0<l.length){for(r=0;r<l.length;r++)d._scanDroppedItems(l[r],t,i+e.name+"/");o()}return null},a)})())},_initDragDrop:function(){var e=this,t=e.$dropZone;e.dropZoneEnabled&&e.showPreview&&(e._handler(t,"dragenter dragover",f.proxy(e._zoneDragEnter,e)),e._handler(t,"dragleave",f.proxy(e._zoneDragLeave,e)),e._handler(t,"drop",f.proxy(e._zoneDrop,e)),e._handler(f(document),"dragenter dragover drop",e._zoneDragDropInit))},_zoneDragDropInit:function(e){e.stopPropagation(),e.preventDefault()},_zoneDragEnter:function(e){var t=e.originalEvent.dataTransfer,i=-1<f.inArray("Files",t.types);if(this._zoneDragDropInit(e),this.isDisabled||!i)return t.effectAllowed="none",void(t.dropEffect="none");t.dropEffect="copy",this._raise("fileDragEnter",{sourceEvent:e,files:t.types.Files})&&s.addCss(this.$dropZone,"file-highlighted")},_zoneDragLeave:function(e){this._zoneDragDropInit(e),this.isDisabled||this._raise("fileDragLeave",{sourceEvent:e})&&this.$dropZone.removeClass("file-highlighted")},_zoneDrop:function(e){function t(){a.isAjaxUpload?a._change(e,n):(a.changeTriggered=!0,r.get(0).files=n,setTimeout(function(){a.changeTriggered=!1,r.trigger("change"+a.namespace)},a.processDelay)),a.$dropZone.removeClass("file-highlighted")}var i,a=this,r=a.$element,d=e.originalEvent.dataTransfer,n=d.files,o=d.items,d=s.getDragDropFolders(o);if(e.preventDefault(),!a.isDisabled&&!s.isEmpty(n)&&a._raise("fileDragDrop",{sourceEvent:e,files:n}))if(0<d)if(a.isAjaxUpload){for(n=[],i=0;i<o.length;i++){var l=o[i].webkitGetAsEntry();l&&a._scanDroppedItems(l,n)}setTimeout(function(){t()},500)}else a._showFolderError(d);else t()},_uploadClick:function(e){var t=this.$container.find(".fileinput-upload"),i=!t.hasClass("disabled")&&s.isEmpty(t.attr("disabled"));e&&e.isDefaultPrevented()||(this.isAjaxUpload?(e.preventDefault(),i&&this.upload()):i&&t.attr("type")!=="submit"&&((t=t.closest("form")).length&&t.trigger("submit"),e.preventDefault()))},_submitForm:function(){return this._isFileSelectionValid()&&!this._abort({})},_clearPreview:function(){var e=this;(e.showUploadedThumbs?e.getFrames(":not(.file-preview-success)"):e.getFrames()).each(function(){f(this).remove()}),e.getFrames().length&&e.showPreview||e._resetUpload(),e._validateDefaultPreview()},_initSortable:function(){var e,t=this,i=t.$preview,a="."+s.SORT_CSS,r=f("body"),n=f("html"),o=t.reversePreviewOrder,d=window.Sortable;d&&i.find(a).length!==0&&(e=r.length?r:n.length?n:t.$container,n={handle:".drag-handle-init",dataIdAttr:"data-fileid",animation:600,draggable:a,scroll:!(n=function(){e.removeClass("file-grabbing")}),forceFallback:!0,onChoose:a=function(){e.addClass("file-grabbing")},onStart:a,onUnchoose:n,onEnd:n,onSort:function(l){var c,u=l.oldIndex,m=l.newIndex,g=0,h=t.initialPreviewConfig.length,p=0<h&&h<=m,w=f(l.item);p&&(m=h-1),t.initialPreview=s.moveArray(t.initialPreview,u,m,o),t.initialPreviewConfig=s.moveArray(t.initialPreviewConfig,u,m,o),t.previewCache.init(),t.getFrames(".file-preview-initial").each(function(){f(this).attr("data-fileindex",s.INIT_FLAG+g),g++}),p&&(c=t.getFrames(":not(.file-preview-initial):first")).length&&w.slideUp(function(){w.insertBefore(c).slideDown()}),t._raise("filesorted",{previewId:w.attr("id"),oldIndex:u,newIndex:m,stack:t.initialPreviewConfig})}},f.extend(!0,n,t.fileActionSettings.dragSettings),t.sortable&&t.sortable.destroy(),t.sortable=d.create(i[0],n))},_setPreviewContent:function(e){s.setHtml(this.$preview,e),this._autoFitContent()},_initPreviewImageOrientations:function(){var e=this,t=0,i=e.canOrientImage;(e.autoOrientImageInitial||i)&&e.getFrames(".file-preview-initial").each(function(){var a,r,n=f(this),o=e.initialPreviewConfig[t];o&&o.exif&&o.exif.Orientation&&(r=n.attr("id"),a=n.find(">.kv-file-content img"),r=e._getZoom(r," >.kv-file-content img"),i?a.css("image-orientation",e.autoOrientImageInitial?"from-image":"none"):e.setImageOrientation(a,r,o.exif.Orientation,n)),t++})},_initPreview:function(e){var t,i=this,a=i.initialCaption||"";if(!i.previewCache.count(!0))return i._clearPreview(),void(e?i._setCaption(a):i._initCaption());t=i.previewCache.out(),a=e&&i.initialCaption?i.initialCaption:t.caption,i._setPreviewContent(t.content),i._setInitThumbAttr(),i._setCaption(a),i._initSortable(),s.isEmpty(t.content)||i.$container.removeClass("file-input-new"),i._initPreviewImageOrientations()},_getZoomButton:function(e){var t=this.previewZoomButtonIcons[e],i=this.previewZoomButtonClasses[e],a=' title="'+(this.previewZoomButtonTitles[e]||"")+'" '+(e==="close"?' data-dismiss="modal" aria-hidden="true"':"");return e!=="fullscreen"&&e!=="borderless"&&e!=="toggleheader"||(a+=' data-toggle="button" aria-pressed="false" autocomplete="off"'),'<button type="button" class="'+i+" btn-"+e+'"'+a+">"+t+"</button>"},_getModalContent:function(){var e=this;return e._getLayoutTemplate("modal").setTokens({rtl:e.rtl?" kv-rtl":"",zoomFrameClass:e.frameClass,heading:e.msgZoomModalHeading,prev:e._getZoomButton("prev"),next:e._getZoomButton("next"),toggleheader:e._getZoomButton("toggleheader"),fullscreen:e._getZoomButton("fullscreen"),borderless:e._getZoomButton("borderless"),close:e._getZoomButton("close")})},_listenModalEvent:function(e){var t=this,i=t.$modal;i.on(e+".bs.modal",function(a){var r,n;a.namespace==="bs.modal"&&(r=i.find(".btn-fullscreen"),n=i.find(".btn-borderless"),i.data("fileinputPluginId")===t.$element.attr("id")&&t._raise("filezoom"+e,{sourceEvent:a,previewId:i.data("previewId"),modal:i}),e==="shown"&&(n.removeClass("active").attr("aria-pressed","false"),r.removeClass("active").attr("aria-pressed","false"),i.hasClass("file-zoom-fullscreen")&&(t._maximizeZoomDialog(),(s.checkFullScreen()?r:n).addClass("active").attr("aria-pressed","true"))))})},_initZoom:function(){var e=this,t=e._getLayoutTemplate("modalMain"),i="#"+s.MODAL_ID;e.showPreview&&(e.$modal=f(i),e.$modal&&e.$modal.length||(t=s.createElement(s.cspBuffer.stash(t)).insertAfter(e.$container),e.$modal=f(i).insertBefore(t),s.cspBuffer.apply(e.$modal),t.remove()),s.initModal(e.$modal),e.$modal.html(s.cspBuffer.stash(e._getModalContent())),s.cspBuffer.apply(e.$modal),f.each(s.MODAL_EVENTS,function(a,r){e._listenModalEvent(r)}))},_initZoomButtons:function(){var e,t=this.$modal.data("previewId")||"",i=this.getFrames().toArray(),a=i.length,r=this.$modal.find(".btn-prev"),n=this.$modal.find(".btn-next");if(i.length<2)return r.hide(),void n.hide();r.show(),n.show(),a&&(e=f(i[0]),a=f(i[a-1]),r.removeAttr("disabled"),n.removeAttr("disabled"),e.length&&e.attr("id")===t&&r.attr("disabled",!0),a.length&&a.attr("id")===t&&n.attr("disabled",!0))},_maximizeZoomDialog:function(){var e=this.$modal,t=e.find(".modal-header:visible"),i=e.find(".modal-footer:visible"),a=e.find(".modal-body"),r=f(window).height();e.addClass("file-zoom-fullscreen"),t&&t.length&&(r-=t.outerHeight(!0)),i&&i.length&&(r-=i.outerHeight(!0)),a&&a.length&&(r-=a.outerHeight(!0)-a.height()),e.find(".kv-zoom-body").height(r)},_resizeZoomDialog:function(e){var t=this,i=t.$modal,a=i.find(".btn-fullscreen"),r=i.find(".btn-borderless");if(i.hasClass("file-zoom-fullscreen"))s.toggleFullScreen(!1),e?a.hasClass("active")||(i.removeClass("file-zoom-fullscreen"),t._resizeZoomDialog(!0),r.hasClass("active")&&r.removeClass("active").attr("aria-pressed","false")):a.hasClass("active")?a.removeClass("active").attr("aria-pressed","false"):(i.removeClass("file-zoom-fullscreen"),t.$modal.find(".kv-zoom-body").css("height",t.zoomModalHeight));else{if(!e)return void t._maximizeZoomDialog();s.toggleFullScreen(!0)}i.focus()},_setZoomContent:function(h,t){var i,a,r,n=this,o=h.attr("id"),g=n._getZoom(o),d=n.$modal,l=d.find(".btn-fullscreen"),c=d.find(".btn-borderless"),u=d.find(".btn-toggleheader"),m=g.attr("data-template")||"generic",g=g.find(".kv-file-content"),g=g.length?g.html():"",h=(h.data("caption")||"")+" "+(h.data("size")||"");d.find(".kv-zoom-title").attr("title",f("<div/>").html(h).text()).html(h),i=d.find(".kv-zoom-body"),d.removeClass("kv-single-content"),t?(r=i.addClass("file-thumb-loading").clone().insertAfter(i),s.setHtml(i,g).hide(),r.fadeOut("fast",function(){i.fadeIn("fast",function(){i.removeClass("file-thumb-loading")}),r.remove()})):s.setHtml(i,g),(m=n.previewZoomSettings[m])&&(a=i.find(".kv-preview-data"),s.addCss(a,"file-zoom-detail"),f.each(m,function(p,w){a.css(p,w),(a.attr("width")&&p==="width"||a.attr("height")&&p==="height")&&a.removeAttr(p)})),d.data("previewId",o),n._handler(d.find(".btn-prev"),"click",function(){n._zoomSlideShow("prev",o)}),n._handler(d.find(".btn-next"),"click",function(){n._zoomSlideShow("next",o)}),n._handler(l,"click",function(){n._resizeZoomDialog(!0)}),n._handler(c,"click",function(){n._resizeZoomDialog(!1)}),n._handler(u,"click",function(){function p(C){var F=n.$modal.find(".kv-zoom-body"),y=n.zoomModalHeight;d.hasClass("file-zoom-fullscreen")&&(y=F.outerHeight(!0),C||(y-=v.outerHeight(!0))),F.css("height",C?y+C:y)}var w,v=d.find(".modal-header"),b=d.find(".modal-body .floating-buttons"),_=v.find(".kv-zoom-actions");v.is(":visible")?(w=v.outerHeight(!0),v.slideUp("slow",function(){_.find(".btn").appendTo(b),p(w)})):(b.find(".btn").appendTo(_),v.slideDown("slow",function(){p()})),d.focus()}),n._handler(d,"keydown",function(F){var w=F.which||F.keyCode,v=f(this).find(".btn-prev"),b=f(this).find(".btn-next"),_=f(this).data("previewId"),C=n.rtl?39:37,F=n.rtl?37:39;w===C&&v.length&&!v.attr("disabled")&&n._zoomSlideShow("prev",_),w===F&&b.length&&!b.attr("disabled")&&n._zoomSlideShow("next",_)})},_showModal:function(e){var t=this,i=t.$modal;e&&e.length&&(s.initModal(i),s.setHtml(i,t._getModalContent()),t._setZoomContent(e),i.data("fileinputPluginId",t.$element.attr("id")),i.modal("show"),t._initZoomButtons())},_zoomPreview:function(e){if(!e.length)throw"Cannot zoom to detailed preview!";e=e.closest(s.FRAMES),this._showModal(e)},_zoomSlideShow:function(e,t){var i,a,r,n=this,o=n.$modal.find(".kv-zoom-actions .btn-"+e),d=n.getFrames().toArray(),l=[],c=d.length;if(!o.attr("disabled")){for(i=0;i<c;i++)(a=f(d[i]))&&a.length&&a.find(".kv-file-zoom:visible").length&&l.push(d[i]);for(c=l.length,i=0;i<c;i++)if(f(l[i]).attr("id")===t){r=e==="prev"?i-1:i+1;break}r<0||c<=r||!l[r]||((o=f(l[r])).length&&n._setZoomContent(o,!0),n._initZoomButtons(),n._raise("filezoom"+e,{previewId:t,modal:n.$modal}))}},_initZoomButton:function(){var e=this;e.$preview.find(".kv-file-zoom").each(function(){var t=f(this);e._handler(t,"click",function(){e._zoomPreview(t)})})},_inputFileCount:function(){return this.$element[0].files.length},_refreshPreview:function(){var e,t=this;(t._inputFileCount()||t.isAjaxUpload)&&t.showPreview&&t.isPreviewable&&(t.isAjaxUpload&&0<t.fileManager.count()?(e=f.extend(!0,{},t.getFileList()),t.fileManager.clear(),t._clearFileInput()):e=t.$element[0].files,e&&e.length&&(t.readFiles(e),t._setFileDropZoneTitle()))},_clearObjects:function(e){e.find("video audio").each(function(){this.pause(),f(this).remove()}),e.find("img object div").each(function(){f(this).remove()})},_clearFileInput:function(){var e,t,i,a=this.$element;this._inputFileCount()&&(e=a.closest("form"),t=f(document.createElement("form")),i=f(document.createElement("div")),a.before(i),(e.length?e:i).after(t),t.append(a).trigger("reset"),i.before(a).remove(),t.remove())},_resetUpload:function(){var e=this;e.uploadStartTime=s.now(),e.uploadCache=[],e.$btnUpload.removeAttr("disabled"),e._setProgress(0),e._hideProgress(),e._resetErrors(!1),e._initAjax(),e.fileManager.clearImages(),e._resetCanvas(),e.overwriteInitial&&(e.initialPreview=[],e.initialPreviewConfig=[],e.initialPreviewThumbTags=[],e.previewCache.data={content:[],config:[],tags:[]})},_resetCanvas:function(){var e=this;e.canvas&&e.imageCanvasContext&&e.imageCanvasContext.clearRect(0,0,e.canvas.width,e.canvas.height)},_hasInitialPreview:function(){return!this.overwriteInitial&&this.previewCache.count(!0)},_resetPreview:function(){var e,t,i=this,a=i.showUploadedThumbs,r=!i.removeFromPreviewOnError,n=(a||r)&&i.isDuplicateError;i.previewCache.count(!0)?(e=i.previewCache.out(),n&&(t=s.createElement("").insertAfter(i.$container),i.getFrames().each(function(){var o=f(this);(a&&o.hasClass("file-preview-success")||r&&o.hasClass("file-preview-error"))&&t.append(o)})),i._setPreviewContent(e.content),i._setInitThumbAttr(),e=i.initialCaption||e.caption,i._setCaption(e),n&&(t.contents().appendTo(i.$preview),t.remove())):(i._clearPreview(),i._initCaption()),i.showPreview&&(i._initZoom(),i._initSortable()),i.isDuplicateError=!1},_clearDefaultPreview:function(){this.$preview.find(".file-default-preview").remove()},_validateDefaultPreview:function(){var e=this;e.showPreview&&!s.isEmpty(e.defaultPreviewContent)&&(e._setPreviewContent('<div class="file-default-preview">'+e.defaultPreviewContent+"</div>"),e.$container.removeClass("file-input-new"),e._initClickable())},_resetPreviewThumbs:function(e){var t=this;if(e)return t._clearPreview(),void t.clearFileStack();t._hasInitialPreview()?(e=t.previewCache.out(),t._setPreviewContent(e.content),t._setInitThumbAttr(),t._setCaption(e.caption),t._initPreviewActions()):t._clearPreview()},_getLayoutTemplate:function(e){return e=this.layoutTemplates[e],s.isEmpty(this.customLayoutTags)?e:s.replaceTags(e,this.customLayoutTags)},_getPreviewTemplate:function(e){var t=this.previewTemplates,t=t[e]||t.other;return s.isEmpty(this.customPreviewTags)?t:s.replaceTags(t,this.customPreviewTags)},_getOutData:function(e,t,i,a){var r=this;return t=t||{},i=i||{},{formdata:e,files:a=a||r.fileManager.list(),filenames:r.filenames,filescount:r.getFilesCount(),extra:r._getExtraData(),response:i,reader:r.reader,jqXHR:t}},_getMsgSelected:function(e){var t=e===1?this.fileSingle:this.filePlural;return 0<e?this.msgSelected.replace("{n}",e).replace("{files}",t):this.msgNoFilesSelected},_getFrame:function(e,t){var i=s.getFrameElement(this.$preview,e);return!this.showPreview||t||i.length||this._log(s.logMessages.invalidThumb,{id:e}),i},_getZoom:function(e,t){return t=s.getZoomElement(this.$preview,e,t),this.showPreview&&!t.length&&this._log(s.logMessages.invalidThumb,{id:e}),t},_getThumbs:function(e){return e=e||"",this.getFrames(":not(.file-preview-initial)"+e)},_getThumbId:function(e){return this.previewInitId+"-"+e},_getExtraData:function(e,t){var i=this.uploadExtraData;return typeof this.uploadExtraData=="function"&&(i=this.uploadExtraData(e,t)),i},_initXhr:function(e,t){var i=this,a=i.fileManager,r=function(n){var o=0,d=n.total,l=n.loaded||n.position,c=a.getUploadStats(t,l,d);n.lengthComputable&&!i.enableResumableUpload&&(o=s.round(l/d*100)),t?i._setFileUploadStats(t,o,c):i._setProgress(o,null,null,i._getStats(c)),i._raise("fileajaxprogress",[c])};return e.upload&&(i.progressDelay&&(r=s.debounce(r,i.progressDelay)),e.upload.addEventListener("progress",r,!1)),e},_initAjaxSettings:function(){this._ajaxSettings=f.extend(!0,{},this.ajaxSettings),this._ajaxDeleteSettings=f.extend(!0,{},this.ajaxDeleteSettings)},_mergeAjaxCallback:function(e,t,i){var a,r=this._ajaxSettings,n=this.mergeAjaxCallbacks;i==="delete"&&(r=this._ajaxDeleteSettings,n=this.mergeAjaxDeleteCallbacks),a=r[e],r[e]=n&&typeof a=="function"?n==="before"?function(){a.apply(this,arguments),t.apply(this,arguments)}:function(){t.apply(this,arguments),a.apply(this,arguments)}:t},_ajaxSubmit:function(e,t,i,a,r,n,o,d){var l=this;l._raise("filepreajax",[r,n,o])&&(r.append("initialPreview",JSON.stringify(l.initialPreview)),r.append("initialPreviewConfig",JSON.stringify(l.initialPreviewConfig)),r.append("initialPreviewThumbTags",JSON.stringify(l.initialPreviewThumbTags)),l._initAjaxSettings(),l._mergeAjaxCallback("beforeSend",e),l._mergeAjaxCallback("success",t),l._mergeAjaxCallback("complete",i),l._mergeAjaxCallback("error",a),typeof(d=d||l.uploadUrlThumb||l.uploadUrl)=="function"&&(d=d()),typeof(a=l._getExtraData(n,o)||{})=="object"&&f.each(a,function(c,u){r.append(c,u)}),d={xhr:function(){var c=f.ajaxSettings.xhr();return l._initXhr(c,n)},url:l._encodeURI(d),type:"POST",dataType:"json",data:r,cache:!1,processData:!1,contentType:!1},d=f.extend(!0,{},d,l._ajaxSettings),o=l.taskManager.addTask(n+"-"+o,function(){var c=this.self,u=c.ajaxQueue.shift(),u=f.ajax(u);c.ajaxRequests.push(u)}),l.ajaxQueue.push(d),o.runWithContext({self:l}))},_mergeArray:function(e,a){var i=s.cleanArray(this[e]),a=s.cleanArray(a);this[e]=i.concat(a)},_initUploadSuccess:function(e,t,i){var a,r,n,o,d,l=this;l.showPreview&&typeof e=="object"&&!f.isEmptyObject(e)&&e.initialPreview!==void 0&&0<e.initialPreview.length&&(l.hasInitData=!0,r=e.initialPreview||[],n=e.initialPreviewConfig||[],o=e.initialPreviewThumbTags||[],e=e.append===void 0||e.append,0<r.length&&!s.isArray(r)&&(r=r.split(l.initialPreviewDelimiter)),r.length&&(l._mergeArray("initialPreview",r),l._mergeArray("initialPreviewConfig",n),l._mergeArray("initialPreviewThumbTags",o)),t!==void 0?i?(d=t.attr("id"),(i=l._getUploadCacheIndex(d))!==null&&(l.uploadCache[i]={id:d,content:r[0],config:n[0]||[],tags:o[0]||[],append:e})):(d=l.previewCache.add(r[0],n[0],o[0],e),d=l.previewCache.get(d,!1),(d=(a=s.createElement(d).hide().appendTo(t)).find(".kv-zoom-cache"))&&d.length&&d.appendTo(t),t.fadeOut("slow",function(){var c=a.find(".file-preview-frame");c&&c.length&&c.insertBefore(t).fadeIn("slow").css("display:inline-block"),l._initPreviewActions(),l._clearFileInput(),t.remove(),a.remove(),l._initSortable()})):(l.previewCache.set(r,n,o,e),l._initPreview(),l._initPreviewActions())),l._resetCaption()},_getUploadCacheIndex:function(e){for(var t=this.uploadCache.length,i=0;i<t;i++)if(this.uploadCache[i].id===e)return i;return null},_initSuccessThumbs:function(){var e=this;e.showPreview&&e._getThumbs(s.FRAMES+".file-preview-success").each(function(){var t=f(this),i=t.find(".kv-file-remove");i.removeAttr("disabled"),e._handler(i,"click",function(){var a=t.attr("id"),a=e._raise("filesuccessremove",[a,t.attr("data-fileindex")]);s.cleanMemory(t),a!==!1&&t.fadeOut("slow",function(){t.remove(),e.getFrames().length||e.reset()})})})},_updateInitialPreview:function(){var e=this,t=e.uploadCache;e.showPreview&&(f.each(t,function(i,a){e.previewCache.add(a.content,a.config,a.tags,a.append)}),e.hasInitData&&(e._initPreview(),e._initPreviewActions()))},_getThumbFileId:function(e){return this.showPreview&&e!==void 0?e.attr("data-fileid"):null},_getThumbFile:function(e){return e=this._getThumbFileId(e),e?this.fileManager.getFile(e):null},_uploadSingle:function(e,t,i){var a,r,n,o,d,l,c,u,m,g,h,p=this,w=p.fileManager,v=w.count(),b=new FormData,_=p._getThumbId(t),C=0<v||!f.isEmptyObject(p.uploadExtraData),F=p.ajaxOperations.uploadThumb,y=w.getFile(t),x={id:_,index:e,fileId:t},E=p.fileManager.getFileName(t,!0);p.enableResumableUpload||(p.showPreview&&(r=w.getThumb(t),c=r.find(".file-thumb-progress"),o=r.find(".kv-file-upload"),d=r.find(".kv-file-remove"),c.show()),v===0||!C||p.showPreview&&o&&o.hasClass("disabled")||p._abort(x)||(h=function(){l?w.errors.push(t):w.removeFile(t),w.setProcessed(t),w.isProcessed()&&(p.fileBatchCompleted=!0,n())},n=function(){var P;p.fileBatchCompleted&&setTimeout(function(){var k=w.count()===0,I=w.errors.length;p._updateInitialPreview(),p.unlock(k),k&&p._clearFileInput(),P=p.$preview.find(".file-preview-initial"),p.uploadAsync&&P.length&&(s.addCss(P,s.SORT_CSS),p._initSortable()),p._raise("filebatchuploadcomplete",[w.stack,p._getExtraData()]),p.retryErrorUploads&&I!==0||w.clear(),p._setProgress(101),p.ajaxAborted=!1},p.processDelay)},u=function(P){a=p._getOutData(b,P),w.initStats(t),p.fileBatchCompleted=!1,i||(p.ajaxAborted=!1),p.showPreview&&(r.hasClass("file-preview-success")||(p._setThumbStatus(r,"Loading"),s.addCss(r,"file-uploading")),o.attr("disabled",!0),d.attr("disabled",!0)),i||p.lock(),w.errors.indexOf(t)!==-1&&delete w.errors[t],p._raise("filepreupload",[a,_,e,p._getThumbFileId(r)]),f.extend(!0,x,a),p._abort(x)&&(P.abort(),i||(p._setThumbStatus(r,"New"),r.removeClass("file-uploading"),o.removeAttr("disabled"),d.removeAttr("disabled"),p.unlock()),p._setProgressCancelled())},g=function(P,k,I){var T=p.showPreview&&r.attr("id")?r.attr("id"):_;a=p._getOutData(b,I,P),f.extend(!0,x,a),setTimeout(function(){s.isEmpty(P)||s.isEmpty(P.error)?(p.showPreview&&(p._setThumbStatus(r,"Success"),o.hide(),p._initUploadSuccess(P,r,i),p._setProgress(101,c)),p._raise("fileuploaded",[a,T,e,p._getThumbFileId(r)]),i?h():p.fileManager.remove(r)):(l=!0,m=p._parseError(F,I,p.msgUploadError,p.fileManager.getFileName(t)),p._showFileError(m,x),p._setPreviewError(r,!0),p.retryErrorUploads||o.hide(),i&&h(),p._setProgress(101,p._getFrame(T).find(".file-thumb-progress"),p.msgUploadError))},p.processDelay)},v=function(){p.showPreview&&(o.removeAttr("disabled"),d.removeAttr("disabled"),r.removeClass("file-uploading")),i?n():(p.unlock(!1),p._clearFileInput()),p._initSuccessThumbs()},C=function(P,k,I){m=p._parseError(F,P,I,p.fileManager.getFileName(t)),l=!0,setTimeout(function(){var T;i&&h(),p.fileManager.setProgress(t,100),p._setPreviewError(r,!0),p.retryErrorUploads||o.hide(),f.extend(!0,x,p._getOutData(b,P)),p._setProgress(101,p.$progress,p.msgAjaxProgressError.replace("{operation}",F)),T=p.showPreview&&r?r.find(".file-thumb-progress"):"",p._setProgress(101,T,p.msgUploadError),p._showFileError(m,x)},p.processDelay)},p._setFileData(b,y.file,E,t),p._setUploadData(b,{fileId:t}),p._ajaxSubmit(u,g,v,C,b,t,e)))},_setFileData:function(e,t,i,a){var r=this.preProcessUpload;r&&typeof r=="function"?e.append(this.uploadFileAttr,r(a,t)):e.append(this.uploadFileAttr,t,i)},_uploadBatch:function(){var e,t,i,a,r,n,o=this,d=o.fileManager,l=d.total(),c=0<l||!f.isEmptyObject(o.uploadExtraData),u=new FormData,m=o.ajaxOperations.uploadBatch;l!==0&&c&&!o._abort({})&&(r=function(){o.fileManager.clear(),o._clearFileInput()},e=function(g){o.lock(),d.initStats();var h=o._getOutData(u,g);o.ajaxAborted=!1,o.showPreview&&o._getThumbs().each(function(){var p=f(this),w=p.find(".kv-file-upload"),v=p.find(".kv-file-remove");p.hasClass("file-preview-success")||(o._setThumbStatus(p,"Loading"),s.addCss(p,"file-uploading")),w.attr("disabled",!0),v.attr("disabled",!0)}),o._raise("filebatchpreupload",[h]),o._abort(h)&&(g.abort(),o._getThumbs().each(function(){var p=f(this),w=p.find(".kv-file-upload"),v=p.find(".kv-file-remove");p.hasClass("file-preview-loading")&&(o._setThumbStatus(p,"New"),p.removeClass("file-uploading")),w.removeAttr("disabled"),v.removeAttr("disabled")}),o._setProgressCancelled())},t=function(g,h,p){var w=o._getOutData(u,p,g),v=0,b=o._getThumbs(":not(.file-preview-success)"),_=s.isEmpty(g)||s.isEmpty(g.errorkeys)?[]:g.errorkeys;s.isEmpty(g)||s.isEmpty(g.error)?(o._raise("filebatchuploadsuccess",[w]),r(),o.showPreview?(b.each(function(){var C=f(this);o._setThumbStatus(C,"Success"),C.removeClass("file-uploading"),C.find(".kv-file-upload").hide().removeAttr("disabled")}),o._initUploadSuccess(g)):o.reset(),o._setProgress(101)):(o.showPreview&&(b.each(function(){var C=f(this);C.removeClass("file-uploading"),C.find(".kv-file-upload").removeAttr("disabled"),C.find(".kv-file-remove").removeAttr("disabled"),_.length===0||f.inArray(v,_)!==-1?(o._setPreviewError(C,!0),o.retryErrorUploads||(C.find(".kv-file-upload").hide(),o.fileManager.remove(C))):(C.find(".kv-file-upload").hide(),o._setThumbStatus(C,"Success"),o.fileManager.remove(C)),C.hasClass("file-preview-error")&&!o.retryErrorUploads||v++}),o._initUploadSuccess(g)),a=o._parseError(m,p,o.msgUploadError),o._showFileError(a,w,"filebatchuploaderror"),o._setProgress(101,o.$progress,o.msgUploadError))},i=function(){o.unlock(),o._initSuccessThumbs(),o._clearFileInput(),o._raise("filebatchuploadcomplete",[o.fileManager.stack,o._getExtraData()])},c=function(g,h,p){var w=o._getOutData(u,g);a=o._parseError(m,g,p),o._showFileError(a,w,"filebatchuploaderror"),o.uploadFileCount=l-1,o.showPreview&&(o._getThumbs().each(function(){var v=f(this);v.removeClass("file-uploading"),o._getThumbFile(v)&&o._setPreviewError(v)}),o._getThumbs().removeClass("file-uploading"),o._getThumbs(" .kv-file-upload").removeAttr("disabled"),o._getThumbs(" .kv-file-delete").removeAttr("disabled"),o._setProgress(101,o.$progress,o.msgAjaxProgressError.replace("{operation}",m)))},n=0,f.each(o.fileManager.stack,function(g,h){s.isEmpty(h.file)||o._setFileData(u,h.file,h.nameFmt||"untitled_"+n,g),n++}),o._ajaxSubmit(e,t,i,c,u))},_uploadExtraOnly:function(){var e,t,i,a,r,n=this,o={},d=new FormData,l=n.ajaxOperations.uploadExtra;n._abort(o)||(e=function(c){n.lock();var u=n._getOutData(d,c);n._raise("filebatchpreupload",[u]),n._setProgress(50),o.data=u,o.xhr=c,n._abort(o)&&(c.abort(),n._setProgressCancelled())},t=function(c,u,m){var g=n._getOutData(d,m,c);s.isEmpty(c)||s.isEmpty(c.error)?(n._raise("filebatchuploadsuccess",[g]),n._clearFileInput(),n._initUploadSuccess(c),n._setProgress(101)):(r=n._parseError(l,m,n.msgUploadError),n._showFileError(r,g,"filebatchuploaderror"))},i=function(){n.unlock(),n._clearFileInput(),n._raise("filebatchuploadcomplete",[n.fileManager.stack,n._getExtraData()])},a=function(c,u,m){var g=n._getOutData(d,c);r=n._parseError(l,c,m),o.data=g,n._showFileError(r,g,"filebatchuploaderror"),n._setProgress(101,n.$progress,n.msgAjaxProgressError.replace("{operation}",l))},n._ajaxSubmit(e,t,i,a,d))},_deleteFileIndex:function(a){var t=this,i=a.attr("data-fileindex"),a=t.reversePreviewOrder;i.substring(0,5)===s.INIT_FLAG&&(i=parseInt(i.replace(s.INIT_FLAG,"")),t.initialPreview=s.spliceArray(t.initialPreview,i,a),t.initialPreviewConfig=s.spliceArray(t.initialPreviewConfig,i,a),t.initialPreviewThumbTags=s.spliceArray(t.initialPreviewThumbTags,i,a),t.getFrames().each(function(){var r=f(this),n=r.attr("data-fileindex");n.substring(0,5)===s.INIT_FLAG&&(n=parseInt(n.replace(s.INIT_FLAG,"")),i<n&&(n--,r.attr("data-fileindex",s.INIT_FLAG+n)))}))},_resetCaption:function(){var e=this;setTimeout(function(){var t,i=e.previewCache.count(!0),a=e.fileManager.count(),r=e.showPreview&&e.getFrames(":not(.file-preview-success):not(.file-preview-error)").length;a!==0||i!==0||r?(t=1<(a=i+a)?e._getMsgSelected(a):(t=e.fileManager.getFirstFile())?t.nameFmt:"_",e._setCaption(t)):e.reset()},e.processDelay)},_initFileActions:function(){var e=this;e.showPreview&&(e._initZoomButton(),e.getFrames(" .kv-file-remove").each(function(){var t,i=f(this),a=i.closest(s.FRAMES),r=a.attr("id"),n=a.attr("data-fileindex");e._handler(i,"click",function(){return!(e._raise("filepreremove",[r,n])===!1||!e._validateMinCount())&&(t=a.hasClass("file-preview-error"),s.cleanMemory(a),void a.fadeOut("slow",function(){e.fileManager.remove(a),e._clearObjects(a),a.remove(),r&&t&&e.$errorContainer.find('li[data-thumb-id="'+r+'"]').fadeOut("fast",function(){f(this).remove(),e._errorsExist()||e._resetErrors()}),e._clearFileInput(),e._resetCaption(),e._raise("fileremoved",[r,n])}))})}),e.getFrames(" .kv-file-upload").each(function(){var t=f(this);e._handler(t,"click",function(){var i=t.closest(s.FRAMES),a=e._getThumbFileId(i);e._hideProgress(),i.hasClass("file-preview-error")&&!e.retryErrorUploads||e._uploadSingle(e.fileManager.getIndex(a),a,!1)})}))},_initPreviewActions:function(){function e(){var l=t.isAjaxUpload?t.previewCache.count(!0):t._inputFileCount();t.getFrames().length||l||(t._setCaption(""),t.reset(),t.initialCaption="")}var t=this,i=t.$preview,a=t.deleteExtraData||{},r=s.FRAMES+" .kv-file-remove",n=t.fileActionSettings,o=n.removeClass,d=n.removeErrorClass;t._initZoomButton(),i.find(r).each(function(){var l,c,u,m,g,h,p,w,v,b,_=f(this),C=_.data("url")||t.deleteUrl,F=_.data("key"),y=t.ajaxOperations.deleteThumb;s.isEmpty(C)||F===void 0||(typeof C=="function"&&(C=C()),u=_.closest(s.FRAMES),m=t.previewCache.data,p=u.attr("data-fileindex"),p=parseInt(p.replace(s.INIT_FLAG,"")),w=s.isEmpty(m.config)&&s.isEmpty(m.config[p])?null:m.config[p],v=s.isEmpty(w)||s.isEmpty(w.extra)?a:w.extra,b=w&&(w.filename||w.caption)||"",typeof v=="function"&&(v=v()),h={id:_.attr("id"),key:F,extra:v},c=function(x){t.ajaxAborted=!1,t._raise("filepredelete",[F,x,v]),t._abort()?x.abort():(_.removeClass(d),s.addCss(u,"file-uploading"),s.addCss(_,"disabled "+o))},m=function(x,E,P){var k;if(!s.isEmpty(x)&&!s.isEmpty(x.error))return h.jqXHR=P,h.response=x,l=t._parseError(y,P,t.msgDeleteError,b),t._showFileError(l,h,"filedeleteerror"),u.removeClass("file-uploading"),_.removeClass("disabled "+o).addClass(d),void e();u.removeClass("file-uploading").addClass("file-deleted"),u.fadeOut("slow",function(){p=parseInt(u.attr("data-fileindex").replace(s.INIT_FLAG,"")),t.previewCache.unset(p),t._deleteFileIndex(u),k=t.previewCache.count(!0),k=0<k?t._getMsgSelected(k):"",t._setCaption(k),t._raise("filedeleted",[F,P,v]),t._clearObjects(u),u.remove(),e()})},w=function(x,E,P){P=t._parseError(y,x,P,b),h.jqXHR=x,h.response={},t._showFileError(P,h,"filedeleteerror"),u.removeClass("file-uploading"),_.removeClass("disabled "+o).addClass(d),e()},t._initAjaxSettings(),t._mergeAjaxCallback("beforeSend",c,"delete"),t._mergeAjaxCallback("success",m,"delete"),t._mergeAjaxCallback("error",w,"delete"),g=f.extend(!0,{},{url:t._encodeURI(C),type:"POST",dataType:"json",data:f.extend(!0,{},{key:F},v)},t._ajaxDeleteSettings),t._handler(_,"click",function(){return!!t._validateMinCount()&&(t.ajaxAborted=!1,t._raise("filebeforedelete",[F,v]),void(t.ajaxAborted instanceof Promise?t.ajaxAborted.then(function(x){x||f.ajax(g)}):t.ajaxAborted||f.ajax(g)))}))})},_hideFileIcon:function(){this.overwriteInitial&&this.$captionContainer.removeClass("icon-visible")},_showFileIcon:function(){s.addCss(this.$captionContainer,"icon-visible")},_getSize:function(e,t){var i,a=parseFloat(e),r=this.fileSizeGetter;return f.isNumeric(e)&&f.isNumeric(a)?(i=typeof r=="function"?r(a):a===0?"0.00 B":(t=t||["B","KB","MB","GB","TB","PB","EB","ZB","YB"],i=Math.floor(Math.log(a)/Math.log(1024)),(a/Math.pow(1024,i)).toFixed(2)+" "+t[i]),this._getLayoutTemplate("size").replace("{sizeText}",i)):""},_getFileType:function(e){return this.mimeTypeAliases[e]||e},_generatePreviewTemplate:function(e,t,i,a,r,n,k,P,l,E,u,m,g,h){var p=this,w=p.slug(i),v="",b="",_=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,C=w,F=w,y="type-default",x=E||p._renderFileFooter(e,w,P,"auto",k),E=p.preferIconicPreview,P=p.preferIconicZoomPreview,k=E?"other":e,k=_<400?p.previewSettingsSmall[k]||p.defaults.previewSettingsSmall[k]:p.previewSettings[k]||p.defaults.previewSettings[k];return k&&f.each(k,function(I,T){b+=I+":"+T+";"}),k=function(S,T,M,z){var B=M?"zoom-"+r:r,S=p._getPreviewTemplate(S),z=(l||"")+" "+z;return p.frameClass&&(z=p.frameClass+" "+z),M&&(z=z.replace(" "+s.SORT_CSS,"")),S=p._parseFilePreviewIcon(S,i),e!=="object"||a||f.each(p.defaults.fileTypeSettings,function(U,N){U!=="object"&&U!=="other"&&N(i,a)&&(y="type-"+U)}),s.isEmpty(g)||(g.title!==void 0&&g.title!==null&&(C=g.title),g.alt!==void 0&&g.alt!==null&&(C=g.alt)),S.setTokens({previewId:B,caption:w,title:C,alt:F,frameClass:z,type:p._getFileType(a),fileindex:u,fileid:n||"",typeCss:y,footer:x,data:T,template:m||e,style:b?'style="'+b+'"':""})},u=u||r.slice(r.lastIndexOf("-")+1),p.fileActionSettings.showZoom&&(v=k(P?"other":e,h||t,!0,"kv-zoom-thumb")),v=`
`+p._getLayoutTemplate("zoomCache").replace("{zoomContent}",v),typeof p.sanitizeZoomCache=="function"&&(v=p.sanitizeZoomCache(v)),k(E?"other":e,t,!1,"kv-preview-thumb").setTokens({zoomCache:v})},_addToPreview:function(e,t){return t=s.cspBuffer.stash(t),t=this.reversePreviewOrder?e.prepend(t):e.append(t),s.cspBuffer.apply(e),t},_previewDefault:function(e,t){var i,a,r,n,o,d,l,c=this,u=c.$preview;c.showPreview&&(i=s.getFileName(e),a=e?e.type:"",r=e.size||0,n=c._getFileName(e,""),o=t===!0&&!c.isAjaxUpload,d=s.createObjectURL(e),l=c.fileManager.getId(e),e=c._getThumbId(l),c._clearDefaultPreview(),o=c._generatePreviewTemplate("other",d,i,a,e,l,o,r),c._addToPreview(u,o),c._setThumbAttr(e,n,r),t===!0&&c.isAjaxUpload&&c._setThumbStatus(c._getFrame(e),"Error"))},_previewFile:function(e,t,i,a,r){var n,o,d,l,c,u,m;this.showPreview&&(n=this,m=s.getFileName(t),o=r.type,d=r.name,l=n._parseFileType(o,m),c=n.$preview,u=t.size||0,r=l==="image"?i.target.result:a,i=n.fileManager.getId(t),a=n._getThumbId(i),m=n._generatePreviewTemplate(l,r,m,o,a,i,!1,u),n._clearDefaultPreview(),n._addToPreview(c,m),m=n._getFrame(a),n._validateImageOrientation(m.find("img"),t,a,i,d,o,u,r),n._setThumbAttr(a,d,u),n._initSortable())},_setThumbAttr:function(e,t,i){e=this._getFrame(e),e.length&&(i=i&&0<i?this._getSize(i):"",e.data({caption:t,size:i}))},_setInitThumbAttr:function(){var e,t,i,a=this.previewCache.data,r=this.previewCache.count(!0);if(r!==0)for(var n=0;n<r;n++)t=a.config[n],i=this.previewInitId+"-"+s.INIT_FLAG+n,e=s.ifSet("caption",t,s.ifSet("filename",t)),t=s.ifSet("size",t),this._setThumbAttr(i,e,t)},_slugDefault:function(e){return s.isEmpty(e,!0)?"":String(e).replace(/[\[\]\/\{}:;#%=\(\)\*\+\?\\\^\$\|<>&"']/g,"_")},_updateFileDetails:function(e,t){var i=this,r=i.$element,n=s.isIE(9)&&s.findFileName(r.val())||r[0].files[0]&&r[0].files[0].name,a=!n&&0<i.fileManager.count()?i.fileManager.getFirstFile().nameFmt:n?i.slug(n):"_",r=i.isAjaxUpload?i.fileManager.count():e,n=i.previewCache.count(!0)+r,n=r===1?a:i._getMsgSelected(n);i.isError?(i.$previewContainer.removeClass("file-thumb-loading"),i.$previewStatus.html(""),i.$captionContainer.removeClass("icon-visible")):i._showFileIcon(),i._setCaption(n,i.isError),i.$container.removeClass("file-input-new file-input-ajax-new"),t||i._raise("fileselect",[e,a]),i.previewCache.count(!0)&&i._initPreviewActions()},_setThumbStatus:function(e,t){var i,a,r,n,o;this.showPreview&&(a=(i="indicator"+t)+"Title",r="file-preview-"+t.toLowerCase(),n=e.find(".file-upload-indicator"),o=this.fileActionSettings,e.removeClass("file-preview-success file-preview-error file-preview-paused file-preview-loading"),t==="Success"&&e.find(".file-drag-handle").remove(),s.setHtml(n,o[i]),n.attr("title",o[a]),e.addClass(r),t!=="Error"||this.retryErrorUploads||e.find(".kv-file-upload").attr("disabled",!0))},_setProgressCancelled:function(){this._setProgress(101,this.$progress,this.msgCancelled)},_setProgress:function(e,t,i,a){var r,n,o,d=this;(t=t||d.$progress).length&&(r=Math.min(e,100),n=d.progressUploadThreshold,o=e<=100?d.progressTemplate:d.progressCompleteTemplate,o=r<100?d.progressTemplate:i?d.paused?d.progressPauseTemplate:d.progressErrorTemplate:o,100<=e&&(a=""),s.isEmpty(o)||(a=a||"",r=(r=n&&n<r&&e<=100?o.setTokens({percent:n,status:d.msgUploadThreshold}):o.setTokens({percent:r,status:100<e?d.msgUploadEnd:r+"%"})).setTokens({stats:a}),s.setHtml(t,r),i&&s.setHtml(t.find('[role="progressbar"]'),i)))},_hasFiles:function(){var e=this.$element[0];return!!(e&&e.files&&e.files.length)},_setFileDropZoneTitle:function(){var e,t=this,i=t.$container.find(".file-drop-zone"),a=t.dropZoneTitle;t.isClickable&&(e=s.isEmpty(t.$element.attr("multiple"))?t.fileSingle:t.filePlural,a+=t.dropZoneClickTitle.replace("{files}",e)),i.find("."+t.dropZoneTitleClass).remove(),!t.showPreview||i.length===0||0<t.fileManager.count()||!t.dropZoneEnabled||0<t.previewCache.count()||!t.isAjaxUpload&&t._hasFiles()||(i.find(s.FRAMES).length===0&&s.isEmpty(t.defaultPreviewContent)&&i.prepend('<div class="'+t.dropZoneTitleClass+'">'+a+"</div>"),t.$container.removeClass("file-input-new"),s.addCss(t.$container,"file-input-ajax-new"))},_getStats:function(e){var t,i;return this.showUploadStats&&e&&e.bitrate?(i=this._getLayoutTemplate("stats"),t=e.elapsed&&e.bps?this.msgPendingTime.setTokens({time:s.getElapsed(Math.ceil(e.pendingBytes/e.bps))}):this.msgCalculatingTime,i.setTokens({uploadSpeed:e.bitrate,pendingTime:t})):""},_setResumableProgress:function(e,t,r){var a=this.resumableManager,a=r?a:this,r=r?r.find(".file-thumb-progress"):null;a.lastProgress===0&&(a.lastProgress=e),e<a.lastProgress&&(e=a.lastProgress),this._setProgress(e,r,null,this._getStats(t)),a.lastProgress=e},_toggleResumableProgress:function(e,t){var i=this.$progress;i&&i.length&&s.setHtml(i,e.setTokens({percent:101,status:t,stats:""}))},_setFileUploadStats:function(e,t,i){var a,r,n,o,d,l,c,u,m,g=this,h=g.$progress;(g.showPreview||h&&h.length)&&(a=g.fileManager,m=g.resumableManager,r=a.getThumb(e),n=0,o=a.getTotalSize(),d=f.extend(!0,{},i),g.enableResumableUpload?(l=i.loaded,c=m.getUploadedSize(),u=m.file.size,l+=c,m=a.uploadedSize+l,t=s.round(100*l/u),i.pendingBytes=u-c,g._setResumableProgress(t,i,r),c=Math.floor(100*m/o),d.pendingBytes=o-m,g._setResumableProgress(c,d)):(a.setProgress(e,t),h=r&&r.length?r.find(".file-thumb-progress"):null,g._setProgress(t,h,null,g._getStats(i)),f.each(a.stats,function(p,w){n+=w.loaded}),d.pendingBytes=o-n,c=s.round(n/o*100),g._setProgress(c,null,null,g._getStats(d))))},_validateMinCount:function(){var e=this,t=e.isAjaxUpload?e.fileManager.count():e._inputFileCount();return!(e.validateInitialCount&&0<e.minFileCount&&e._getFileCount(t-1)<e.minFileCount)||(e._noFilesError({}),!1)},_getFileCount:function(e,t){return t===void 0&&(t=this.validateInitialCount&&!this.overwriteInitial),t&&(e+=this.previewCache.count(!0)),e},_getFileId:function(e){return s.getFileId(e,this.generateFileId)},_getFileName:function(e,t){return e=s.getFileName(e),e?this.slug(e):t},_getFileNames:function(e){return this.filenames.filter(function(t){return e?t!==void 0:t!=null})},_setPreviewError:function(e,t){var i=this,a=i.removeFromPreviewOnError&&!i.retryErrorUploads;t&&!a||i.fileManager.remove(e),i.showPreview&&(a?e.remove():(i._setThumbStatus(e,"Error"),i._refreshUploadButton(e)))},_refreshUploadButton:function(r){var t=r.find(".kv-file-upload"),i=this.fileActionSettings,a=i.uploadIcon,r=i.uploadTitle;t.length&&(this.retryErrorUploads&&(a=i.uploadRetryIcon,r=i.uploadRetryTitle),t.attr("title",r),s.setHtml(t,a))},_checkDimensions:function(e,t,i,a,r,n,o){var d=this[(t==="Small"?"min":"max")+"Image"+n];!s.isEmpty(d)&&i.length&&(i=i[0],i=n==="Width"?i.naturalWidth||i.width:i.naturalHeight||i.height,(t==="Small"?d<=i:i<=d)||(d=this["msgImage"+n+t].setTokens({name:r,size:d}),this._showFileError(d,o),this._setPreviewError(a)))},_getExifObj:function(e){var t,i=s.logMessages.exifWarning;if(e.slice(0,23)==="data:image/jpeg;base64,"||e.slice(0,22)==="data:image/jpg;base64,"){try{t=window.piexif?window.piexif.load(e):null}catch(a){t=null,i=a&&a.message||""}return t||this._log(s.logMessages.badExifParser,{details:i}),t}t=null},setImageOrientation:function(e,t,i,a){var r,n,o=this,d=!e||!e.length,l=!t||!t.length,c=!1,u=d&&a&&a.attr("data-template")==="image";d&&l||(l="load.fileinputimageorient",u?(e=t,t=null,e.css(o.previewSettings.image),n=f(document.createElement("div")).appendTo(a.find(".kv-file-content")),r=f(document.createElement("span")).insertBefore(e),e.css("visibility","hidden").removeClass("file-zoom-detail").appendTo(n)):c=!e.is(":visible"),e.off(l).on(l,function(){c&&(o.$preview.removeClass("hide-content"),a.find(".kv-file-content").css("visibility","hidden"));var m=e[0],g=t&&t.length?t[0]:null,h=m.offsetHeight,v=m.offsetWidth,p=s.getRotation(i);if(c&&(a.find(".kv-file-content").css("visibility","visible"),o.$preview.addClass("hide-content")),e.data("orientation",i),g&&t.data("orientation",i),i<5)return s.setTransform(m,p),void s.setTransform(g,p);var w=Math.atan(v/h),v=Math.sqrt(Math.pow(h,2)+Math.pow(v,2)),v=v?h/Math.cos(Math.PI/2+w)/v:1,v=" scale("+Math.abs(v)+")";s.setTransform(m,p+v),s.setTransform(g,p+v),u&&(e.css("visibility","visible").insertAfter(r).addClass("file-zoom-detail"),r.remove(),n.remove())}))},_validateImageOrientation:function(e,t,i,a,r,n,o,d){var l,c=this,u=null,m=c.autoOrientImage;if(c.canOrientImage)return e.css("image-orientation",m?"from-image":"none"),void c._validateImage(i,a,r,n,o,d,u);l=s.getZoomSelector(i," img"),(m=(u=m?c._getExifObj(d):null)?u["0th"][piexif.ImageIFD.Orientation]:null)&&(c.setImageOrientation(e,f(l),m,c._getFrame(i)),c._raise("fileimageoriented",{$img:e,file:t})),c._validateImage(i,a,r,n,o,d,u)},_validateImage:function(e,t,i,a,r,n,o){var d,l=this,c=l.$preview,u=l._getFrame(e),m=u.attr("data-fileindex"),g=u.find("img");i=i||"Untitled",g.one("load",function(){d=u.width(),c.width()<d&&g.css("width","100%"),d={ind:m,id:e,fileId:t},l._checkDimensions(m,"Small",g,u,i,"Width",d),l._checkDimensions(m,"Small",g,u,i,"Height",d),l.resizeImage||(l._checkDimensions(m,"Large",g,u,i,"Width",d),l._checkDimensions(m,"Large",g,u,i,"Height",d)),l._raise("fileimageloaded",[e]),l.fileManager.addImage(t,{ind:m,img:g,thumb:u,pid:e,typ:a,siz:r,validated:!1,imgData:n,exifObj:o}),u.data("exif",o),l._validateAllImages()}).one("error",function(){l._raise("fileimageloaderror",[e])}).each(function(){this.complete?f(this).trigger("load"):this.error&&f(this).trigger("error")})},_validateAllImages:function(){var e,t=this,i={val:0},a=t.fileManager.getImageCount(),r=t.resizeIfSizeMoreThan;a===t.fileManager.totalImages&&(t._raise("fileimagesloaded"),t.resizeImage&&f.each(t.fileManager.loadedImages,function(n,o){o.validated||((e=o.siz)&&1e3*r<e&&t._getResizedImage(n,o,i,a),o.validated=!0)}))},_getResizedImage:function(e,x,i,a){var r,n,o=this,d=f(x.img)[0],l=d.naturalWidth,c=d.naturalHeight,u=1,m=o.maxImageWidth||l,g=o.maxImageHeight||c,h=!(!l||!c),p=o.imageCanvas,w=o.imageCanvasContext,v=x.typ,b=x.pid,_=x.ind,C=x.thumb,F=x.exifObj,y=function(k,I,T){o.isAjaxUpload?o._showFileError(k,I,T):o._showError(k,I,T),o._setPreviewError(C)},x=o.fileManager.getFile(e),E={id:b,index:_,fileId:e},P=[e,b,_];if(x&&h&&!(l<=m&&c<=g)||(h&&x&&o._raise("fileimageresized",P),i.val++,i.val===a&&o._raise("fileimagesresized"),h)){v=v||o.resizeDefaultImageType,x=m<l,h=g<c,u=o.resizePreference==="width"?x?m/l:h?g/c:1:h?g/c:x?m/l:1,o._resetCanvas(),l*=u,c*=u,p.width=l,p.height=c;try{w.drawImage(d,0,0,l,c),r=p.toDataURL(v,o.resizeQuality),F&&(n=window.piexif.dump(F),r=window.piexif.insert(n,r)),r=s.dataURI2Blob(r),o.fileManager.setFile(e,r),o._raise("fileimageresized",P),i.val++,i.val===a&&o._raise("fileimagesresized",[void 0,void 0]),r instanceof Blob||y(o.msgImageResizeError,E,"fileimageresizeerror")}catch(k){i.val++,i.val===a&&o._raise("fileimagesresized",[void 0,void 0]),y(o.msgImageResizeException.replace("{errors}",k.message),E,"fileimageresizeexception")}}else y(o.msgImageResizeError,E,"fileimageresizeerror")},_showProgress:function(){this.$progress&&this.$progress.length&&this.$progress.show()},_hideProgress:function(){this.$progress&&this.$progress.length&&this.$progress.hide()},_initBrowse:function(e){var t=this.$element;this.showBrowse?this.$btnFile=e.find(".btn-file").append(t):(t.appendTo(e).attr("tabindex",-1),s.addCss(t,"file-no-browse"))},_initClickable:function(){var e,t,i=this;i.isClickable&&(e=i.$dropZone,i.isAjaxUpload||(t=i.$preview.find(".file-default-preview")).length&&(e=t),s.addCss(e,"clickable"),e.attr("tabindex",-1),i._handler(e,"click",function(a){a=f(a.target),i.$errorContainer.is(":visible")||a.parents(".file-preview-thumbnails").length&&!a.parents(".file-default-preview").length||(i.$element.data("zoneClicked",!0).trigger("click"),e.blur())}))},_initCaption:function(){var e=this.initialCaption||"";return this.overwriteInitial||s.isEmpty(e)?(this.$caption.val(""),!1):(this._setCaption(e),!0)},_setCaption:function(e,t){var i,a,r,n=this;if(n.$caption.length){if(n.$captionContainer.removeClass("icon-visible"),t)i=f("<div>"+n.msgValidationError+"</div>").text(),r=(a=n.fileManager.count())?(r=n.fileManager.getFirstFile(),a===1&&r?r.nameFmt:n._getMsgSelected(a)):n._getMsgSelected(n.msgNo),a=s.isEmpty(e)?r:e,r='<span class="'+n.msgValidationErrorClass+'">'+n.msgValidationErrorIcon+"</span>";else{if(s.isEmpty(e))return;a=i=f("<div>"+e+"</div>").text(),r=n._getLayoutTemplate("fileIcon")}n.$captionContainer.addClass("icon-visible"),n.$caption.attr("title",i).val(a),s.setHtml(n.$captionIcon,r)}},_createContainer:function(){var e=this,t={class:"file-input file-input-new"+(e.rtl?" kv-rtl":"")},i=s.createElement(s.cspBuffer.stash(e._renderMain()));return s.cspBuffer.apply(i),i.insertBefore(e.$element).attr(t),e._initBrowse(i),e.theme&&i.addClass("theme-"+e.theme),i},_refreshContainer:function(){var e=this,t=e.$container;e.$element.insertAfter(t),s.setHtml(t,e._renderMain()),e._initBrowse(t),e._validateDisabled()},_validateDisabled:function(){this.$caption.attr({readonly:this.isDisabled})},_renderMain:function(){var e=this,a=e.dropZoneEnabled?" file-drop-zone":"file-drop-disabled",t=e.showClose?e._getLayoutTemplate("close"):"",i=e.showPreview?e._getLayoutTemplate("preview").setTokens({class:e.previewClass,dropClass:a}):"",a=e.isDisabled?e.captionClass+" file-caption-disabled":e.captionClass,a=e.captionTemplate.setTokens({class:a+" kv-fileinput-caption"});return e.mainTemplate.setTokens({class:e.mainClass+(!e.showBrowse&&e.showCaption?" no-browse":""),preview:i,close:t,caption:a,upload:e._renderButton("upload"),remove:e._renderButton("remove"),cancel:e._renderButton("cancel"),pause:e._renderButton("pause"),browse:e._renderButton("browse")})},_renderButton:function(e){var t=this,i=t._getLayoutTemplate("btnDefault"),a=t[e+"Class"],r=t[e+"Title"],n=t[e+"Icon"],o=t[e+"Label"],d=t.isDisabled?" disabled":"",l="button";switch(e){case"remove":if(!t.showRemove)return"";break;case"cancel":if(!t.showCancel)return"";a+=" kv-hidden";break;case"pause":if(!t.showPause)return"";a+=" kv-hidden";break;case"upload":if(!t.showUpload)return"";t.isAjaxUpload&&!t.isDisabled?i=t._getLayoutTemplate("btnLink").replace("{href}",t.uploadUrl):l="submit";break;case"browse":if(!t.showBrowse)return"";i=t._getLayoutTemplate("btnBrowse");break;default:return""}return a+=e==="browse"?" btn-file":" fileinput-"+e+" fileinput-"+e+"-button",s.isEmpty(o)||(o=' <span class="'+t.buttonLabelClass+'">'+o+"</span>"),i.setTokens({type:l,css:a,title:r,status:d,icon:n,label:o})},_renderThumbProgress:function(){return'<div class="file-thumb-progress kv-hidden">'+this.progressInfoTemplate.setTokens({percent:101,status:this.msgUploadBegin,stats:""})+"</div>"},_renderFileFooter:function(e,t,i,a,r){var n=this,h=n.fileActionSettings,o=h.showRemove,d=h.showDrag,l=h.showUpload,c=h.showZoom,u=n._getLayoutTemplate("footer"),m=n._getLayoutTemplate("indicator"),g=r?h.indicatorError:h.indicatorNew,h=r?h.indicatorErrorTitle:h.indicatorNewTitle,h=m.setTokens({indicator:g,indicatorTitle:h}),h={type:e,caption:t,size:i=n._getSize(i),width:a,progress:"",indicator:h};return n.isAjaxUpload?(h.progress=n._renderThumbProgress(),h.actions=n._renderFileActions(h,l,!1,o,c,d,!1,!1,!1)):h.actions=n._renderFileActions(h,!1,!1,!1,c,d,!1,!1,!1),h=u.setTokens(h),h=s.replaceTags(h,n.previewThumbTags)},_renderFileActions:function(y,t,i,a,r,n,E,x,l,c,u,m){var g=this;if(!y.type&&c&&(y.type="image"),g.enableResumableUpload?t=!1:typeof t=="function"&&(t=t(y)),typeof i=="function"&&(i=i(y)),typeof a=="function"&&(a=a(y)),typeof r=="function"&&(r=r(y)),typeof n=="function"&&(n=n(y)),!(t||i||a||r||n))return"";var h=x===!1?"":' data-url="'+x+'"',p="",w="",v=l===!1?"":' data-key="'+l+'"',b="",_="",C="",F=g._getLayoutTemplate("actions"),y=g.fileActionSettings,x=g.otherActionButtons.setTokens({dataKey:v,key:l}),E=E?y.removeClass+" disabled":y.removeClass;return a&&(b=g._getLayoutTemplate("actionDelete").setTokens({removeClass:E,removeIcon:y.removeIcon,removeTitle:y.removeTitle,dataUrl:h,dataKey:v,key:l})),t&&(_=g._getLayoutTemplate("actionUpload").setTokens({uploadClass:y.uploadClass,uploadIcon:y.uploadIcon,uploadTitle:y.uploadTitle})),i&&(C=(C=g._getLayoutTemplate("actionDownload").setTokens({downloadClass:y.downloadClass,downloadIcon:y.downloadIcon,downloadTitle:y.downloadTitle,downloadUrl:u||g.initialPreviewDownloadUrl})).setTokens({filename:m,key:l})),r&&(p=g._getLayoutTemplate("actionZoom").setTokens({zoomClass:y.zoomClass,zoomIcon:y.zoomIcon,zoomTitle:y.zoomTitle})),n&&c&&(c="drag-handle-init "+y.dragClass,w=g._getLayoutTemplate("actionDrag").setTokens({dragClass:c,dragTitle:y.dragTitle,dragIcon:y.dragIcon})),F.setTokens({delete:b,upload:_,download:C,zoom:p,drag:w,other:x})},_browse:function(e){var t=this;e&&e.isDefaultPrevented()||!t._raise("filebrowse")||(t.isError&&!t.isAjaxUpload&&t.clear(),t.focusCaptionOnBrowse&&t.$captionContainer.focus())},_change:function(e){var t=this;if(!t.changeTriggered){var i=t.$element,a=1<arguments.length,r=t.isAjaxUpload,n=a?arguments[1]:i[0].files,o=t.fileManager.count(),d=s.isEmpty(i.attr("multiple")),l=!r&&d?1:t.maxFileCount,c=t.maxTotalFileCount,u=0<c&&l<c,m=d&&0<o,g=function(h,p,w){var v,b=(b=w?t.msgTotalFilesTooMany:t.msgFilesTooMany).replace("{m}",p).replace("{n}",h);t.isError=(v=b,h=p=w=null,b=f.extend(!0,{},t._getOutData(null,{},{},n),{id:p,index:h}),w={id:p,index:h,file:w,files:n},t.isPersistentError=!0,r?t._showFileError(v,b):t._showError(v,w)),t.$captionContainer.removeClass("icon-visible"),t._setCaption("",!0),t.$container.removeClass("file-input-new file-input-ajax-new")};if(t.reader=null,t._resetUpload(),t._hideFileIcon(),t.dropZoneEnabled&&t.$container.find(".file-drop-zone ."+t.dropZoneTitleClass).remove(),r||(n=e.target&&e.target.files===void 0?e.target.value?[{name:e.target.value.replace(/^.+\\/,"")}]:[]:e.target.files||{}),a=n,s.isEmpty(a)||a.length===0)return r||t.clear(),void t._raise("fileselectnone");if(t._resetErrors(),i=a.length,d=r?t.fileManager.count()+i:i,e=t._getFileCount(d,!u&&void 0),0<l&&l<e){if(!t.autoReplace||l<i)return void g(t.autoReplace&&l<i?i:e,l);l<e&&t._resetPreviewThumbs(r)}else{if(u&&(e=t._getFileCount(d,!0),0<c&&c<e)){if(!t.autoReplace||l<i)return void g(t.autoReplace&&c<i?i:e,c,!0);l<e&&t._resetPreviewThumbs(r)}!r||m?(t._resetPreviewThumbs(!1),m&&t.clearFileStack()):!r||o!==0||t.previewCache.count(!0)&&!t.overwriteInitial||t._resetPreviewThumbs(!0)}t.readFiles(a)}},_abort:function(e){var t=this;return t.ajaxAborted&&typeof t.ajaxAborted=="object"&&t.ajaxAborted.message!==void 0?((e=f.extend(!0,{},t._getOutData(null),e)).abortData=t.ajaxAborted.data||{},e.abortMessage=t.ajaxAborted.message,t._setProgress(101,t.$progress,t.msgCancelled),t._showFileError(t.ajaxAborted.message,e,"filecustomerror"),t.cancel(),!0):!!t.ajaxAborted},_resetFileStack:function(){var e=this,t=0;e._getThumbs().each(function(){var i=f(this),a=i.attr("data-fileindex"),r=i.attr("id");a!=="-1"&&a!==-1&&(e._getThumbFile(i)?i.attr({"data-fileindex":"-1"}):(i.attr({"data-fileindex":t}),t++),e._getZoom(r).attr({"data-fileindex":i.attr("data-fileindex")}))})},_isFileSelectionValid:function(e){var t=this;return e=e||0,t.required&&!t.getFilesCount()?(t.$errorContainer.html(""),t._showFileError(t.msgFileRequired),!1):!(0<t.minFileCount&&t._getFileCount(e)<t.minFileCount)||(t._noFilesError({}),!1)},_canPreview:function(h){var u=this;if(!(h&&u.showPreview&&u.$preview&&u.$preview.length))return!1;var t=h.name||"",i=h.type||"",a=(h.size||0)/1e3,r=u._parseFileType(i,t),m=u.allowedPreviewTypes,g=u.allowedPreviewMimeTypes,n=u.allowedPreviewExtensions||[],o=u.disabledPreviewTypes,d=u.disabledPreviewMimeTypes,l=u.disabledPreviewExtensions||[],c=u.maxFilePreviewSize&&parseFloat(u.maxFilePreviewSize)||0,h=new RegExp("\\.("+n.join("|")+")$","i"),u=new RegExp("\\.("+l.join("|")+")$","i"),m=!m||m.indexOf(r)!==-1,g=!g||g.indexOf(i)!==-1,h=!n.length||s.compare(t,h);return!(o&&o.indexOf(r)!==-1||d&&d.indexOf(i)!==-1||l.length&&s.compare(t,u)||c&&!isNaN(c)&&c<a)&&(m||g||h)},addToStack:function(e,t){this.fileManager.add(e,t)},clearFileStack:function(){var e=this;return e.fileManager.clear(),e._initResumableUpload(),e.enableResumableUpload?(e.showPause===null&&(e.showPause=!0),e.showCancel===null&&(e.showCancel=!1)):(e.showPause=!1,e.showCancel===null&&(e.showCancel=!0)),e.$element},getFileStack:function(){return this.fileManager.stack},getFileList:function(){return this.fileManager.list()},getFilesSize:function(){return this.fileManager.getTotalSize()},getFilesCount:function(e){var t=this,i=t.isAjaxUpload?t.fileManager.count():t._inputFileCount();return e&&(i+=t.previewCache.count(!0)),t._getFileCount(i)},readFiles:function(e){this.reader=new FileReader;function t(v,b,_,C,x){var y=f.extend(!0,{},a._getOutData(null,{},{},e),{id:_,index:C,fileId:x}),x={id:_,index:C,fileId:x,file:b,files:e};a._previewDefault(b,!0),_=a._getFrame(_,!0),a.isAjaxUpload?setTimeout(function(){i(C+1)},a.processDelay):(a.unlock(),u=0),a.removeFromPreviewOnError&&_.length?_.remove():(a._initFileActions(),_.find(".kv-file-upload").remove()),a.isPersistentError=!0,a.isError=a.isAjaxUpload?a._showFileError(v,y):a._showError(v,x),a._updateFileDetails(u)}var i,a=this,r=a.reader,n=a.$previewContainer,o=a.$previewStatus,d=a.msgLoading,l=a.msgProgress,c=a.previewInitId,u=e.length,m=a.fileTypeSettings,g=a.allowedFileTypes,h=g?g.length:0,p=a.allowedFileExtensions,w=s.isEmpty(p)?"":p.join(", ");a.fileManager.clearImages(),f.each(e,function(v,b){var _=a.fileTypeSettings.image;_&&_(b.type)&&a.fileManager.totalImages++}),(i=function(v){var b=a.$errorContainer,_=a.fileManager;if(u<=v)return a.unlock(),a.duplicateErrors.length&&(H="<li>"+a.duplicateErrors.join("</li><li>")+"</li>",b.find("ul").length===0?s.setHtml(b,a.errorCloseButton+"<ul>"+H+"</ul>"):b.find("ul").append(H),b.fadeIn(a.fadeDelay),a._handler(b.find(".kv-error-close"),"click",function(){b.fadeOut(a.fadeDelay)}),a.duplicateErrors=[]),a.isAjaxUpload?(a._raise("filebatchselected",[_.stack]),_.count()!==0||a.isError||a.reset()):a._raise("filebatchselected",[e]),n.removeClass("file-thumb-loading"),void o.html("");a.lock(!0);function C(){var D=l.setTokens({index:v+1,files:u,percent:50,name:S});setTimeout(function(){o.html(D),a._updateFileDetails(u),i(v+1)},a.processDelay),a._raise("fileloaded",[T,j,M,v,r])&&a.isAjaxUpload&&_.add(T)}var F,y,x,E,P,k,I,T=e[v],M=a._getFileId(T),j=c+"-"+M,B=m.image,S=a._getFileName(T,""),z=(T&&T.size||0)/1e3,U="",N=s.createObjectURL(T),Z=0,J="",W=!1,Q=0;if(T){if(E=_.getId(T),0<h)for(y=0;y<h;y++)x=g[y],x=a.msgFileTypes[x]||x,J+=y===0?x:", "+x;if(S!==!1){if(S.length===0)return A=a.msgInvalidFileName.replace("{name}",s.htmlEncode(s.getFileName(T),"[unknown]")),void t(A,T,j,v,E);if(s.isEmpty(p)||(U=new RegExp("\\.("+p.join("|")+")$","i")),F=z.toFixed(2),a.isAjaxUpload&&_.exists(E)||a._getFrame(j,!0).length){var H={id:j,index:v,fileId:E,file:T,files:e},A=a.msgDuplicateFile.setTokens({name:S,size:F});return a.isAjaxUpload?(a.duplicateErrors.push(A),a.isDuplicateError=!0,a._raise("fileduplicateerror",[T,E,S,F,j,v]),i(v+1)):(a._showError(A,H),a.unlock(),u=0,a._clearFileInput(),a.reset()),void a._updateFileDetails(u)}if(0<a.maxFileSize&&z>a.maxFileSize)return A=a.msgSizeTooLarge.setTokens({name:S,size:F,maxSize:a.maxFileSize}),void t(A,T,j,v,E);if(a.minFileSize!==null&&z<=s.getNum(a.minFileSize))return A=a.msgSizeTooSmall.setTokens({name:S,size:F,minSize:a.minFileSize}),void t(A,T,j,v,E);if(!s.isEmpty(g)&&s.isArray(g)){for(y=0;y<g.length;y+=1)k=g[y],Z+=(k=m[k])&&typeof k=="function"&&k(T.type,s.getFileName(T))?1:0;if(Z===0)return A=a.msgInvalidFileType.setTokens({name:S,types:J}),void t(A,T,j,v,E)}return Z!==0||s.isEmpty(p)||!s.isArray(p)||s.isEmpty(U)||(U=s.compare(S,U),(Z+=s.isEmpty(U)?0:U.length)!==0)?a._canPreview(T)?(I=B(T.type,S),o.html(d.replace("{index}",v+1).replace("{files}",u)),n.addClass("file-thumb-loading"),r.onerror=function(D){a._errorHandler(D,S)},r.onload=function(D){var q,V,X,K,R,G,L=[],Y={name:S,type:T.type};if(f.each(m,function($,ee){$!=="object"&&$!=="other"&&typeof ee=="function"&&ee(T.type,S)&&Q++}),Q===0){for(V=new Uint8Array(D.target.result),y=0;y<V.length;y++)X=V[y].toString(16),L.push(X);if(q=L.join("").toLowerCase().substring(0,8),R=s.getMimeType(q,"",""),s.isEmpty(R)&&(K=s.arrayBuffer2String(r.result),R=s.isSvg(K)?"image/svg+xml":s.getMimeType(q,K,T.type)),Y={name:S,type:R},I=B(R,""))return(G=new FileReader).onerror=function($){a._errorHandler($,S)},G.onload=function($){if(a.isAjaxUpload&&!a._raise("filebeforeload",[T,v,r]))return W=!0,a._resetCaption(),r.abort(),o.html(""),n.removeClass("file-thumb-loading"),void a.enable();a._previewFile(v,T,$,N,Y),a._initFileActions(),C()},void G.readAsDataURL(T)}if(a.isAjaxUpload&&!a._raise("filebeforeload",[T,v,r]))return W=!0,a._resetCaption(),r.abort(),o.html(""),n.removeClass("file-thumb-loading"),void a.enable();a._previewFile(v,T,D,N,Y),a._initFileActions(),C()},r.onprogress=function(D){D.lengthComputable&&(D=D.loaded/D.total*100,D=Math.ceil(D),A=l.setTokens({index:v+1,files:u,percent:D,name:S}),setTimeout(function(){W||o.html(A)},a.processDelay))},void(I?r.readAsDataURL(T):r.readAsArrayBuffer(T))):(P=a.isAjaxUpload&&a._raise("filebeforeload",[T,v,r]),a.isAjaxUpload&&P&&_.add(T),a.showPreview&&P&&(n.addClass("file-thumb-loading"),a._previewDefault(T),a._initFileActions()),void setTimeout(function(){P&&a._updateFileDetails(u),i(v+1),a._raise("fileloaded",[T,j,M,v])},10)):(A=a.msgInvalidFileExtension.setTokens({name:S,extensions:w}),void t(A,T,j,v,E))}i(v+1)}})(0),a._updateFileDetails(u,!0)},lock:function(e){var t=this,i=t.$container;return t._resetErrors(),t.disable(),!e&&t.showCancel&&i.find(".fileinput-cancel").show(),!e&&t.showPause&&i.find(".fileinput-pause").show(),t._raise("filelock",[t.fileManager.stack,t._getExtraData()]),t.$element},unlock:function(e){var t=this,i=t.$container;return e===void 0&&(e=!0),t.enable(),i.removeClass("is-locked"),t.showCancel&&i.find(".fileinput-cancel").hide(),t.showPause&&i.find(".fileinput-pause").hide(),e&&t._resetFileStack(),t._raise("fileunlock",[t.fileManager.stack,t._getExtraData()]),t.$element},resume:function(){var e=this,t=e.fileManager,i=!1,a=e.resumableManager;return t.bpsLog=[],t.bps=0,e.enableResumableUpload&&(e.paused?e._toggleResumableProgress(e.progressPauseTemplate,e.msgUploadResume):i=!0,e.paused=!1,i&&e._toggleResumableProgress(e.progressInfoTemplate,e.msgUploadBegin),setTimeout(function(){a.upload()},e.processDelay)),e.$element},pause:function(){var e,t=this,i=t.resumableManager,a=t.ajaxRequests,r=a.length,n=i.getProgress(),o=t.fileActionSettings,d=t.taskManager.getPool(i.id);if(!t.enableResumableUpload)return t.$element;if(d&&d.cancel(),t._raise("fileuploadpaused",[t.fileManager,i]),0<r)for(e=0;e<r;e+=1)t.paused=!0,a[e].abort();return t.showPreview&&t._getThumbs().each(function(){var l=f(this),c=t._getLayoutTemplate("stats"),u=l.find(".file-upload-indicator");l.removeClass("file-uploading"),u.attr("title")===o.indicatorLoadingTitle&&(t._setThumbStatus(l,"Paused"),c=c.setTokens({pendingTime:t.msgPaused,uploadSpeed:""}),t.paused=!0,t._setProgress(n,l.find(".file-thumb-progress"),n+"%",c)),t._getThumbFile(l)||l.find(".kv-file-remove").removeClass("disabled").removeAttr("disabled")}),t._setProgress(101,t.$progress,t.msgPaused),t.$element},cancel:function(){var e,t=this,i=t.ajaxRequests,a=t.resumableManager,r=t.taskManager,r=a?r.getPool(a.id):void 0,n=i.length;if(t.enableResumableUpload&&r?(r.cancel().done(function(){t._setProgressCancelled()}),a.reset(),t._raise("fileuploadcancelled",[t.fileManager,a])):t._raise("fileuploadcancelled",[t.fileManager]),t._initAjax(),0<n)for(e=0;e<n;e+=1)t.cancelling=!0,i[e].abort();return t._getThumbs().each(function(){var o=f(this),d=o.find(".file-thumb-progress");o.removeClass("file-uploading"),t._setProgress(0,d),d.hide(),t._getThumbFile(o)||(o.find(".kv-file-upload").removeClass("disabled").removeAttr("disabled"),o.find(".kv-file-remove").removeClass("disabled").removeAttr("disabled")),t.unlock()}),setTimeout(function(){t._setProgressCancelled()},t.processDelay),t.$element},clear:function(){var e,t=this;if(t._raise("fileclear"))return t.$btnUpload.removeAttr("disabled"),t._getThumbs().find("video,audio,img").each(function(){s.cleanMemory(f(this))}),t._clearFileInput(),t._resetUpload(),t.clearFileStack(),t.isDuplicateError=!1,t.isPersistentError=!1,t._resetErrors(!0),t._hasInitialPreview()?(t._showFileIcon(),t._resetPreview(),t._initPreviewActions(),t.$container.removeClass("file-input-new")):(t._getThumbs().each(function(){t._clearObjects(f(this))}),t.isAjaxUpload&&(t.previewCache.data={}),t.$preview.html(""),e=!t.overwriteInitial&&0<t.initialCaption.length?t.initialCaption:"",t.$caption.attr("title","").val(e),s.addCss(t.$container,"file-input-new"),t._validateDefaultPreview()),t.$container.find(s.FRAMES).length===0&&(t._initCaption()||t.$captionContainer.removeClass("icon-visible")),t._hideFileIcon(),t.focusCaptionOnClear&&t.$captionContainer.focus(),t._setFileDropZoneTitle(),t._raise("filecleared"),t.$element},reset:function(){var e=this;if(e._raise("filereset"))return e.lastProgress=0,e._resetPreview(),e.$container.find(".fileinput-filename").text(""),s.addCss(e.$container,"file-input-new"),e.getFrames().length&&e.$container.removeClass("file-input-new"),e.clearFileStack(),e._setFileDropZoneTitle(),e.$element},disable:function(){var e=this,t=e.$container;return e.isDisabled=!0,e._raise("filedisabled"),e.$element.attr("disabled","disabled"),t.addClass("is-locked"),s.addCss(t.find(".btn-file"),"disabled"),t.find(".kv-fileinput-caption").addClass("file-caption-disabled"),t.find(".fileinput-remove, .fileinput-upload, .file-preview-frame button").attr("disabled",!0),e._initDragDrop(),e.$element},enable:function(){var e=this,t=e.$container;return e.isDisabled=!1,e._raise("fileenabled"),e.$element.removeAttr("disabled"),t.removeClass("is-locked"),t.find(".kv-fileinput-caption").removeClass("file-caption-disabled"),t.find(".fileinput-remove, .fileinput-upload, .file-preview-frame button").removeAttr("disabled"),t.find(".btn-file").removeClass("disabled"),e._initDragDrop(),e.$element},upload:function(){var e,t=this,i=t.fileManager,a=i.count(),r=!f.isEmptyObject(t._getExtraData());if(i.bpsLog=[],i.bps=0,t.isAjaxUpload&&!t.isDisabled&&t._isFileSelectionValid(a)){if(t.lastProgress=0,t._resetUpload(),a!==0||r)return t.cancelling=!1,t._showProgress(),t.lock(),a===0&&r?(t._setProgress(2),void t._uploadExtraOnly()):t.enableResumableUpload?t.resume():((t.uploadAsync||t.enableResumableUpload)&&(r=t._getOutData(null),t._raise("filebatchpreupload",[r]),t.fileBatchCompleted=!1,t.uploadCache=[],f.each(t.getFileStack(),function(n){n=t._getThumbId(n),t.uploadCache.push({id:n,content:null,config:null,tags:null,append:!0})}),t.$preview.find(".file-preview-initial").removeClass(s.SORT_CSS),t._initSortable()),t._setProgress(2),t.hasInitData=!1,t.uploadAsync?(e=0,void f.each(t.getFileStack(),function(n){t._uploadSingle(e,n,!0),e++})):(t._uploadBatch(),t.$element));t._showFileError(t.msgUploadEmpty)}},destroy:function(){var e=this,t=e.$form,i=e.$container,a=e.$element,r=e.namespace;return f(document).off(r),f(window).off(r),t&&t.length&&t.off(r),e.isAjaxUpload&&e._clearFileInput(),e._cleanup(),e._initPreviewCache(),a.insertBefore(i).off(r).removeData(),i.off().remove(),a},refresh:function(e){var t=this,i=t.$element;return e=typeof e!="object"||s.isEmpty(e)?t.options:f.extend(!0,{},t.options,e),t._init(e,!0),t._listen(),i},zoom:function(e){e=this._getFrame(e),this._showModal(e)},getExif:function(e){return e=this._getFrame(e),e&&e.data("exif")||null},getFrames:function(e){return e=e||"",e=this.$preview.find(s.FRAMES+e),this.reversePreviewOrder&&(e=f(e.get().reverse())),e},getPreview:function(){return{content:this.initialPreview,config:this.initialPreviewConfig,tags:this.initialPreviewThumbTags}}},f.fn.fileinput=function(e){if(s.hasFileAPISupport()||s.isIE(9)){var t=Array.apply(null,arguments),i=[];switch(t.shift(),this.each(function(){var a=f(this),r=a.data("fileinput"),n=typeof e=="object"&&e,o=n.theme||a.data("theme"),d={},l={},c=n.language||a.data("language")||f.fn.fileinput.defaults.language||"en";r||(o&&(l=f.fn.fileinputThemes[o]||{}),c==="en"||s.isEmpty(f.fn.fileinputLocales[c])||(d=f.fn.fileinputLocales[c]||{}),n=f.extend(!0,{},f.fn.fileinput.defaults,l,f.fn.fileinputLocales.en,d,n,a.data()),r=new O(this,n),a.data("fileinput",r)),typeof e=="string"&&i.push(r[e].apply(r,t))}),i.length){case 0:return this;case 1:return i[0];default:return i}}},f.fn.fileinput.defaults={language:"en",showCaption:!0,showBrowse:!0,showPreview:!0,showRemove:!0,showUpload:!0,showUploadStats:!0,showCancel:null,showPause:null,showClose:!0,showUploadedThumbs:!0,showConsoleLogs:!1,browseOnZoneClick:!1,autoReplace:!1,autoOrientImage:function(){var e=window.navigator.userAgent,t=!!e.match(/WebKit/i);return!(e.match(/iP(od|ad|hone)/i)&&t&&!e.match(/CriOS/i))},autoOrientImageInitial:!0,required:!1,rtl:!1,hideThumbnailContent:!1,encodeUrl:!0,focusCaptionOnBrowse:!0,focusCaptionOnClear:!0,generateFileId:null,previewClass:"",captionClass:"",frameClass:"krajee-default",mainClass:"file-caption-main",mainTemplate:null,fileSizeGetter:null,initialCaption:"",initialPreview:[],initialPreviewDelimiter:"*$$*",initialPreviewAsData:!1,initialPreviewFileType:"image",initialPreviewConfig:[],initialPreviewThumbTags:[],previewThumbTags:{},initialPreviewShowDelete:!0,initialPreviewDownloadUrl:"",removeFromPreviewOnError:!1,deleteUrl:"",deleteExtraData:{},overwriteInitial:!0,sanitizeZoomCache:function(e){return e=s.createElement(e),e.find("input,textarea,select,datalist,form,.file-thumbnail-footer").remove(),e.html()},previewZoomButtonIcons:{prev:'<i class="glyphicon glyphicon-triangle-left"></i>',next:'<i class="glyphicon glyphicon-triangle-right"></i>',toggleheader:'<i class="glyphicon glyphicon-resize-vertical"></i>',fullscreen:'<i class="glyphicon glyphicon-fullscreen"></i>',borderless:'<i class="glyphicon glyphicon-resize-full"></i>',close:'<i class="glyphicon glyphicon-remove"></i>'},previewZoomButtonClasses:{prev:"btn btn-navigate",next:"btn btn-navigate",toggleheader:"btn btn-sm btn-kv btn-default btn-outline-secondary",fullscreen:"btn btn-sm btn-kv btn-default btn-outline-secondary",borderless:"btn btn-sm btn-kv btn-default btn-outline-secondary",close:"btn btn-sm btn-kv btn-default btn-outline-secondary"},previewTemplates:{},previewContentTemplates:{},preferIconicPreview:!1,preferIconicZoomPreview:!1,allowedFileTypes:null,allowedFileExtensions:null,allowedPreviewTypes:void 0,allowedPreviewMimeTypes:null,allowedPreviewExtensions:null,disabledPreviewTypes:void 0,disabledPreviewExtensions:["msi","exe","com","zip","rar","app","vb","scr"],disabledPreviewMimeTypes:null,defaultPreviewContent:null,customLayoutTags:{},customPreviewTags:{},previewFileIcon:'<i class="glyphicon glyphicon-file"></i>',previewFileIconClass:"file-other-icon",previewFileIconSettings:{},previewFileExtSettings:{},buttonLabelClass:"hidden-xs",browseIcon:'<i class="glyphicon glyphicon-folder-open"></i>&nbsp;',browseClass:"btn btn-primary",removeIcon:'<i class="glyphicon glyphicon-trash"></i>',removeClass:"btn btn-default btn-secondary",cancelIcon:'<i class="glyphicon glyphicon-ban-circle"></i>',cancelClass:"btn btn-default btn-secondary",pauseIcon:'<i class="glyphicon glyphicon-pause"></i>',pauseClass:"btn btn-default btn-secondary",uploadIcon:'<i class="glyphicon glyphicon-upload"></i>',uploadClass:"btn btn-default btn-secondary",uploadUrl:null,uploadUrlThumb:null,uploadAsync:!0,uploadParamNames:{chunkCount:"chunkCount",chunkIndex:"chunkIndex",chunkSize:"chunkSize",chunkSizeStart:"chunkSizeStart",chunksUploaded:"chunksUploaded",fileBlob:"fileBlob",fileId:"fileId",fileName:"fileName",fileRelativePath:"fileRelativePath",fileSize:"fileSize",retryCount:"retryCount"},maxAjaxThreads:5,fadeDelay:800,processDelay:100,bitrateUpdateDelay:500,queueDelay:10,progressDelay:0,enableResumableUpload:!1,resumableUploadOptions:{fallback:null,testUrl:null,chunkSize:2048,maxThreads:4,maxRetries:3,showErrorLog:!0,retainErrorHistory:!0,skipErrorsAndProceed:!1},uploadExtraData:{},zoomModalHeight:480,minImageWidth:null,minImageHeight:null,maxImageWidth:null,maxImageHeight:null,resizeImage:!1,resizePreference:"width",resizeQuality:.92,resizeDefaultImageType:"image/jpeg",resizeIfSizeMoreThan:0,minFileSize:-1,maxFileSize:0,maxFilePreviewSize:25600,minFileCount:0,maxFileCount:0,maxTotalFileCount:0,validateInitialCount:!1,msgValidationErrorClass:"text-danger",msgValidationErrorIcon:'<i class="glyphicon glyphicon-exclamation-sign"></i> ',msgErrorClass:"file-error-message",progressThumbClass:"progress-bar progress-bar-striped active progress-bar-animated",progressClass:"progress-bar bg-success progress-bar-success progress-bar-striped active progress-bar-animated",progressInfoClass:"progress-bar bg-info progress-bar-info progress-bar-striped active progress-bar-animated",progressCompleteClass:"progress-bar bg-success progress-bar-success",progressPauseClass:"progress-bar bg-primary progress-bar-primary progress-bar-striped active progress-bar-animated",progressErrorClass:"progress-bar bg-danger progress-bar-danger",progressUploadThreshold:99,previewFileType:"image",elCaptionContainer:null,elCaptionText:null,elPreviewContainer:null,elPreviewImage:null,elPreviewStatus:null,elErrorContainer:null,errorCloseButton:s.closeButton("kv-error-close"),slugCallback:null,dropZoneEnabled:!0,dropZoneTitleClass:"file-drop-zone-title",fileActionSettings:{},otherActionButtons:"",textEncoding:"UTF-8",preProcessUpload:null,ajaxSettings:{},ajaxDeleteSettings:{},showAjaxErrorDetails:!0,mergeAjaxCallbacks:!1,mergeAjaxDeleteCallbacks:!1,retryErrorUploads:!0,reversePreviewOrder:!1,usePdfRenderer:function(){var e=!!window.MSInputMethodContext&&!!document.documentMode;return!!navigator.userAgent.match(/(iPod|iPhone|iPad|Android)/i)||e},pdfRendererUrl:"",pdfRendererTemplate:'<iframe class="kv-preview-data file-preview-pdf" src="{renderer}?file={data}" {style}></iframe>'},f.fn.fileinputLocales.en={fileSingle:"file",filePlural:"files",browseLabel:"Browse &hellip;",removeLabel:"Remove",removeTitle:"Clear all unprocessed files",cancelLabel:"Cancel",cancelTitle:"Abort ongoing upload",pauseLabel:"Pause",pauseTitle:"Pause ongoing upload",uploadLabel:"Upload",uploadTitle:"Upload selected files",msgNo:"No",msgNoFilesSelected:"No files selected",msgCancelled:"Cancelled",msgPaused:"Paused",msgPlaceholder:"Select {files} ...",msgZoomModalHeading:"Detailed Preview",msgFileRequired:"You must select a file to upload.",msgSizeTooSmall:'File "{name}" (<b>{size} KB</b>) is too small and must be larger than <b>{minSize} KB</b>.',msgSizeTooLarge:'File "{name}" (<b>{size} KB</b>) exceeds maximum allowed upload size of <b>{maxSize} KB</b>.',msgFilesTooLess:"You must select at least <b>{n}</b> {files} to upload.",msgFilesTooMany:"Number of files selected for upload <b>({n})</b> exceeds maximum allowed limit of <b>{m}</b>.",msgTotalFilesTooMany:"You can upload a maximum of <b>{m}</b> files (<b>{n}</b> files detected).",msgFileNotFound:'File "{name}" not found!',msgFileSecured:'Security restrictions prevent reading the file "{name}".',msgFileNotReadable:'File "{name}" is not readable.',msgFilePreviewAborted:'File preview aborted for "{name}".',msgFilePreviewError:'An error occurred while reading the file "{name}".',msgInvalidFileName:'Invalid or unsupported characters in file name "{name}".',msgInvalidFileType:'Invalid type for file "{name}". Only "{types}" files are supported.',msgInvalidFileExtension:'Invalid extension for file "{name}". Only "{extensions}" files are supported.',msgFileTypes:{image:"image",html:"HTML",text:"text",video:"video",audio:"audio",flash:"flash",pdf:"PDF",object:"object"},msgUploadAborted:"The file upload was aborted",msgUploadThreshold:"Processing &hellip;",msgUploadBegin:"Initializing &hellip;",msgUploadEnd:"Done",msgUploadResume:"Resuming upload &hellip;",msgUploadEmpty:"No valid data available for upload.",msgUploadError:"Upload Error",msgDeleteError:"Delete Error",msgProgressError:"Error",msgValidationError:"Validation Error",msgLoading:"Loading file {index} of {files} &hellip;",msgProgress:"Loading file {index} of {files} - {name} - {percent}% completed.",msgSelected:"{n} {files} selected",msgFoldersNotAllowed:"Drag & drop files only! {n} folder(s) dropped were skipped.",msgImageWidthSmall:'Width of image file "{name}" must be at least {size} px.',msgImageHeightSmall:'Height of image file "{name}" must be at least {size} px.',msgImageWidthLarge:'Width of image file "{name}" cannot exceed {size} px.',msgImageHeightLarge:'Height of image file "{name}" cannot exceed {size} px.',msgImageResizeError:"Could not get the image dimensions to resize.",msgImageResizeException:"Error while resizing the image.<pre>{errors}</pre>",msgAjaxError:"Something went wrong with the {operation} operation. Please try again later!",msgAjaxProgressError:"{operation} failed",msgDuplicateFile:'File "{name}" of same size "{size} KB" has already been selected earlier. Skipping duplicate selection.',msgResumableUploadRetriesExceeded:"Upload aborted beyond <b>{max}</b> retries for file <b>{file}</b>! Error Details: <pre>{error}</pre>",msgPendingTime:"{time} remaining",msgCalculatingTime:"calculating time remaining",ajaxOperations:{deleteThumb:"file delete",uploadThumb:"file upload",uploadBatch:"batch file upload",uploadExtra:"form data upload"},dropZoneTitle:"Drag & drop files here &hellip;",dropZoneClickTitle:"<br>(or click to select {files})",previewZoomButtonTitles:{prev:"View previous file",next:"View next file",toggleheader:"Toggle header",fullscreen:"Toggle full screen",borderless:"Toggle borderless mode",close:"Close detailed preview"}},f.fn.fileinput.Constructor=O,f(document).ready(function(){var e=f("input.file[type=file]");e.length&&e.fileinput()})});
