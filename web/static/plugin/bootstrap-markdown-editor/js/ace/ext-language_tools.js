define("ace/snippets",["require","exports","module","ace/lib/dom","ace/lib/oop","ace/lib/event_emitter","ace/lib/lang","ace/range","ace/range_list","ace/keyboard/hash_handler","ace/tokenizer","ace/clipboard","ace/editor"],function(m,R,V){"use strict";function T(e){var i=new Date().toLocaleString("en-us",e);return i.length==1?"0"+i:i}var C=m("./lib/dom"),$=m("./lib/oop"),b=m("./lib/event_emitter").EventEmitter,f=m("./lib/lang"),g=m("./range").Range,S=m("./range_list").RangeList,L=m("./keyboard/hash_handler").HashHandler,_=m("./tokenizer").Tokenizer,A=m("./clipboard"),P={CURRENT_WORD:function(e){return e.session.getTextRange(e.session.getWordRange())},SELECTION:function(e,i,t){var n=e.session.getTextRange();return t?n.replace(/\n\r?([ \t]*\S)/g,`
`+t+"$1"):n},CURRENT_LINE:function(e){return e.session.getLine(e.getCursorPosition().row)},PREV_LINE:function(e){return e.session.getLine(e.getCursorPosition().row-1)},LINE_INDEX:function(e){return e.getCursorPosition().row},LINE_NUMBER:function(e){return e.getCursorPosition().row+1},SOFT_TABS:function(e){return e.session.getUseSoftTabs()?"YES":"NO"},TAB_SIZE:function(e){return e.session.getTabSize()},CLIPBOARD:function(e){return A.getText&&A.getText()},FILENAME:function(e){return/[^/\\]*$/.exec(this.FILEPATH(e))[0]},FILENAME_BASE:function(e){return/[^/\\]*$/.exec(this.FILEPATH(e))[0].replace(/\.[^.]*$/,"")},DIRECTORY:function(e){return this.FILEPATH(e).replace(/[^/\\]*$/,"")},FILEPATH:function(e){return"/not implemented.txt"},WORKSPACE_NAME:function(){return"Unknown"},FULLNAME:function(){return"Unknown"},BLOCK_COMMENT_START:function(e){var i=e.session.$mode||{};return i.blockComment&&i.blockComment.start||""},BLOCK_COMMENT_END:function(e){var i=e.session.$mode||{};return i.blockComment&&i.blockComment.end||""},LINE_COMMENT:function(e){var i=e.session.$mode||{};return i.lineCommentStart||""},CURRENT_YEAR:T.bind(null,{year:"numeric"}),CURRENT_YEAR_SHORT:T.bind(null,{year:"2-digit"}),CURRENT_MONTH:T.bind(null,{month:"numeric"}),CURRENT_MONTH_NAME:T.bind(null,{month:"long"}),CURRENT_MONTH_NAME_SHORT:T.bind(null,{month:"short"}),CURRENT_DATE:T.bind(null,{day:"2-digit"}),CURRENT_DAY_NAME:T.bind(null,{weekday:"long"}),CURRENT_DAY_NAME_SHORT:T.bind(null,{weekday:"short"}),CURRENT_HOUR:T.bind(null,{hour:"2-digit",hour12:!1}),CURRENT_MINUTE:T.bind(null,{minute:"2-digit"}),CURRENT_SECOND:T.bind(null,{second:"2-digit"})};P.SELECTED_TEXT=P.SELECTION;var N=function(){function e(){this.snippetMap={},this.snippetNameMap={},this.variables=P}return e.prototype.getTokenizer=function(){return e.$tokenizer||this.createTokenizer()},e.prototype.createTokenizer=function(){function i(o){return o=o.substr(1),/^\d+$/.test(o)?[{tabstopId:parseInt(o,10)}]:[{text:o}]}function t(o){return"(?:[^\\\\"+o+"]|\\\\.)"}var n={regex:"/("+t("/")+"+)/",onMatch:function(o,c,l){var p=l[0];return p.fmtString=!0,p.guard=o.slice(1,-1),p.flag="",""},next:"formatString"};return e.$tokenizer=new _({start:[{regex:/\\./,onMatch:function(o,c,l){var p=o[1];return(p=="}"&&l.length||"`$\\".indexOf(p)!=-1)&&(o=p),[o]}},{regex:/}/,onMatch:function(o,c,l){return[l.length?l.shift():o]}},{regex:/\$(?:\d+|\w+)/,onMatch:i},{regex:/\$\{[\dA-Z_a-z]+/,onMatch:function(o,c,l){var p=i(o.substr(1));return l.unshift(p[0]),p},next:"snippetVar"},{regex:/\n/,token:"newline",merge:!1}],snippetVar:[{regex:"\\|"+t("\\|")+"*\\|",onMatch:function(o,c,l){var p=o.slice(1,-1).replace(/\\[,|\\]|,/g,function(s){return s.length==2?s[1]:"\0"}).split("\0").map(function(s){return{value:s}});return l[0].choices=p,[p[0]]},next:"start"},n,{regex:"([^:}\\\\]|\\\\.)*:?",token:"",next:"start"}],formatString:[{regex:/:/,onMatch:function(o,c,l){return l.length&&l[0].expectElse?(l[0].expectElse=!1,l[0].ifEnd={elseEnd:l[0]},[l[0].ifEnd]):":"}},{regex:/\\./,onMatch:function(o,c,l){var p=o[1];return p=="}"&&l.length||"`$\\".indexOf(p)!=-1?o=p:p=="n"?o=`
`:p=="t"?o="   ":"ulULE".indexOf(p)!=-1&&(o={changeCase:p,local:p>"a"}),[o]}},{regex:"/\\w*}",onMatch:function(o,c,l){var p=l.shift();return p&&(p.flag=o.slice(1,-1)),this.next=p&&p.tabstopId?"start":"",[p||o]},next:"start"},{regex:/\$(?:\d+|\w+)/,onMatch:function(o,c,l){return[{text:o.slice(1)}]}},{regex:/\${\w+/,onMatch:function(o,c,l){var p={text:o.slice(2)};return l.unshift(p),[p]},next:"formatStringVar"},{regex:/\n/,token:"newline",merge:!1},{regex:/}/,onMatch:function(o,c,l){var p=l.shift();return this.next=p&&p.tabstopId?"start":"",[p||o]},next:"start"}],formatStringVar:[{regex:/:\/\w+}/,onMatch:function(o,c,l){var p=l[0];return p.formatFunction=o.slice(2,-1),[l.shift()]},next:"formatString"},n,{regex:/:[\?\-+]?/,onMatch:function(o,c,l){o[1]=="+"&&(l[0].ifEnd=l[0]),o[1]=="?"&&(l[0].expectElse=!0)},next:"formatString"},{regex:"([^:}\\\\]|\\\\.)*:?",token:"",next:"formatString"}]}),e.$tokenizer},e.prototype.tokenizeTmSnippet=function(i,t){return this.getTokenizer().getLineTokens(i,t).tokens.map(function(n){return n.value||n})},e.prototype.getVariableValue=function(i,t,n){if(/^\d+$/.test(t))return(this.variables.__||{})[t]||"";if(/^[A-Z]\d+$/.test(t))return(this.variables[t[0]+"__"]||{})[t.substr(1)]||"";if(t=t.replace(/^TM_/,""),!this.variables.hasOwnProperty(t))return"";var o=this.variables[t];return typeof o=="function"&&(o=this.variables[t](i,t,n)),o??""},e.prototype.tmStrFormat=function(i,t,n){if(!t.fmt)return i;var o=t.flag||"",c=t.guard;c=new RegExp(c,o.replace(/[^gim]/g,""));var l=typeof t.fmt=="string"?this.tokenizeTmSnippet(t.fmt,"formatString"):t.fmt,p=this,s=i.replace(c,function(){var a=p.variables.__;p.variables.__=[].slice.call(arguments);for(var h=p.resolveVariables(l,n),v="E",d=0;d<h.length;d++){var y=h[d];if(typeof y=="object")if(h[d]="",y.changeCase&&y.local){var x=h[d+1];x&&typeof x=="string"&&(y.changeCase=="u"?h[d]=x[0].toUpperCase():h[d]=x[0].toLowerCase(),h[d+1]=x.substr(1))}else y.changeCase&&(v=y.changeCase);else v=="U"?h[d]=y.toUpperCase():v=="L"&&(h[d]=y.toLowerCase())}return p.variables.__=a,h.join("")});return s},e.prototype.tmFormatFunction=function(i,t,n){return t.formatFunction=="upcase"?i.toUpperCase():t.formatFunction=="downcase"?i.toLowerCase():i},e.prototype.resolveVariables=function(i,t){function n(v){var d=i.indexOf(v,p+1);d!=-1&&(p=d)}for(var o=[],c="",l=!0,p=0;p<i.length;p++){var s=i[p];if(typeof s=="string"){o.push(s),s==`
`?(l=!0,c=""):l&&(c=/^\t*/.exec(s)[0],l=/\S/.test(s));continue}if(s){if(l=!1,s.fmtString){var a=i.indexOf(s,p+1);a==-1&&(a=i.length),s.fmt=i.slice(p+1,a),p=a}if(s.text){var h=this.getVariableValue(t,s.text,c)+"";s.fmtString&&(h=this.tmStrFormat(h,s,t)),s.formatFunction&&(h=this.tmFormatFunction(h,s,t)),h&&!s.ifEnd?(o.push(h),n(s)):!h&&s.ifEnd&&n(s.ifEnd)}else s.elseEnd?n(s.elseEnd):(s.tabstopId!=null||s.changeCase!=null)&&o.push(s)}}return o},e.prototype.getDisplayTextForSnippet=function(i,t){var n=D.call(this,i,t);return n.text},e.prototype.insertSnippetForSelection=function(i,t,n){n===void 0&&(n={});var o=D.call(this,i,t,n),c=i.getSelectionRange(),l=i.session.replace(c,o.text),p=new F(i),s=i.inVirtualSelectionMode&&i.selection.index;p.addTabstops(o.tabstops,c.start,l,s)},e.prototype.insertSnippet=function(i,t,n){n===void 0&&(n={});var o=this;if(i.inVirtualSelectionMode)return o.insertSnippetForSelection(i,t,n);i.forEachSelection(function(){o.insertSnippetForSelection(i,t,n)},null,{keepOrder:!0}),i.tabstopManager&&i.tabstopManager.tabNext()},e.prototype.$getScope=function(i){var t=i.session.$mode.$id||"";if(t=t.split("/").pop(),t==="html"||t==="php"){t==="php"&&!i.session.$mode.inlinePhp&&(t="html");var n=i.getCursorPosition(),o=i.session.getState(n.row);typeof o=="object"&&(o=o[0]),o.substring&&(o.substring(0,3)=="js-"?t="javascript":o.substring(0,4)=="css-"?t="css":o.substring(0,4)=="php-"&&(t="php"))}return t},e.prototype.getActiveScopes=function(i){var t=this.$getScope(i),n=[t],o=this.snippetMap;return o[t]&&o[t].includeScopes&&n.push.apply(n,o[t].includeScopes),n.push("_"),n},e.prototype.expandWithTab=function(i,t){var n=this,o=i.forEachSelection(function(){return n.expandSnippetForSelection(i,t)},null,{keepOrder:!0});return o&&i.tabstopManager&&i.tabstopManager.tabNext(),o},e.prototype.expandSnippetForSelection=function(i,t){var n=i.getCursorPosition(),o=i.session.getLine(n.row),c=o.substring(0,n.column),l=o.substr(n.column),p=this.snippetMap,s;return this.getActiveScopes(i).some(function(a){var h=p[a];return h&&(s=this.findMatchingSnippet(h,c,l)),!!s},this),s?(t&&t.dryRun||(i.session.doc.removeInLine(n.row,n.column-s.replaceBefore.length,n.column+s.replaceAfter.length),this.variables.M__=s.matchBefore,this.variables.T__=s.matchAfter,this.insertSnippetForSelection(i,s.content),this.variables.M__=this.variables.T__=null),!0):!1},e.prototype.findMatchingSnippet=function(i,t,n){for(var o=i.length;o--;){var c=i[o];if(!(c.startRe&&!c.startRe.test(t))&&!(c.endRe&&!c.endRe.test(n))&&!(!c.startRe&&!c.endRe))return c.matchBefore=c.startRe?c.startRe.exec(t):[""],c.matchAfter=c.endRe?c.endRe.exec(n):[""],c.replaceBefore=c.triggerRe?c.triggerRe.exec(t)[0]:"",c.replaceAfter=c.endTriggerRe?c.endTriggerRe.exec(n)[0]:"",c}},e.prototype.register=function(i,t){function n(a){return a&&!/^\^?\(.*\)\$?$|^\\b$/.test(a)&&(a="(?:"+a+")"),a||""}function o(a,h,v){return a=n(a),h=n(h),v?(a=h+a,a&&a[a.length-1]!="$"&&(a+="$")):(a+=h,a&&a[0]!="^"&&(a="^"+a)),new RegExp(a)}function c(a){a.scope||(a.scope=t||"_"),t=a.scope,l[t]||(l[t]=[],p[t]={});var h=p[t];if(a.name){var v=h[a.name];v&&s.unregister(v),h[a.name]=a}l[t].push(a),a.prefix&&(a.tabTrigger=a.prefix),!a.content&&a.body&&(a.content=Array.isArray(a.body)?a.body.join(`
`):a.body),a.tabTrigger&&!a.trigger&&(!a.guard&&/^\w/.test(a.tabTrigger)&&(a.guard="\\b"),a.trigger=f.escapeRegExp(a.tabTrigger)),!(!a.trigger&&!a.guard&&!a.endTrigger&&!a.endGuard)&&(a.startRe=o(a.trigger,a.guard,!0),a.triggerRe=new RegExp(a.trigger),a.endRe=o(a.endTrigger,a.endGuard,!0),a.endTriggerRe=new RegExp(a.endTrigger))}var l=this.snippetMap,p=this.snippetNameMap,s=this;i||(i=[]),Array.isArray(i)?i.forEach(c):Object.keys(i).forEach(function(a){c(i[a])}),this._signal("registerSnippets",{scope:t})},e.prototype.unregister=function(i,t){function n(l){var p=c[l.scope||t];if(p&&p[l.name]){delete p[l.name];var s=o[l.scope||t],a=s&&s.indexOf(l);a>=0&&s.splice(a,1)}}var o=this.snippetMap,c=this.snippetNameMap;i.content?n(i):Array.isArray(i)&&i.forEach(n)},e.prototype.parseSnippetFile=function(i){i=i.replace(/\r/g,"");for(var t=[],n={},o=/^#.*|^({[\s\S]*})\s*$|^(\S+) (.*)$|^((?:\n*\t.*)+)/gm,c;c=o.exec(i);){if(c[1])try{n=JSON.parse(c[1]),t.push(n)}catch{}if(c[4])n.content=c[4].replace(/^\t/gm,""),t.push(n),n={};else{var l=c[2],p=c[3];if(l=="regex"){var s=/\/((?:[^\/\\]|\\.)*)|$/g;n.guard=s.exec(p)[1],n.trigger=s.exec(p)[1],n.endTrigger=s.exec(p)[1],n.endGuard=s.exec(p)[1]}else l=="snippet"?(n.tabTrigger=p.match(/^\S*/)[0],n.name||(n.name=p)):l&&(n[l]=p)}}return t},e.prototype.getSnippetByName=function(i,t){var n=this.snippetNameMap,o;return this.getActiveScopes(t).some(function(c){var l=n[c];return l&&(o=l[i]),!!o},this),o},e}();$.implement(N.prototype,b);var D=function(e,i,t){function n(w){for(var I=[],B=0;B<w.length;B++){var M=w[B];if(typeof M=="object"){if(h[M.tabstopId])continue;var j=w.lastIndexOf(M,B-1);M=I[j]||{tabstopId:M.tabstopId}}I[B]=M}return I}t===void 0&&(t={});var o=e.getCursorPosition(),c=e.session.getLine(o.row),l=e.session.getTabString(),p=c.match(/^\s*/)[0];o.column<p.length&&(p=p.slice(0,o.column)),i=i.replace(/\r/g,"");var s=this.tokenizeTmSnippet(i);s=this.resolveVariables(s,e),s=s.map(function(w){return w==`
`&&!t.excludeExtraIndent?w+p:typeof w=="string"?w.replace(/\t/g,l):w});var a=[];s.forEach(function(w,I){if(typeof w=="object"){var B=w.tabstopId,M=a[B];if(M||(M=a[B]=[],M.index=B,M.value="",M.parents={}),M.indexOf(w)===-1){w.choices&&!M.choices&&(M.choices=w.choices),M.push(w);var j=s.indexOf(w,I+1);if(j!==-1){var W=s.slice(I+1,j),G=W.some(function(K){return typeof K=="object"});G&&!M.value?M.value=W:W.length&&(!M.value||typeof M.value!="string")&&(M.value=W.join(""))}}}}),a.forEach(function(w){w.length=0});for(var h={},v=0;v<s.length;v++){var d=s[v];if(typeof d=="object"){var y=d.tabstopId,x=a[y],k=s.indexOf(d,v+1);if(h[y]){h[y]===d&&(delete h[y],Object.keys(h).forEach(function(w){x.parents[w]=!0}));continue}h[y]=d;var H=x.value;typeof H!="string"?H=n(H):d.fmt&&(H=this.tmStrFormat(H,d,e)),s.splice.apply(s,[v+1,Math.max(0,k-v)].concat(H,d)),x.indexOf(d)===-1&&x.push(d)}}var E=0,z=0,U="";return s.forEach(function(w){if(typeof w=="string"){var I=w.split(`
`);I.length>1?(z=I[I.length-1].length,E+=I.length-1):z+=w.length,U+=w}else w&&(w.start?w.end={row:E,column:z}:w.start={row:E,column:z})}),{text:U,tabstops:a,tokens:s}},F=function(){function e(i){if(this.index=0,this.ranges=[],this.tabstops=[],i.tabstopManager)return i.tabstopManager;i.tabstopManager=this,this.$onChange=this.onChange.bind(this),this.$onChangeSelection=f.delayedCall(this.onChangeSelection.bind(this)).schedule,this.$onChangeSession=this.onChangeSession.bind(this),this.$onAfterExec=this.onAfterExec.bind(this),this.attach(i)}return e.prototype.attach=function(i){this.$openTabstops=null,this.selectedTabstop=null,this.editor=i,this.session=i.session,this.editor.on("change",this.$onChange),this.editor.on("changeSelection",this.$onChangeSelection),this.editor.on("changeSession",this.$onChangeSession),this.editor.commands.on("afterExec",this.$onAfterExec),this.editor.keyBinding.addKeyboardHandler(this.keyboardHandler)},e.prototype.detach=function(){this.tabstops.forEach(this.removeTabstopMarkers,this),this.ranges.length=0,this.tabstops.length=0,this.selectedTabstop=null,this.editor.off("change",this.$onChange),this.editor.off("changeSelection",this.$onChangeSelection),this.editor.off("changeSession",this.$onChangeSession),this.editor.commands.off("afterExec",this.$onAfterExec),this.editor.keyBinding.removeKeyboardHandler(this.keyboardHandler),this.editor.tabstopManager=null,this.session=null,this.editor=null},e.prototype.onChange=function(i){for(var t=i.action[0]=="r",n=this.selectedTabstop||{},o=n.parents||{},c=this.tabstops.slice(),l=0;l<c.length;l++){var p=c[l],s=p==n||o[p.index];if(p.rangeList.$bias=s?0:1,i.action=="remove"&&p!==n){var a=p.parents&&p.parents[n.index],h=p.rangeList.pointIndex(i.start,a);h=h<0?-h-1:h+1;var v=p.rangeList.pointIndex(i.end,a);v=v<0?-v-1:v-1;for(var d=p.rangeList.ranges.slice(h,v),y=0;y<d.length;y++)this.removeRange(d[y])}p.rangeList.$onChange(i)}var x=this.session;!this.$inChange&&t&&x.getLength()==1&&!x.getValue()&&this.detach()},e.prototype.updateLinkedFields=function(){var i=this.selectedTabstop;if(!(!i||!i.hasLinkedRanges||!i.firstNonLinked)){this.$inChange=!0;for(var t=this.session,n=t.getTextRange(i.firstNonLinked),o=0;o<i.length;o++){var c=i[o];if(c.linked){var l=c.original,p=R.snippetManager.tmStrFormat(n,l,this.editor);t.replace(c,p)}}this.$inChange=!1}},e.prototype.onAfterExec=function(i){i.command&&!i.command.readOnly&&this.updateLinkedFields()},e.prototype.onChangeSelection=function(){if(this.editor){for(var i=this.editor.selection.lead,t=this.editor.selection.anchor,n=this.editor.selection.isEmpty(),o=0;o<this.ranges.length;o++)if(!this.ranges[o].linked){var c=this.ranges[o].contains(i.row,i.column),l=n||this.ranges[o].contains(t.row,t.column);if(c&&l)return}this.detach()}},e.prototype.onChangeSession=function(){this.detach()},e.prototype.tabNext=function(i){var t=this.tabstops.length,n=this.index+(i||1);n=Math.min(Math.max(n,1),t),n==t&&(n=0),this.selectTabstop(n),this.updateTabstopMarkers(),n===0&&this.detach()},e.prototype.selectTabstop=function(i){this.$openTabstops=null;var t=this.tabstops[this.index];if(t&&this.addTabstopMarkers(t),this.index=i,t=this.tabstops[this.index],!(!t||!t.length)){this.selectedTabstop=t;var n=t.firstNonLinked||t;if(t.choices&&(n.cursor=n.start),this.editor.inVirtualSelectionMode)this.editor.selection.fromOrientedRange(n);else{var o=this.editor.multiSelect;o.toSingleRange(n);for(var c=0;c<t.length;c++)t.hasLinkedRanges&&t[c].linked||o.addRange(t[c].clone(),!0)}this.editor.keyBinding.addKeyboardHandler(this.keyboardHandler),this.selectedTabstop&&this.selectedTabstop.choices&&this.editor.execCommand("startAutocomplete",{matches:this.selectedTabstop.choices})}},e.prototype.addTabstops=function(i,t,n){var o=this.useLink||!this.editor.getOption("enableMultiselect");if(this.$openTabstops||(this.$openTabstops=[]),!i[0]){var c=g.fromPoints(n,n);u(c.start,t),u(c.end,t),i[0]=[c],i[0].index=0}var l=this.index,p=[l+1,0],s=this.ranges,a=this.snippetId=(this.snippetId||0)+1;i.forEach(function(h,v){var d=this.$openTabstops[v]||h;d.snippetId=a;for(var y=0;y<h.length;y++){var x=h[y],k=g.fromPoints(x.start,x.end||x.start);O(k.start,t),O(k.end,t),k.original=x,k.tabstop=d,s.push(k),d!=h?d.unshift(k):d[y]=k,x.fmtString||d.firstNonLinked&&o?(k.linked=!0,d.hasLinkedRanges=!0):d.firstNonLinked||(d.firstNonLinked=k)}d.firstNonLinked||(d.hasLinkedRanges=!1),d===h&&(p.push(d),this.$openTabstops[v]=d),this.addTabstopMarkers(d),d.rangeList=d.rangeList||new S,d.rangeList.$bias=0,d.rangeList.addList(d)},this),p.length>2&&(this.tabstops.length&&p.push(p.splice(2,1)[0]),this.tabstops.splice.apply(this.tabstops,p))},e.prototype.addTabstopMarkers=function(i){var t=this.session;i.forEach(function(n){n.markerId||(n.markerId=t.addMarker(n,"ace_snippet-marker","text"))})},e.prototype.removeTabstopMarkers=function(i){var t=this.session;i.forEach(function(n){t.removeMarker(n.markerId),n.markerId=null})},e.prototype.updateTabstopMarkers=function(){if(this.selectedTabstop){var i=this.selectedTabstop.snippetId;this.selectedTabstop.index===0&&i--,this.tabstops.forEach(function(t){t.snippetId===i?this.addTabstopMarkers(t):this.removeTabstopMarkers(t)},this)}},e.prototype.removeRange=function(i){var t=i.tabstop.indexOf(i);t!=-1&&i.tabstop.splice(t,1),t=this.ranges.indexOf(i),t!=-1&&this.ranges.splice(t,1),t=i.tabstop.rangeList.ranges.indexOf(i),t!=-1&&i.tabstop.splice(t,1),this.session.removeMarker(i.markerId),i.tabstop.length||(t=this.tabstops.indexOf(i.tabstop),t!=-1&&this.tabstops.splice(t,1),this.tabstops.length||this.detach())},e}();F.prototype.keyboardHandler=new L,F.prototype.keyboardHandler.bindKeys({Tab:function(e){R.snippetManager&&R.snippetManager.expandWithTab(e)||(e.tabstopManager.tabNext(1),e.renderer.scrollCursorIntoView())},"Shift-Tab":function(e){e.tabstopManager.tabNext(-1),e.renderer.scrollCursorIntoView()},Esc:function(e){e.tabstopManager.detach()}});var O=function(e,i){e.row==0&&(e.column+=i.column),e.row+=i.row},u=function(e,i){e.row==i.row&&(e.column-=i.column),e.row-=i.row};C.importCssString(`
.ace_snippet-marker {
    -moz-box-sizing: border-box;
    box-sizing: border-box;
    background: rgba(194, 193, 208, 0.09);
    border: 1px dotted rgba(211, 208, 235, 0.62);
    position: absolute;
}`,"snippets.css",!1),R.snippetManager=new N;var r=m("./editor").Editor;(function(){this.insertSnippet=function(e,i){return R.snippetManager.insertSnippet(this,e,i)},this.expandSnippet=function(e){return R.snippetManager.expandWithTab(this,e)}}).call(r.prototype)}),define("ace/autocomplete/popup",["require","exports","module","ace/virtual_renderer","ace/editor","ace/range","ace/lib/event","ace/lib/lang","ace/lib/dom","ace/config","ace/lib/useragent"],function(m,R,V){"use strict";var T=m("../virtual_renderer").VirtualRenderer,C=m("../editor").Editor,$=m("../range").Range,b=m("../lib/event"),f=m("../lib/lang"),g=m("../lib/dom"),S=m("../config").nls,L=m("./../lib/useragent"),_=function(O){return"suggest-aria-id:".concat(O)},A=L.isSafari?"menu":"listbox",P=L.isSafari?"menuitem":"option",N=L.isSafari?"aria-current":"aria-selected",D=function(O){var u=new T(O);u.$maxLines=4;var r=new C(u);return r.setHighlightActiveLine(!1),r.setShowPrintMargin(!1),r.renderer.setShowGutter(!1),r.renderer.setHighlightGutterLine(!1),r.$mouseHandler.$focusTimeout=0,r.$highlightTagPending=!0,r},F=function(){function O(u){var r=g.createElement("div"),e=D(r);u&&u.appendChild(r),r.style.display="none",e.renderer.content.style.cursor="default",e.renderer.setStyle("ace_autocomplete"),e.renderer.$textLayer.element.setAttribute("role",A),e.renderer.$textLayer.element.setAttribute("aria-roledescription",S("autocomplete.popup.aria-roledescription","Autocomplete suggestions")),e.renderer.$textLayer.element.setAttribute("aria-label",S("autocomplete.popup.aria-label","Autocomplete suggestions")),e.renderer.textarea.setAttribute("aria-hidden","true"),e.setOption("displayIndentGuides",!1),e.setOption("dragDelay",150);var i=function(){};e.focus=i,e.$isFocused=!0,e.renderer.$cursorLayer.restartTimer=i,e.renderer.$cursorLayer.element.style.opacity="0",e.renderer.$maxLines=8,e.renderer.$keepTextAreaAtCursor=!1,e.setHighlightActiveLine(!1),e.session.highlight(""),e.session.$searchHighlight.clazz="ace_highlight-marker",e.on("mousedown",function(s){var a=s.getDocumentPosition();e.selection.moveToPosition(a),o.start.row=o.end.row=a.row,s.stop()});var t,n=new $(-1,0,-1,1/0),o=new $(-1,0,-1,1/0);o.id=e.session.addMarker(o,"ace_active-line","fullLine"),e.setSelectOnHover=function(s){s?n.id&&(e.session.removeMarker(n.id),n.id=null):n.id=e.session.addMarker(n,"ace_line-hover","fullLine")},e.setSelectOnHover(!1),e.on("mousemove",function(s){if(!t){t=s;return}if(!(t.x==s.x&&t.y==s.y)){t=s,t.scrollTop=e.renderer.scrollTop,e.isMouseOver=!0;var a=t.getDocumentPosition().row;n.start.row!=a&&(n.id||e.setRow(a),l(a))}}),e.renderer.on("beforeRender",function(){if(t&&n.start.row!=-1){t.$pos=null;var s=t.getDocumentPosition().row;n.id||e.setRow(s),l(s,!0)}}),e.renderer.on("afterRender",function(){var s=e.getRow(),a=e.renderer.$textLayer,h=a.element.childNodes[s-a.config.firstRow],v=document.activeElement;if(h!==e.selectedNode&&e.selectedNode&&(g.removeCssClass(e.selectedNode,"ace_selected"),v.removeAttribute("aria-activedescendant"),e.selectedNode.removeAttribute(N),e.selectedNode.removeAttribute("id")),e.selectedNode=h,h){g.addCssClass(h,"ace_selected");var d=_(s);h.id=d,a.element.setAttribute("aria-activedescendant",d),v.setAttribute("aria-activedescendant",d),h.setAttribute("role",P),h.setAttribute("aria-roledescription",S("autocomplete.popup.item.aria-roledescription","item")),h.setAttribute("aria-label",e.getData(s).caption||e.getData(s).value),h.setAttribute("aria-setsize",e.data.length),h.setAttribute("aria-posinset",s+1),h.setAttribute("aria-describedby","doc-tooltip"),h.setAttribute(N,"true")}});var c=function(){l(-1)},l=function(s,a){s!==n.start.row&&(n.start.row=n.end.row=s,a||e.session._emit("changeBackMarker"),e._emit("changeHoverMarker"))};e.getHoveredRow=function(){return n.start.row},b.addListener(e.container,"mouseout",function(){e.isMouseOver=!1,c()}),e.on("hide",c),e.on("changeSelection",c),e.session.doc.getLength=function(){return e.data.length},e.session.doc.getLine=function(s){var a=e.data[s];return typeof a=="string"?a:a&&a.value||""};var p=e.session.bgTokenizer;return p.$tokenizeRow=function(s){function a(w,I){w&&v.push({type:(h.className||"")+(I||""),value:w})}var h=e.data[s],v=[];if(!h)return v;typeof h=="string"&&(h={value:h});for(var d=h.caption||h.value||h.name,y=d.toLowerCase(),x=(e.filterText||"").toLowerCase(),k=0,H=0,E=0;E<=x.length;E++)if(E!=H&&(h.matchMask&1<<E||E==x.length)){var z=x.slice(H,E);H=E;var U=y.indexOf(z,k);if(U==-1)continue;a(d.slice(k,U),""),k=U+z.length,a(d.slice(U,k),"completion-highlight")}return a(d.slice(k,d.length),""),v.push({type:"completion-spacer",value:" "}),h.meta&&v.push({type:"completion-meta",value:h.meta}),h.message&&v.push({type:"completion-message",value:h.message}),v},p.$updateOnChange=i,p.start=i,e.session.$computeWidth=function(){return this.screenWidth=0},e.isOpen=!1,e.isTopdown=!1,e.autoSelect=!0,e.filterText="",e.isMouseOver=!1,e.data=[],e.setData=function(s,a){e.filterText=a||"",e.setValue(f.stringRepeat(`
`,s.length),-1),e.data=s||[],e.setRow(0)},e.getData=function(s){return e.data[s]},e.getRow=function(){return o.start.row},e.setRow=function(s){s=Math.max(this.autoSelect?0:-1,Math.min(this.data.length-1,s)),o.start.row!=s&&(e.selection.clearSelection(),o.start.row=o.end.row=s||0,e.session._emit("changeBackMarker"),e.moveCursorTo(s||0,0),e.isOpen&&e._signal("select"))},e.on("changeSelection",function(){e.isOpen&&e.setRow(e.selection.lead.row),e.renderer.scrollCursorIntoView()}),e.hide=function(){this.container.style.display="none",e.anchorPos=null,e.anchor=null,e.isOpen&&(e.isOpen=!1,this._signal("hide"))},e.tryShow=function(s,a,h,v){if(!v&&e.isOpen&&e.anchorPos&&e.anchor&&e.anchorPos.top===s.top&&e.anchorPos.left===s.left&&e.anchor===h)return!0;var d=this.container,y=window.innerHeight,x=window.innerWidth,k=this.renderer,H=k.$maxLines*a*1.4,E={top:0,bottom:0,left:0},z=y-s.top-3*this.$borderSize-a,U=s.top-3*this.$borderSize;h||(U<=z||z>=H?h="bottom":h="top"),h==="top"?(E.bottom=s.top-this.$borderSize,E.top=E.bottom-H):h==="bottom"&&(E.top=s.top+a+this.$borderSize,E.bottom=E.top+H);var w=E.top>=0&&E.bottom<=y;if(!v&&!w)return!1;w?k.$maxPixelHeight=null:h==="top"?k.$maxPixelHeight=U:k.$maxPixelHeight=z,h==="top"?(d.style.top="",d.style.bottom=y-E.bottom+"px",e.isTopdown=!1):(d.style.top=E.top+"px",d.style.bottom="",e.isTopdown=!0),d.style.display="";var I=s.left;return I+d.offsetWidth>x&&(I=x-d.offsetWidth),d.style.left=I+"px",d.style.right="",e.isOpen||(e.isOpen=!0,this._signal("show"),t=null),e.anchorPos=s,e.anchor=h,!0},e.show=function(s,a,h){this.tryShow(s,a,h?"bottom":void 0,!0)},e.goTo=function(s){var a=this.getRow(),h=this.session.getLength()-1;switch(s){case"up":a=a<=0?h:a-1;break;case"down":a=a>=h?-1:a+1;break;case"start":a=0;break;case"end":a=h}this.setRow(a)},e.getTextLeftOffset=function(){return this.$borderSize+this.renderer.$padding+this.$imageSize},e.$imageSize=0,e.$borderSize=1,e}return O}();g.importCssString(`
.ace_editor.ace_autocomplete .ace_marker-layer .ace_active-line {
    background-color: #CAD6FA;
    z-index: 1;
}
.ace_dark.ace_editor.ace_autocomplete .ace_marker-layer .ace_active-line {
    background-color: #3a674e;
}
.ace_editor.ace_autocomplete .ace_line-hover {
    border: 1px solid #abbffe;
    margin-top: -1px;
    background: rgba(233,233,253,0.4);
    position: absolute;
    z-index: 2;
}
.ace_dark.ace_editor.ace_autocomplete .ace_line-hover {
    border: 1px solid rgba(109, 150, 13, 0.8);
    background: rgba(58, 103, 78, 0.62);
}
.ace_completion-meta {
    opacity: 0.5;
    margin-left: 0.9em;
}
.ace_completion-message {
    margin-left: 0.9em;
    color: blue;
}
.ace_editor.ace_autocomplete .ace_completion-highlight{
    color: #2d69c7;
}
.ace_dark.ace_editor.ace_autocomplete .ace_completion-highlight{
    color: #93ca12;
}
.ace_editor.ace_autocomplete {
    width: 300px;
    z-index: 200000;
    border: 1px lightgray solid;
    position: fixed;
    box-shadow: 2px 3px 5px rgba(0,0,0,.2);
    line-height: 1.4;
    background: #fefefe;
    color: #111;
}
.ace_dark.ace_editor.ace_autocomplete {
    border: 1px #484747 solid;
    box-shadow: 2px 3px 5px rgba(0, 0, 0, 0.51);
    line-height: 1.4;
    background: #25282c;
    color: #c1c1c1;
}
.ace_autocomplete .ace_text-layer  {
    width: calc(100% - 8px);
}
.ace_autocomplete .ace_line {
    display: flex;
    align-items: center;
}
.ace_autocomplete .ace_line > * {
    min-width: 0;
    flex: 0 0 auto;
}
.ace_autocomplete .ace_line .ace_ {
    flex: 0 1 auto;
    overflow: hidden;
    text-overflow: ellipsis;
}
.ace_autocomplete .ace_completion-spacer {
    flex: 1;
}
.ace_autocomplete.ace_loading:after  {
    content: "";
    position: absolute;
    top: 0px;
    height: 2px;
    width: 8%;
    background: blue;
    z-index: 100;
    animation: ace_progress 3s infinite linear;
    animation-delay: 300ms;
    transform: translateX(-100%) scaleX(1);
}
@keyframes ace_progress {
    0% { transform: translateX(-100%) scaleX(1) }
    50% { transform: translateX(625%) scaleX(2) } 
    100% { transform: translateX(1500%) scaleX(3) } 
}
@media (prefers-reduced-motion) {
    .ace_autocomplete.ace_loading:after {
        transform: translateX(625%) scaleX(2);
        animation: none;
     }
}
`,"autocompletion.css",!1),R.AcePopup=F,R.$singleLineEditor=D,R.getAriaId=_}),define("ace/autocomplete/inline_screenreader",["require","exports","module"],function(m,R,V){"use strict";var T=function(){function C($){this.editor=$,this.screenReaderDiv=document.createElement("div"),this.screenReaderDiv.classList.add("ace_screenreader-only"),this.editor.container.appendChild(this.screenReaderDiv)}return C.prototype.setScreenReaderContent=function($){for(!this.popup&&this.editor.completer&&this.editor.completer.popup&&(this.popup=this.editor.completer.popup,this.popup.renderer.on("afterRender",function(){var f=this.popup.getRow(),g=this.popup.renderer.$textLayer,S=g.element.childNodes[f-g.config.firstRow];if(S){for(var L="doc-tooltip ",_=0;_<this._lines.length;_++)L+="ace-inline-screenreader-line-".concat(_," ");S.setAttribute("aria-describedby",L)}}.bind(this)));this.screenReaderDiv.firstChild;)this.screenReaderDiv.removeChild(this.screenReaderDiv.firstChild);this._lines=$.split(/\r\n|\r|\n/);var b=this.createCodeBlock();this.screenReaderDiv.appendChild(b)},C.prototype.destroy=function(){this.screenReaderDiv.remove()},C.prototype.createCodeBlock=function(){var $=document.createElement("pre");$.setAttribute("id","ace-inline-screenreader");for(var b=0;b<this._lines.length;b++){var f=document.createElement("code");f.setAttribute("id","ace-inline-screenreader-line-".concat(b));var g=document.createTextNode(this._lines[b]);f.appendChild(g),$.appendChild(f)}return $},C}();R.AceInlineScreenReader=T}),define("ace/autocomplete/inline",["require","exports","module","ace/snippets","ace/autocomplete/inline_screenreader"],function(m,R,V){"use strict";var T=m("../snippets").snippetManager,C=m("./inline_screenreader").AceInlineScreenReader,$=function(){function b(){this.editor=null}return b.prototype.show=function(f,g,S){if(S=S||"",f&&this.editor&&this.editor!==f&&(this.hide(),this.editor=null,this.inlineScreenReader=null),!f||!g)return!1;this.inlineScreenReader||(this.inlineScreenReader=new C(f));var L=g.snippet?T.getDisplayTextForSnippet(f,g.snippet):g.value;return g.hideInlinePreview||!L||!L.startsWith(S)?!1:(this.editor=f,this.inlineScreenReader.setScreenReaderContent(L),L=L.slice(S.length),L===""?f.removeGhostText():f.setGhostText(L),!0)},b.prototype.isOpen=function(){return this.editor?!!this.editor.renderer.$ghostText:!1},b.prototype.hide=function(){return this.editor?(this.editor.removeGhostText(),!0):!1},b.prototype.destroy=function(){this.hide(),this.editor=null,this.inlineScreenReader&&(this.inlineScreenReader.destroy(),this.inlineScreenReader=null)},b}();R.AceInline=$}),define("ace/autocomplete/util",["require","exports","module"],function(m,R,V){"use strict";R.parForEach=function(C,$,b){var f=0,g=C.length;g===0&&b();for(var S=0;S<g;S++)$(C[S],function(L,_){f++,f===g&&b(L,_)})};var T=/[a-zA-Z_0-9\$\-\u00A2-\u2000\u2070-\uFFFF]/;R.retrievePrecedingIdentifier=function(C,$,b){b=b||T;for(var f=[],g=$-1;g>=0&&b.test(C[g]);g--)f.push(C[g]);return f.reverse().join("")},R.retrieveFollowingIdentifier=function(C,$,b){b=b||T;for(var f=[],g=$;g<C.length&&b.test(C[g]);g++)f.push(C[g]);return f},R.getCompletionPrefix=function(C){var $=C.getCursorPosition(),b=C.session.getLine($.row),f;return C.completers.forEach(function(g){g.identifierRegexps&&g.identifierRegexps.forEach(function(S){!f&&S&&(f=this.retrievePrecedingIdentifier(b,$.column,S))}.bind(this))}.bind(this)),f||this.retrievePrecedingIdentifier(b,$.column)},R.triggerAutocomplete=function(C,b){var b=b??C.session.getPrecedingCharacter();return C.completers.some(function(f){if(f.triggerCharacters&&Array.isArray(f.triggerCharacters))return f.triggerCharacters.includes(b)})}}),define("ace/autocomplete",["require","exports","module","ace/keyboard/hash_handler","ace/autocomplete/popup","ace/autocomplete/inline","ace/autocomplete/popup","ace/autocomplete/util","ace/lib/lang","ace/lib/dom","ace/snippets","ace/config","ace/lib/event","ace/lib/scroll"],function(m,R,V){"use strict";var T=m("./keyboard/hash_handler").HashHandler,C=m("./autocomplete/popup").AcePopup,$=m("./autocomplete/inline").AceInline,b=m("./autocomplete/popup").getAriaId,f=m("./autocomplete/util"),g=m("./lib/lang"),S=m("./lib/dom"),L=m("./snippets").snippetManager,_=m("./config"),A=m("./lib/event"),P=m("./lib/scroll").preventParentScroll,N=function(u,r){r.completer&&r.completer.destroy()},D=function(){function u(){this.autoInsert=!1,this.autoSelect=!0,this.autoShown=!1,this.exactMatch=!1,this.inlineEnabled=!1,this.keyboardHandler=new T,this.keyboardHandler.bindKeys(this.commands),this.parentNode=null,this.setSelectOnHover=!1,this.hasSeen=new Set,this.showLoadingState=!1,this.stickySelectionDelay=500,this.blurListener=this.blurListener.bind(this),this.changeListener=this.changeListener.bind(this),this.mousedownListener=this.mousedownListener.bind(this),this.mousewheelListener=this.mousewheelListener.bind(this),this.onLayoutChange=this.onLayoutChange.bind(this),this.changeTimer=g.delayedCall(function(){this.updateCompletions(!0)}.bind(this)),this.tooltipTimer=g.delayedCall(this.updateDocTooltip.bind(this),50),this.popupTimer=g.delayedCall(this.$updatePopupPosition.bind(this),50),this.stickySelectionTimer=g.delayedCall(function(){this.stickySelection=!0}.bind(this),this.stickySelectionDelay),this.$firstOpenTimer=g.delayedCall(function(){var r=this.completionProvider&&this.completionProvider.initialPosition;this.autoShown||this.popup&&this.popup.isOpen||!r||this.editor.completers.length===0||(this.completions=new O(u.completionsForLoading),this.openPopup(this.editor,r.prefix,!1),this.popup.renderer.setStyle("ace_loading",!0))}.bind(this),this.stickySelectionDelay)}return Object.defineProperty(u,"completionsForLoading",{get:function(){return[{caption:_.nls("autocomplete.loading","Loading..."),value:""}]},enumerable:!1,configurable:!0}),u.prototype.$init=function(){return this.popup=new C(this.parentNode||document.body||document.documentElement),this.popup.on("click",function(r){this.insertMatch(),r.stop()}.bind(this)),this.popup.focus=this.editor.focus.bind(this.editor),this.popup.on("show",this.$onPopupShow.bind(this)),this.popup.on("hide",this.$onHidePopup.bind(this)),this.popup.on("select",this.$onPopupChange.bind(this)),A.addListener(this.popup.container,"mouseout",this.mouseOutListener.bind(this)),this.popup.on("changeHoverMarker",this.tooltipTimer.bind(null,null)),this.popup.renderer.on("afterRender",this.$onPopupRender.bind(this)),this.popup},u.prototype.$initInline=function(){if(!(!this.inlineEnabled||this.inlineRenderer))return this.inlineRenderer=new $,this.inlineRenderer},u.prototype.getPopup=function(){return this.popup||this.$init()},u.prototype.$onHidePopup=function(){this.inlineRenderer&&this.inlineRenderer.hide(),this.hideDocTooltip(),this.stickySelectionTimer.cancel(),this.popupTimer.cancel(),this.stickySelection=!1},u.prototype.$seen=function(r){!this.hasSeen.has(r)&&r&&r.completer&&r.completer.onSeen&&typeof r.completer.onSeen=="function"&&(r.completer.onSeen(this.editor,r),this.hasSeen.add(r))},u.prototype.$onPopupChange=function(r){if(this.inlineRenderer&&this.inlineEnabled){var e=r?null:this.popup.getData(this.popup.getRow());if(this.$updateGhostText(e),this.popup.isMouseOver&&this.setSelectOnHover){this.tooltipTimer.call(null,null);return}this.popupTimer.schedule(),this.tooltipTimer.schedule()}else this.popupTimer.call(null,null),this.tooltipTimer.call(null,null)},u.prototype.$updateGhostText=function(r){var e=this.base.row,i=this.base.column,t=this.editor.getCursorPosition().column,n=this.editor.session.getLine(e).slice(i,t);this.inlineRenderer.show(this.editor,r,n)?this.$seen(r):this.inlineRenderer.hide()},u.prototype.$onPopupRender=function(){var r=this.inlineRenderer&&this.inlineEnabled;if(this.completions&&this.completions.filtered&&this.completions.filtered.length>0)for(var e=this.popup.getFirstVisibleRow();e<=this.popup.getLastVisibleRow();e++){var i=this.popup.getData(e);i&&(!r||i.hideInlinePreview)&&this.$seen(i)}},u.prototype.$onPopupShow=function(r){this.$onPopupChange(r),this.stickySelection=!1,this.stickySelectionDelay>=0&&this.stickySelectionTimer.schedule(this.stickySelectionDelay)},u.prototype.observeLayoutChanges=function(){if(!(this.$elements||!this.editor)){window.addEventListener("resize",this.onLayoutChange,{passive:!0}),window.addEventListener("wheel",this.mousewheelListener);for(var r=this.editor.container.parentNode,e=[];r;)e.push(r),r.addEventListener("scroll",this.onLayoutChange,{passive:!0}),r=r.parentNode;this.$elements=e}},u.prototype.unObserveLayoutChanges=function(){var r=this;window.removeEventListener("resize",this.onLayoutChange,{passive:!0}),window.removeEventListener("wheel",this.mousewheelListener),this.$elements&&this.$elements.forEach(function(e){e.removeEventListener("scroll",r.onLayoutChange,{passive:!0})}),this.$elements=null},u.prototype.onLayoutChange=function(){if(!this.popup.isOpen)return this.unObserveLayoutChanges();this.$updatePopupPosition(),this.updateDocTooltip()},u.prototype.$updatePopupPosition=function(){var r=this.editor,e=r.renderer,i=e.layerConfig.lineHeight,t=e.$cursorLayer.getPixelPosition(this.base,!0);t.left-=this.popup.getTextLeftOffset();var n=r.container.getBoundingClientRect();t.top+=n.top-e.layerConfig.offset,t.left+=n.left-r.renderer.scrollLeft,t.left+=e.gutterWidth;var o={top:t.top,left:t.left};e.$ghostText&&e.$ghostTextWidget&&this.base.row===e.$ghostText.position.row&&(o.top+=e.$ghostTextWidget.el.offsetHeight);var c=r.container.getBoundingClientRect().bottom-i,l=c<o.top?{top:c,left:o.left}:o;this.popup.tryShow(l,i,"bottom")||this.popup.tryShow(t,i,"top")||this.popup.show(t,i)},u.prototype.openPopup=function(r,e,i){this.$firstOpenTimer.cancel(),this.popup||this.$init(),this.inlineEnabled&&!this.inlineRenderer&&this.$initInline(),this.popup.autoSelect=this.autoSelect,this.popup.setSelectOnHover(this.setSelectOnHover);var t=this.popup.getRow(),n=this.popup.data[t];this.popup.setData(this.completions.filtered,this.completions.filterText),this.editor.textInput.setAriaOptions&&this.editor.textInput.setAriaOptions({activeDescendant:b(this.popup.getRow()),inline:this.inlineEnabled}),r.keyBinding.addKeyboardHandler(this.keyboardHandler);var o;this.stickySelection&&(o=this.popup.data.indexOf(n)),(!o||o===-1)&&(o=0),this.popup.setRow(this.autoSelect?o:-1),o===t&&n!==this.completions.filtered[o]&&this.$onPopupChange();var c=this.inlineRenderer&&this.inlineEnabled;if(o===t&&c){var l=this.popup.getData(this.popup.getRow());this.$updateGhostText(l)}i||(this.popup.setTheme(r.getTheme()),this.popup.setFontSize(r.getFontSize()),this.$updatePopupPosition(),this.tooltipNode&&this.updateDocTooltip()),this.changeTimer.cancel(),this.observeLayoutChanges()},u.prototype.detach=function(){this.editor&&(this.editor.keyBinding.removeKeyboardHandler(this.keyboardHandler),this.editor.off("changeSelection",this.changeListener),this.editor.off("blur",this.blurListener),this.editor.off("mousedown",this.mousedownListener),this.editor.off("mousewheel",this.mousewheelListener)),this.$firstOpenTimer.cancel(),this.changeTimer.cancel(),this.hideDocTooltip(),this.completionProvider&&this.completionProvider.detach(),this.popup&&this.popup.isOpen&&this.popup.hide(),this.popup&&this.popup.renderer&&this.popup.renderer.off("afterRender",this.$onPopupRender),this.base&&this.base.detach(),this.activated=!1,this.completionProvider=this.completions=this.base=null,this.unObserveLayoutChanges()},u.prototype.changeListener=function(r){var e=this.editor.selection.lead;(e.row!=this.base.row||e.column<this.base.column)&&this.detach(),this.activated?this.changeTimer.schedule():this.detach()},u.prototype.blurListener=function(r){var e=document.activeElement,i=this.editor.textInput.getElement(),t=r.relatedTarget&&this.tooltipNode&&this.tooltipNode.contains(r.relatedTarget),n=this.popup&&this.popup.container;e!=i&&e.parentNode!=n&&!t&&e!=this.tooltipNode&&r.relatedTarget!=i&&this.detach()},u.prototype.mousedownListener=function(r){this.detach()},u.prototype.mousewheelListener=function(r){this.popup&&!this.popup.isMouseOver&&this.detach()},u.prototype.mouseOutListener=function(r){this.popup.isOpen&&this.$updatePopupPosition()},u.prototype.goTo=function(r){this.popup.goTo(r)},u.prototype.insertMatch=function(r,e){if(r||(r=this.popup.getData(this.popup.getRow())),!r)return!1;if(r.value==="")return this.detach();var i=this.completions,t=this.getCompletionProvider().insertMatch(this.editor,r,i.filterText,e);return this.completions==i&&this.detach(),t},u.prototype.showPopup=function(r,e){this.editor&&this.detach(),this.activated=!0,this.editor=r,r.completer!=this&&(r.completer&&r.completer.detach(),r.completer=this),r.on("changeSelection",this.changeListener),r.on("blur",this.blurListener),r.on("mousedown",this.mousedownListener),r.on("mousewheel",this.mousewheelListener),this.updateCompletions(!1,e)},u.prototype.getCompletionProvider=function(r){return this.completionProvider||(this.completionProvider=new F(r)),this.completionProvider},u.prototype.gatherCompletions=function(r,e){return this.getCompletionProvider().gatherCompletions(r,e)},u.prototype.updateCompletions=function(r,e){if(r&&this.base&&this.completions){var t=this.editor.getCursorPosition(),n=this.editor.session.getTextRange({start:this.base,end:t});if(n==this.completions.filterText)return;if(this.completions.setFilter(n),!this.completions.filtered.length)return this.detach();if(this.completions.filtered.length==1&&this.completions.filtered[0].value==n&&!this.completions.filtered[0].snippet)return this.detach();this.openPopup(this.editor,n,r);return}if(e&&e.matches){var t=this.editor.getSelectionRange().start;return this.base=this.editor.session.doc.createAnchor(t.row,t.column),this.base.$insertRight=!0,this.completions=new O(e.matches),this.getCompletionProvider().completions=this.completions,this.openPopup(this.editor,"",r)}var i=this.editor.getSession(),t=this.editor.getCursorPosition(),n=f.getCompletionPrefix(this.editor);this.base=i.doc.createAnchor(t.row,t.column-n.length),this.base.$insertRight=!0;var o={exactMatch:this.exactMatch,ignoreCaption:this.ignoreCaption};this.getCompletionProvider({prefix:n,pos:t}).provideCompletions(this.editor,o,function(c,l,p){var s=l.filtered,a=f.getCompletionPrefix(this.editor);if(this.$firstOpenTimer.cancel(),p){if(!s.length){var h=!this.autoShown&&this.emptyMessage;if(typeof h=="function"&&(h=this.emptyMessage(a)),h){var v=[{caption:h,value:""}];this.completions=new O(v),this.openPopup(this.editor,a,r),this.popup.renderer.setStyle("ace_loading",!1),this.popup.renderer.setStyle("ace_empty-message",!0);return}return this.detach()}if(s.length==1&&s[0].value==a&&!s[0].snippet)return this.detach();if(this.autoInsert&&!this.autoShown&&s.length==1)return this.insertMatch(s[0])}this.completions=!p&&this.showLoadingState?new O(u.completionsForLoading.concat(s),l.filterText):l,this.openPopup(this.editor,a,r),this.popup.renderer.setStyle("ace_empty-message",!1),this.popup.renderer.setStyle("ace_loading",!p)}.bind(this)),this.showLoadingState&&!this.autoShown&&(!this.popup||!this.popup.isOpen)&&this.$firstOpenTimer.delay(this.stickySelectionDelay/2)},u.prototype.cancelContextMenu=function(){this.editor.$mouseHandler.cancelContextMenu()},u.prototype.updateDocTooltip=function(){var r=this.popup,e=this.completions.filtered,i=e&&(e[r.getHoveredRow()]||e[r.getRow()]),t=null;if(!i||!this.editor||!this.popup.isOpen)return this.hideDocTooltip();for(var n=this.editor.completers.length,o=0;o<n;o++){var c=this.editor.completers[o];if(c.getDocTooltip&&i.completerId===c.id){t=c.getDocTooltip(i);break}}if(!t&&typeof i!="string"&&(t=i),typeof t=="string"&&(t={docText:t}),!t||!t.docHTML&&!t.docText)return this.hideDocTooltip();this.showDocTooltip(t)},u.prototype.showDocTooltip=function(r){this.tooltipNode||(this.tooltipNode=S.createElement("div"),this.tooltipNode.style.margin="0",this.tooltipNode.style.pointerEvents="auto",this.tooltipNode.style.overscrollBehavior="contain",this.tooltipNode.tabIndex=-1,this.tooltipNode.onblur=this.blurListener.bind(this),this.tooltipNode.onclick=this.onTooltipClick.bind(this),this.tooltipNode.id="doc-tooltip",this.tooltipNode.setAttribute("role","tooltip"),this.tooltipNode.addEventListener("wheel",P));var e=this.editor.renderer.theme;this.tooltipNode.className="ace_tooltip ace_doc-tooltip "+(e.isDark?"ace_dark ":"")+(e.cssClass||"");var i=this.tooltipNode;r.docHTML?i.innerHTML=r.docHTML:r.docText&&(i.textContent=r.docText),i.parentNode||this.popup.container.appendChild(this.tooltipNode);var t=this.popup,n=t.container.getBoundingClientRect();i.style.top=t.container.style.top,i.style.bottom=t.container.style.bottom,i.style.display="block",window.innerWidth-n.right<320?n.left<320?t.isTopdown?(i.style.top=n.bottom+"px",i.style.left=n.left+"px",i.style.right="",i.style.bottom=""):(i.style.top=t.container.offsetTop-i.offsetHeight+"px",i.style.left=n.left+"px",i.style.right="",i.style.bottom=""):(i.style.right=window.innerWidth-n.left+"px",i.style.left=""):(i.style.left=n.right+1+"px",i.style.right="")},u.prototype.hideDocTooltip=function(){if(this.tooltipTimer.cancel(),!!this.tooltipNode){var r=this.tooltipNode;!this.editor.isFocused()&&document.activeElement==r&&this.editor.focus(),this.tooltipNode=null,r.parentNode&&r.parentNode.removeChild(r)}},u.prototype.onTooltipClick=function(r){for(var e=r.target;e&&e!=this.tooltipNode;){if(e.nodeName=="A"&&e.href){e.rel="noreferrer",e.target="_blank";break}e=e.parentNode}},u.prototype.destroy=function(){if(this.detach(),this.popup){this.popup.destroy();var r=this.popup.container;r&&r.parentNode&&r.parentNode.removeChild(r)}this.editor&&this.editor.completer==this&&(this.editor.off("destroy",N),this.editor.completer=null),this.inlineRenderer=this.popup=this.editor=null},u.for=function(r){return r.completer instanceof u||(r.completer&&(r.completer.destroy(),r.completer=null),_.get("sharedPopups")?(u.$sharedInstance||(u.$sharedInstance=new u),r.completer=u.$sharedInstance):(r.completer=new u,r.once("destroy",N))),r.completer},u}();D.prototype.commands={Up:function(u){u.completer.goTo("up")},Down:function(u){u.completer.goTo("down")},"Ctrl-Up|Ctrl-Home":function(u){u.completer.goTo("start")},"Ctrl-Down|Ctrl-End":function(u){u.completer.goTo("end")},Esc:function(u){u.completer.detach()},Return:function(u){return u.completer.insertMatch()},"Shift-Return":function(u){u.completer.insertMatch(null,{deleteSuffix:!0})},Tab:function(u){var r=u.completer.insertMatch();if(r||u.tabstopManager)return r;u.completer.goTo("down")},Backspace:function(u){u.execCommand("backspace");var r=f.getCompletionPrefix(u);!r&&u.completer&&u.completer.detach()},PageUp:function(u){u.completer.popup.gotoPageUp()},PageDown:function(u){u.completer.popup.gotoPageDown()}},D.startCommand={name:"startAutocomplete",exec:function(u,r){var e=D.for(u);e.autoInsert=!1,e.autoSelect=!0,e.autoShown=!1,e.showPopup(u,r),e.cancelContextMenu()},bindKey:"Ctrl-Space|Ctrl-Shift-Space|Alt-Space"};var F=function(){function u(r){this.initialPosition=r,this.active=!0}return u.prototype.insertByIndex=function(r,e,i){return!this.completions||!this.completions.filtered?!1:this.insertMatch(r,this.completions.filtered[e],i)},u.prototype.insertMatch=function(r,e,i){if(!e)return!1;if(r.startOperation({command:{name:"insertMatch"}}),e.completer&&e.completer.insertMatch)e.completer.insertMatch(r,e);else{if(!this.completions)return!1;var t=this.completions.filterText.length,n=0;if(e.range&&e.range.start.row===e.range.end.row&&(t-=this.initialPosition.prefix.length,t+=this.initialPosition.pos.column-e.range.start.column,n+=e.range.end.column-this.initialPosition.pos.column),t||n){var o;r.selection.getAllRanges?o=r.selection.getAllRanges():o=[r.getSelectionRange()];for(var c=0,l;l=o[c];c++)l.start.column-=t,l.end.column+=n,r.session.remove(l)}e.snippet?L.insertSnippet(r,e.snippet):this.$insertString(r,e),e.completer&&e.completer.onInsert&&typeof e.completer.onInsert=="function"&&e.completer.onInsert(r,e),e.command&&e.command==="startAutocomplete"&&r.execCommand(e.command)}return r.endOperation(),!0},u.prototype.$insertString=function(r,e){var i=e.value||e;r.execCommand("insertstring",i)},u.prototype.gatherCompletions=function(r,e){var i=r.getSession(),t=r.getCursorPosition(),n=f.getCompletionPrefix(r),o=[];this.completers=r.completers;var c=r.completers.length;return r.completers.forEach(function(l,p){l.getCompletions(r,i,t,n,function(s,a){l.hideInlinePreview&&(a=a.map(function(h){return Object.assign(h,{hideInlinePreview:l.hideInlinePreview})})),!s&&a&&(o=o.concat(a)),e(null,{prefix:f.getCompletionPrefix(r),matches:o,finished:--c===0})})}),!0},u.prototype.provideCompletions=function(r,e,i){var t=function(l){var p=l.prefix,s=l.matches;this.completions=new O(s),e.exactMatch&&(this.completions.exactMatch=!0),e.ignoreCaption&&(this.completions.ignoreCaption=!0),this.completions.setFilter(p),(l.finished||this.completions.filtered.length)&&i(null,this.completions,l.finished)}.bind(this),n=!0,o=null;if(this.gatherCompletions(r,function(l,p){if(this.active){l&&(i(l,[],!0),this.detach());var s=p.prefix;if(s.indexOf(p.prefix)===0){if(n){o=p;return}t(p)}}}.bind(this)),n=!1,o){var c=o;o=null,t(c)}},u.prototype.detach=function(){this.active=!1,this.completers&&this.completers.forEach(function(r){typeof r.cancel=="function"&&r.cancel()})},u}(),O=function(){function u(r,e){this.all=r,this.filtered=r,this.filterText=e||"",this.exactMatch=!1,this.ignoreCaption=!1}return u.prototype.setFilter=function(r){if(r.length>this.filterText&&r.lastIndexOf(this.filterText,0)===0)var e=this.filtered;else var e=this.all;this.filterText=r,e=this.filterCompletions(e,this.filterText),e=e.sort(function(t,n){return n.exactMatch-t.exactMatch||n.$score-t.$score||(t.caption||t.value).localeCompare(n.caption||n.value)});var i=null;e=e.filter(function(t){var n=t.snippet||t.caption||t.value;return n===i?!1:(i=n,!0)}),this.filtered=e},u.prototype.filterCompletions=function(r,e){var i=[],t=e.toUpperCase(),n=e.toLowerCase();e:for(var o=0,c;c=r[o];o++){var l=!this.ignoreCaption&&c.caption||c.value||c.snippet;if(l){var p=-1,s=0,a=0,h,v;if(this.exactMatch){if(e!==l.substr(0,e.length))continue e}else{var d=l.toLowerCase().indexOf(n);if(d>-1)a=d;else for(var y=0;y<e.length;y++){var x=l.indexOf(n[y],p+1),k=l.indexOf(t[y],p+1);if(h=x>=0&&(k<0||x<k)?x:k,h<0)continue e;v=h-p-1,v>0&&(p===-1&&(a+=10),a+=v,s|=1<<y),p=h}}c.matchMask=s,c.exactMatch=a?0:1,c.$score=(c.score||0)-a,i.push(c)}}return i},u}();R.Autocomplete=D,R.CompletionProvider=F,R.FilteredList=O}),define("ace/autocomplete/text_completer",["require","exports","module","ace/range"],function(m,R,V){function T(f,g){var S=f.getTextRange($.fromPoints({row:0,column:0},g));return S.split(b).length-1}function C(f,g){var S=T(f,g),L=f.getValue().split(b),_=Object.create(null),A=L[S];return L.forEach(function(P,N){if(!(!P||P===A)){var D=Math.abs(S-N),F=L.length-D;_[P]?_[P]=Math.max(F,_[P]):_[P]=F}}),_}var $=m("../range").Range,b=/[^a-zA-Z_0-9\$\-\u00C0-\u1FFF\u2C00-\uD7FF\w]+/;R.getCompletions=function(f,g,S,L,_){var A=C(g,S),P=Object.keys(A);_(null,P.map(function(N){return{caption:N,value:N,score:A[N],meta:"local"}}))}}),define("ace/ext/language_tools",["require","exports","module","ace/snippets","ace/autocomplete","ace/config","ace/lib/lang","ace/autocomplete/util","ace/autocomplete/text_completer","ace/editor","ace/config"],function(m,R,V){"use strict";var T=m("../snippets").snippetManager,C=m("../autocomplete").Autocomplete,$=m("../config"),b=m("../lib/lang"),f=m("../autocomplete/util"),g=m("../autocomplete/text_completer"),S={getCompletions:function(t,n,o,c,l){if(n.$mode.completer)return n.$mode.completer.getCompletions(t,n,o,c,l);var p=t.session.getState(o.row),s=n.$mode.getCompletions(p,n,o,c);s=s.map(function(a){return a.completerId=S.id,a}),l(null,s)},id:"keywordCompleter"},L=function(t){var n={};return t.replace(/\${(\d+)(:(.*?))?}/g,function(o,c,l,p){return n[c]=p||""}).replace(/\$(\d+?)/g,function(o,c){return n[c]})},_={getCompletions:function(t,n,o,c,l){var p=[],s=n.getTokenAt(o.row,o.column);s&&s.type.match(/(tag-name|tag-open|tag-whitespace|attribute-name|attribute-value)\.xml$/)?p.push("html-tag"):p=T.getActiveScopes(t);var a=T.snippetMap,h=[];p.forEach(function(v){for(var d=a[v]||[],y=d.length;y--;){var x=d[y],k=x.name||x.tabTrigger;k&&h.push({caption:k,snippet:x.content,meta:x.tabTrigger&&!x.name?x.tabTrigger+"\u21E5 ":"snippet",completerId:_.id})}},this),l(null,h)},getDocTooltip:function(t){t.snippet&&!t.docHTML&&(t.docHTML=["<b>",b.escapeHTML(t.caption),"</b>","<hr></hr>",b.escapeHTML(L(t.snippet))].join(""))},id:"snippetCompleter"},A=[_,g,S];R.setCompleters=function(t){A.length=0,t&&A.push.apply(A,t)},R.addCompleter=function(t){A.push(t)},R.textCompleter=g,R.keyWordCompleter=S,R.snippetCompleter=_;var P={name:"expandSnippet",exec:function(t){return T.expandWithTab(t)},bindKey:"Tab"},N=function(t,n){D(n.session.$mode)},D=function(t){typeof t=="string"&&(t=$.$modes[t]),t&&(T.files||(T.files={}),F(t.$id,t.snippetFileId),t.modes&&t.modes.forEach(D))},F=function(t,n){!n||!t||T.files[t]||(T.files[t]={},$.loadModule(n,function(o){o&&(T.files[t]=o,!o.snippets&&o.snippetText&&(o.snippets=T.parseSnippetFile(o.snippetText)),T.register(o.snippets||[],o.scope),o.includeScopes&&(T.snippetMap[o.scope].includeScopes=o.includeScopes,o.includeScopes.forEach(function(c){D("ace/mode/"+c)})))}))},O=function(t){var n=t.editor,o=n.completer&&n.completer.activated;if(t.command.name==="backspace")o&&!f.getCompletionPrefix(n)&&n.completer.detach();else if(t.command.name==="insertstring"&&!o){u=t;var c=t.editor.$liveAutocompletionDelay;c?r.delay(c):e(t)}},u,r=b.delayedCall(function(){e(u)},0),e=function(t){var n=t.editor,o=f.getCompletionPrefix(n),c=t.args,l=f.triggerAutocomplete(n,c);if(o&&o.length>=n.$liveAutocompletionThreshold||l){var p=C.for(n);p.autoShown=!0,p.showPopup(n)}},i=m("../editor").Editor;m("../config").defineOptions(i.prototype,"editor",{enableBasicAutocompletion:{set:function(t){t?(this.completers||(this.completers=Array.isArray(t)?t:A),this.commands.addCommand(C.startCommand)):this.commands.removeCommand(C.startCommand)},value:!1},enableLiveAutocompletion:{set:function(t){t?(this.completers||(this.completers=Array.isArray(t)?t:A),this.commands.on("afterExec",O)):this.commands.off("afterExec",O)},value:!1},liveAutocompletionDelay:{initialValue:0},liveAutocompletionThreshold:{initialValue:0},enableSnippets:{set:function(t){t?(this.commands.addCommand(P),this.on("changeMode",N),N(null,this)):(this.commands.removeCommand(P),this.off("changeMode",N))},value:!1}})}),function(){window.require(["ace/ext/language_tools"],function(m){typeof module=="object"&&typeof exports=="object"&&module&&(module.exports=m)})}();
